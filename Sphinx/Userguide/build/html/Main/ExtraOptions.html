<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Outputs" href="../Outputs/Outputs.html" /><link rel="prev" title="Usage" href="Usage.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>Extra options - MPCD documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">MPCD  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">MPCD  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Summary/Summary.html">Executive summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Install/Install.html">Installation &amp; run guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="Usage.html">Usage</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Extra options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Outputs/Outputs.html">Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HardCoded/HardCoded.html">Hard-coded options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials/Tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Analysis/Analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DeveloperGuide/DeveloperGuide.html">Developer’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Glossary/Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../References/References.html">Bibliography</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="extra-options">
<span id="extraschapter"></span><h1>Extra options<a class="headerlink" href="#extra-options" title="Permalink to this heading">#</a></h1>
<section id="turn-off-hydrodynamics">
<span id="nohi"></span><h2>Turn-off hydrodynamics<a class="headerlink" href="#turn-off-hydrodynamics" title="Permalink to this heading">#</a></h2>
<p>Hydrodynamics can be turned off, which essentially creates a Langenvin dynamics simulation with a computationally costly Brownian thermostat.
Though computationally costly, the benefit is that the material properties of the fluid are preserved.
By turning them off, the role of hydrodynamic interactions can be probed.</p>
<p>Hydrodynamic interactions are turned off by randomly exchanging the velocity of all fluid particles after  the collision collision step <a class="reference internal" href="../References/References.html#ali2004" id="id1"><span>[Ali2004]</span></a>.</p>
<p>To turn off hydrodynamic interactions, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;noHI&quot;:         1,</span>
</pre></div>
</div>
<figure class="align-center" id="id23">
<a class="reference internal image-reference" href="../_images/brownian.png"><img alt="Logo" src="../_images/brownian.png" style="width: 469.79999999999995px; height: 451.2px;" /></a>
<figcaption>
<p><span class="caption-text">Hydrodynamic interactions are “scrambled” by randomly exchange particle velocities.</span><a class="headerlink" href="#id23" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>If on the other hand a friction acts on the fluid (like a Brinkman term) (rather than ignoring hydrodynamic interactions), this can be set as a <a class="reference internal" href="Usage.html#damping"><span class="std std-ref">damping friction coefficient</span></a>.</p>
</section>
<section id="nematic-mpcd">
<span id="chapter8"></span><h2>Nematic MPCD<a class="headerlink" href="#nematic-mpcd" title="Permalink to this heading">#</a></h2>
<section id="passive-nematics">
<span id="nematicsection"></span><h3>Passive nematics<a class="headerlink" href="#passive-nematics" title="Permalink to this heading">#</a></h3>
<p>A nematic liquid crystal can be simulated via an MPCD algorithm by including an orientation field.
This is done by assigning each MPCD particle an orientation <span class="math notranslate nohighlight">\(\boldsymbol{u}_i\)</span>, which, when averaged over a cell, leads to a tensor order parameter <span class="math notranslate nohighlight">\(\boldsymbol{Q}_c\)</span> for each cell <a class="reference internal" href="../References/References.html#shendruk2015" id="id2"><span>[Shendruk2015]</span></a>.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\boldsymbol{Q}_c = \frac{1}{d-1}\left\langle d u_i u_i - \boldsymbol{I} \right\rangle_{N_c}\]</div>
</div>
<p>The scalar order parameter <span class="math notranslate nohighlight">\(S_c\)</span> then corresponds to the largest eigenvalue of <span class="math notranslate nohighlight">\(\boldsymbol{Q}\)</span>, while the director <span class="math notranslate nohighlight">\(\vec{n}_c\)</span> is assigned to the corresponding eigenvector.</p>
<section id="nematogen-alignment">
<h4>Nematogen alignment<a class="headerlink" href="#nematogen-alignment" title="Permalink to this heading">#</a></h4>
<p>Similarly to the <a class="reference internal" href="Usage.html#andersen"><span class="std std-ref">Andersen MPCD collision operator</span></a>, the time evolution of the particles’ orientation is carried out through an orientation collision event <a class="reference internal" href="../References/References.html#shendruk2015" id="id3"><span>[Shendruk2015]</span></a>.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\vec{u}_i(t+\delta t) = \Psi_c(U,\boldsymbol{Q}_{c}(t)),\]</div>
</div>
<p>in which <span class="math notranslate nohighlight">\(U\)</span> denotes a globally specified interaction constant that represents the inter-molecular interactions, and as such, sets the energy scale that dictates the time evolution of the particles’ orientation.
More specifically, the algorithm assumes that the local equilibrium distribution for the orientation fields is well described by the Maier-Saupe self-consistent mean-field theory</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_\text{ori} = g \exp(-\beta W_\text{MF}(U,S_c,u_n)),\]</div>
</div>
<p>in which <span class="math notranslate nohighlight">\(u_n \equiv \vec{u}_i\cdot\vec{n}_c\)</span>, <span class="math notranslate nohighlight">\(\beta=1/k_B T\)</span> and</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[W_{\text{MF}} = -U S_c u_n^2 + \frac{U}{d}(S_c-1)\]</div>
</div>
<p>is the mean field interaction potential.</p>
<p>Since the second term in this potential is independent of <span class="math notranslate nohighlight">\(u_n\)</span>, the distribution is controlled by the competition between the thermal energy <span class="math notranslate nohighlight">\(\beta^{-1}\)</span> and the interaction energy <span class="math notranslate nohighlight">\(S_c U\)</span>.
This competition is quantified by the scaled energy <span class="math notranslate nohighlight">\(\beta U S_c\)</span>.
When the scaled energy is small, the distribution is flat, and all values of <span class="math notranslate nohighlight">\(n_c\)</span> are equally likely — ie, isotropic. If, instead, the scaled energy is large, the distribution becomes sharply centered around <span class="math notranslate nohighlight">\(\vec{n}_c\)</span>.</p>
<p>The nematic collision operator works by drawing random orientations from the equilibrium orientation distribution <span class="math notranslate nohighlight">\(f_\mathrm{ori}\)</span>, leading to values centered around <span class="math notranslate nohighlight">\(\vec{n}_c\)</span>.
Due to this, for a high enough cell population, the changes in individual particle orientations, <span class="math notranslate nohighlight">\(\delta\boldsymbol{u}_{\text{col},i} = \vec{u}_i(t+\delta t)-\vec{u}_i(t)\)</span>, do not alter the cell’s director <span class="math notranslate nohighlight">\(\vec{n}_c(t)\)</span>.</p>
</section>
<section id="two-way-couping-between-flow-and-orientation">
<h4>Two-way couping between flow and orientation<a class="headerlink" href="#two-way-couping-between-flow-and-orientation" title="Permalink to this heading">#</a></h4>
<p>While the orientation collision operator deals with the alignment of the nematic MPCD particles, to correctly reproduce nematohydrodynamics it is equally important to incorporate the coupling between the particle’s orientation and the fluid flow.
This coupling comes in two ways:</p>
<ol class="arabic simple">
<li><p>The fluid flow can rotate the particles’ orientation</p></li>
<li><p>The particles’ motion can produce backflow.</p></li>
</ol>
<p>To address this, the nematic MPCD algorithm treats nematogens as if they were rotating through their own flow, envisioning them as dilute rods in a viscous / non-inertial fluid <a class="reference internal" href="../References/References.html#shendruk2015" id="id4"><span>[Shendruk2015]</span></a>.
With this assumption, it follows that the nematic MPCD particles are subjected to three different sources of torque</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\vec{\Gamma}_{\text{net},i} = \vec{\Gamma}_{\text{HI},i}+ \vec{\Gamma}_{\text{col},i}+\vec{\Gamma}_{\text{ext},i}.\]</div>
</div>
<p>These are:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\vec{\Gamma}_{\text{HI},i}\)</span>: Hydrodynamic torques due to the vorticity of the flow field and its shear rate.</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{\Gamma}_{\text{col},i} = \gamma_R\vec{u}_i\times \dot{\vec{u}}_{\text{col},i}\)</span>: The thermal torque caused by the orientational collision operator (where <span class="math notranslate nohighlight">\(\dot{\vec{u}}_{\text{col},i} =\delta\vec{u}_{\text{col},i}/\delta t\)</span> denotes the thermally induced rotation rate).</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{\Gamma}_{\text{ext},i}\)</span>, external torques, caused, for example, by electric fields, magnetic fields or <a class="reference internal" href="Usage.html#chapterbc"><span class="std std-ref">boundaries</span></a>.</p></li>
</ol>
<p>Because this algorithm assumes a viscous overdamped fluid, these torques must balance each other, resulting in a vanishing net torque:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\vec{\Gamma}_{\text{net},i} = 0.\]</div>
</div>
<p>Solving this equation for the rotation rate of an MPCD particle, <span class="math notranslate nohighlight">\(\dot{\vec{u}}_i\)</span>, shows that <span class="math notranslate nohighlight">\(\dot{\vec{u}}_i = \dot{\vec{u}}_{\text{HI},i}+\dot{\vec{u}}_{\text{col},i}\)</span>, in which
<span class="math notranslate nohighlight">\(\dot{\vec{u}}_{\text{col},i}\)</span> is the thermally induced rotation rate and <span class="math notranslate nohighlight">\(\dot{\vec{u}}_{\text{HI},i}\)</span> is the rotation rate induced by the vorticity and shear rate of the fluid.
In the particular case of a thin rod, which is assumed by the algorithm, the latter is described by Jeffery’s equation</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\frac{\delta \vec{u}_{\text{HI},i}}{\delta t} = \chi_{\text{HI}} \left[\vec{u}_i\cdot\vec{w}+\lambda (\vec{u}_i\cdot \vec{D}-\vec{u}_i(\vec{u}_i\vec{u}_i:\vec{\omega}))\right],\]</div>
</div>
<p>in which <span class="math notranslate nohighlight">\(\chi_{HI}\)</span> is an heuristic shear coupling coefficient that sets the alignment relaxation time, <span class="math notranslate nohighlight">\(\lambda\)</span> is the bare tumbling parameter, while <span class="math notranslate nohighlight">\(\vec{D}\)</span> and <span class="math notranslate nohighlight">\(\vec{\omega}\)</span> represent the shear rate and vorticity tensors, respectively.</p>
<p>In turn, the nematic MPCD algorithm included the backflow induced by the nematogen in the fluid by modifiying the <a class="reference internal" href="Usage.html#andersen"><span class="std std-ref">Andersen velocity collision operator</span></a> to include balancing angular impulses, i.e., equal in magnitude but opposite in direction, to those caused by the hydrodynamic torques on each nematogen <span class="math notranslate nohighlight">\(\vec{\Gamma}_{\text{HI},i} = -(\vec{\Gamma}_{\text{col},i}+\vec{\Gamma}_{\text{ext},i})\)</span>.
To counter this impulse with the hydrodynamic drag, this is then transferred to the linear momentum portion of the algorithm, thus modifying the Andersen MPCD collision operator to:</p>
<div class="math-wrapper docutils container" id="eq-nematiccollision">
<span id="equation-eq-nematiccollision"></span><div class="math notranslate nohighlight" id="eq-nematiccollision">
<span id="equation-eq-nematiccollision"></span><span class="eqno">(1)<a class="headerlink" href="#eq-nematiccollision" title="Permalink to this equation">#</a></span>\[\vec{\Xi}^N_{i,c} = \vec{\xi}_i - \langle \xi_j\rangle _{N_c} +\left(\vec{I}_c^{-1}\cdot\left[\delta \vec{L}_c-\sum_{i=1}^{N_c}\vec{\Gamma}_{\text{HI},i}\delta t\right]\right)\times \vec{r}_i'\]</div>
</div>
<p>Proceeding in this way ensures that the system’s total angular momentum is conserved. Furthermore, as setting <span class="math notranslate nohighlight">\(\gamma_R=0\)</span> kills the transfer or momentum for each particle, this also results in turning this coupling off.</p>
</section>
<section id="isotropic-nematic-transition">
<h4>Isotropic-nematic transition<a class="headerlink" href="#isotropic-nematic-transition" title="Permalink to this heading">#</a></h4>
<p>As mentioned above, increasing <span class="math notranslate nohighlight">\(\beta U\)</span> changes the orientation distribution from flat to highly peaked.
Operationally, this means that a system with a small <span class="math notranslate nohighlight">\(\beta U\)</span> will exist in an isotropic fluid state with a global scalar order parameter <span class="math notranslate nohighlight">\(S\)</span> close to zero.
On the contrary, setting a large value of <span class="math notranslate nohighlight">\(\beta U\)</span> will lead to a nematic order.
Even though the algorithm assumes a near-equilibrium Maier-Saupe distribution for the orientation, it does so at the local cell level.
This means that in general the scalar order parameter and the director are spatially varying variables, which allows the system to exist with local nematic order between the two regimes discussed above.
In MPCD units, for a mean population of 20 particles per MPCD cell, in 2D <span class="math notranslate nohighlight">\(U=5\)</span> sets the threshold for nematic order. By default, the code runs at <span class="math notranslate nohighlight">\(U=10\)</span>.</p>
</section>
<section id="frank-elastic-coefficients">
<h4>Frank elastic coefficients<a class="headerlink" href="#frank-elastic-coefficients" title="Permalink to this heading">#</a></h4>
<p>Spatial distortions of the nematic director $vec{n}$ have an energetic cost.
This cost is given by the following free energy density</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f = \frac{1}{2}K_{\text{splay}}(\vec{\nabla}\cdot\vec{n})^2
+\frac{1}{2}K_{\text{twist}}(\vec{n}\cdot\vec{\nabla}\times\vec{n})^2
+\frac{1}{2}K_{\text{bend}}(\vec{n}\times(\vec{\nabla}\times\vec{n}))^2,\]</div>
</div>
<p>in which <span class="math notranslate nohighlight">\(K_{\text{splay}}\)</span>, <span class="math notranslate nohighlight">\(K_{\text{twist}}\)</span> and <span class="math notranslate nohighlight">\(K_{\text{bend}}\)</span> are three coeffiecients quantifying the energetic cost of the three different possible distortions: splay, twist and bend respectively.  This coefficients are collectively known as Frank Elastic coefficients.</p>
<p>In the nematic-MPCD algorithm, <span class="math notranslate nohighlight">\(\beta U\)</span> controls the interaction between nematogens. Thus, it is not surprising that it also sets the Frank coefficients. All three coefficients are of order <span class="math notranslate nohighlight">\(\sim U/a\)</span>. Although in principle there are differences between the three coefficients, in the regime of small rods (compared to interaction lengths) under which nematic MPCD operates, these are negligible, and thus the algorithm presents isotropic elasticity.</p>
</section>
<section id="tumbling-shear-alignment">
<h4>Tumbling &amp; shear alignment<a class="headerlink" href="#tumbling-shear-alignment" title="Permalink to this heading">#</a></h4>
<p>The bare tumbling parameter <span class="math notranslate nohighlight">\(\lambda\)</span> in the Jeffery’s equation only applies in the limit of a dilute suspension of nematogens. Away from that limit, Jeffery’s equation can still be used but, because of nematogen-nematogen interactions) with a renormalized tumbling parameter <a class="reference internal" href="../References/References.html#archer1995" id="id5"><span>[Archer1995]</span></a></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\lambda' = \left(\frac{15\,S+84\,S_4+42}{105\, S}\right) \lambda,\]</div>
</div>
<p>in which <span class="math notranslate nohighlight">\(S_4\)</span> is the fourth moment of the Marie-Soupe distribution.
In the nematic MPCD algorithm, the input is the bare tumbling parameter <span class="math notranslate nohighlight">\(\lambda\)</span>. As such, care must be paid in that what determines the behaviour of the nematogens is <span class="math notranslate nohighlight">\(\lambda'\)</span>, not <span class="math notranslate nohighlight">\(\lambda\)</span>.
For <span class="math notranslate nohighlight">\(\lambda'&lt;1\)</span>, the nematogens tumble, i.e., continuously revolve. For <span class="math notranslate nohighlight">\(|\lambda'|\)</span>&gt;1$ the nematogens experience shear align to the flow.</p>
</section>
<section id="magnetic-fields">
<h4>Magnetic fields<a class="headerlink" href="#magnetic-fields" title="Permalink to this heading">#</a></h4>
<p>External magnetic fields cause torques on the nemtogens, making them want to align with the field.
The free energy associated to this effect is given by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_\text{mag} = -\frac{1}{2} \chi_M B^2 \sin^2(\varepsilon),\]</div>
</div>
<p>in where <span class="math notranslate nohighlight">\(B\)</span> is the magnitude of the magnetic field, <span class="math notranslate nohighlight">\(\varepsilon\)</span> is the angle between the nematogen’s orientation and the magnetic field and <span class="math notranslate nohighlight">\(\chi_M\)</span> is a magnetic susceptibility which sets the strength of this effect.</p>
</section>
</section>
<section id="active-nematic-mpcd">
<span id="activenematic"></span><h3>Active nematic MPCD<a class="headerlink" href="#active-nematic-mpcd" title="Permalink to this heading">#</a></h3>
<p>Active nematics inject energy into the system at the particle level.
In wet systems, as the ones considered so far, they do so while conserving momentum, behaving as force dipoles.
The active nematic MPCD algorithm achieves this at the mesoscale level, i.e., at the level of MPCD cells, by adding an active term to the nematic velocity collision operator so it introduces a force dipole that co-aligns with the cell director <span class="math notranslate nohighlight">\(\vec{n}_c\)</span> <a class="reference internal" href="../References/References.html#kozhukhov2022" id="id6"><span>[Kozhukhov2022]</span></a>.</p>
<p>In order to induce force dipoles, a planar collision operator is applied to the nematic particles in the cell:
A plane normal to the cell’s director, <span class="math notranslate nohighlight">\(\vec{n}_C\)</span>, is placed at the cell center of mass.
Particles forward of the plane get a kick forward, and particles backward of the plane get a kick backward.</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/ActivityDiagram-0.png"><img alt="../_images/ActivityDiagram-0.png" class="align-center" src="../_images/ActivityDiagram-0.png" style="width: 95%;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/ActivityDiagram-1.png"><img alt="../_images/ActivityDiagram-1.png" class="align-center" src="../_images/ActivityDiagram-1.png" style="width: 95%;" /></a>
</td>
</tr>
<tr class="row-even"><td><p><strong>(a)</strong> Bin MPCD particles into cells.</p></td>
<td><p><strong>(b)</strong> Place a plane normal to the cell director at the cell center of mass.</p></td>
</tr>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/ActivityDiagram-2.png"><img alt="../_images/ActivityDiagram-2.png" class="align-center" src="../_images/ActivityDiagram-2.png" style="width: 95%;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/ActivityDiagram-3.png"><img alt="../_images/ActivityDiagram-3.png" class="align-center" src="../_images/ActivityDiagram-3.png" style="width: 95%;" /></a>
</td>
</tr>
<tr class="row-even"><td><p><strong>(c)</strong> For each MPCD particle forward of the plane, give a kick forward, and vica-versa.</p></td>
<td><p><strong>(d)</strong> Apply kicks to the post-nematic velocity collision.</p></td>
</tr>
</tbody>
</table>
</div>
<p>This is sufficient to reproduce a local force dipole within each cell.
Furthermore, the positioning of the plane ensures that this operation conserves linear momentum, despite the local injection of energy.</p>
<p>Mathematically, this collision operation is expressed as:</p>
<div class="math-wrapper docutils container" id="eq-activenematiccollision">
<span id="equation-eq-activenematiccollision"></span><div class="math notranslate nohighlight" id="eq-activenematiccollision">
<span id="equation-eq-activenematiccollision"></span><span class="eqno">(2)<a class="headerlink" href="#eq-activenematiccollision" title="Permalink to this equation">#</a></span>\[\vec{\Xi}_i^\mathrm{AN}(t) =
\vec{\Xi}_i^\mathrm{N}(t) +
\alpha_C \delta t \left(
    \frac{\kappa_i}{m_i} - \langle \frac{\kappa_j}{m_j} \rangle_C
\right)\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\kappa_i=\pm1\)</span> represent whether a particle is forward or backward of the plane <a class="reference internal" href="../References/References.html#kozhukhov2022" id="id7"><span>[Kozhukhov2022]</span></a>.</p>
<p>The active contribution is then composed of two terms:</p>
<ol class="arabic simple">
<li><p>The first term, <span class="math notranslate nohighlight">\(\alpha_c\delta_t\left(\frac{\kappa_i}{m_i}\right)\vec{n}\)</span>, corresponds to the active force driving a change in momentum over delta t. EXplicitly, it provides individual impulses (per unit mass) to each particle.</p></li>
<li><p>The second term, <span class="math notranslate nohighlight">\(-\alpha_c\delta_t\left\langle\frac{\kappa_j}{m_j}\right\rangle_c\vec{n}\)</span>, ensures the conservation of momentum inside the cell by removing any residual impulse.</p></li>
</ol>
<p>In this regard, the philosophy behind this active term is similar to the one behind the usual passive Andersen collision operator. The difference comes through in that the impulses imparted to each particle are not random. Instead, they have a fixed strength, set by <span class="math notranslate nohighlight">\(\alpha_c\delta t/m_i\)</span>, and are parallel or anti-parallel to the cell director <span class="math notranslate nohighlight">\(\vec{n}_c\)</span>, thus directly coupling the orientational and translational degrees of freedom.</p>
<section id="variation-on-the-strength-of-activity">
<h4>Variation on the strength of activity<a class="headerlink" href="#variation-on-the-strength-of-activity" title="Permalink to this heading">#</a></h4>
<p>As explained above, <span class="math notranslate nohighlight">\(\alpha_c\)</span> sets the strength of the active dipoles, and thus of the active stress.
In the algorithm, particles individually carry an activity <span class="math notranslate nohighlight">\(\alpha_i\)</span> — The algorithm can interpret this into a dipole strength <span class="math notranslate nohighlight">\(\alpha_c\)</span> in four different ways, encoded as four different collision operators:</p>
<ol class="arabic simple">
<li><p>Particle-carried activity — 16</p></li>
<li><p>Cell-carried activity — 17</p></li>
<li><p>Modulated cell-carried activity — 20</p></li>
<li><p>Modulated particle-carried activity — 21</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For optimal density behaviour, we recommend using
modulated particle-carried activity (collision operator ID 21).</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note: You can use <span class="math notranslate nohighlight">\(\alpha_i &lt; 0\)</span> to simulate contractile nematics, but only in a very limited regime.</p>
</div>
<section id="particle-carried-activity">
<h5>Particle-carried activity<a class="headerlink" href="#particle-carried-activity" title="Permalink to this heading">#</a></h5>
<p>In this version of the collision operator, each particle is thought to carry its own activity. The cell activity <span class="math notranslate nohighlight">\(\alpha_c\)</span>  is just the sum of the activities of all the particles inside the cell</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\alpha^P_c = \sum_{i=1}^{N_c}\alpha_i\]</div>
</div>
<p>This implies that with this choice, the strength of the active impulses provided by the collision operator increases with the population of the cell. In general, this leads to large density fluctuations which reduce the operational regime of the algorithm and make it unsuitable to treat solutes such as colloids, swimmers and polymers.</p>
<p>This is implemented with a keycode of <code class="docutils literal notranslate"><span class="pre">16</span></code>, and can be used by adding the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;collOp&quot;: 16</span>
</pre></div>
</div>
</section>
<section id="cell-carried-activity">
<h5>Cell-carried activity<a class="headerlink" href="#cell-carried-activity" title="Permalink to this heading">#</a></h5>
<p>An alternative formulation is to interpret activity as a property of the cell, rather than of the particles.
In this version of the collision opertor, we interpret cell activity strength as the mean activities for all particles inside the cell</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\alpha^C_c = \frac{1}{N_c}\sum_{i=1}^{N_c}\alpha_i\]</div>
</div>
<p>making the cell activity strength largely independent of the cell’s population.
In the particular case in which all particles have the same activity (for a example, a simulation with a single species), this makes the cell activity strength the same among all cells.</p>
<p>This is implemented with a keycode of <code class="docutils literal notranslate"><span class="pre">17</span></code>, and can be used by adding the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;collOp&quot;: 17</span>
</pre></div>
</div>
</section>
<section id="modulated-particle-carried-cell-carried-activity">
<h5>Modulated particle-carried &amp; cell-carried activity<a class="headerlink" href="#modulated-particle-carried-cell-carried-activity" title="Permalink to this heading">#</a></h5>
<p>In addition to the above choices of activity strength, the algorithm also offers the possibility to couple the cell activity strength to the cell population by supressing it at high densities. This leads to two more collision operators: Modulated particle carried activity and Modulated cell carried activity.</p>
<p>The way in which this suprression takes place is through a modulation function, which takes the form of a sigmoid:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[S_C(N_C; \sigma_p, \sigma_w) = \frac{1}{2}\left(1-\tanh\left(\frac{N_c-\langle N_c\rangle (1+\sigma_P)}{\langle N_c\rangle \sigma_W}\right)\right),\]</div>
</div>
<p>This modulation function takes the local cell number density, <span class="math notranslate nohighlight">\(\rho_C\)</span>, and returns a values in the range <span class="math notranslate nohighlight">\([0, 1]\)</span> to modulate it.
This is controlled by two parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\sigma_p\)</span> is a decimale repesenting where the modulation function is centred relative, in units of mean density.</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_w\)</span> is a decimal representing how wide the modulation drop-off should be, in units of the mean density.</p></li>
</ul>
<p>These are configured with species-based parameters <code class="docutils literal notranslate"><span class="pre">&quot;sigPos&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;sigWidth&quot;</span></code> in the input <code class="docutils literal notranslate"><span class="pre">.json</span></code> respectively.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-center">
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/ANModulationFn.png"><img alt="../_images/ANModulationFn.png" class="align-center" src="../_images/ANModulationFn.png" style="width: 95%;" /></a>
</td>
</tr>
<tr class="row-even"><td><p>A demonstration of the sigmoidal modulation function <span class="math notranslate nohighlight">\(\mathcal{S}_C(\rho_C; \sigma_p, \sigma_w)\)</span>.
Here, <span class="math notranslate nohighlight">\(\langle\rho_C\rangle=5\)</span> for illustration purposes, with <span class="math notranslate nohighlight">\(\sigma_p=1\)</span> and <span class="math notranslate nohighlight">\(\sigma_w=1\)</span>.</p></td>
</tr>
</tbody>
</table>
</div>
<p>This modulation function is then applied to each cells active force magnitude, giving two new formulations:</p>
<ul class="simple">
<li><p><strong>Modulated cell-carried</strong>: <span class="math notranslate nohighlight">\(\alpha_C^\mathrm{MC} = \mathcal{S}_C(\rho_C) \alpha_C^\mathrm{C}\)</span></p></li>
<li><p><strong>Sigmoidal-Sum</strong>: <span class="math notranslate nohighlight">\(\alpha_C^\mathrm{MP} = \mathcal{S}_C(\rho_C) \alpha_C^\mathrm{P}\)</span></p></li>
</ul>
<p>These are implemented with keycodes <code class="docutils literal notranslate"><span class="pre">20</span></code> and <code class="docutils literal notranslate"><span class="pre">21</span></code> respectively, and can be used by adding the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;collOp&quot;: 20</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;collOp&quot;: 21</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="inputs-for-nematic-mpcd">
<h3>Inputs for nematic MPCD<a class="headerlink" href="#inputs-for-nematic-mpcd" title="Permalink to this heading">#</a></h3>
<section id="main-input-tags">
<h4>Main input tags<a class="headerlink" href="#main-input-tags" title="Permalink to this heading">#</a></h4>
<p>To make an MPCD fluid a nematic, the input file must turn on the liquid crystal mode, which is done by setting the main input tag lc to 1 (default value is 0)</p>
<blockquote>
<div><div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>lc</p></td>
<td><p>int</p></td>
<td><p>Liquid crystal mode: 1 (on), 0 (off, default)</p></td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
<p>In addition, because of the need to conserve angular momentum, the velocity collision operator must be set to the Andersen collision operator that preserves angular momentum. This is done by setting the main input tag rTech to 3 (for a passive nematic) or 16, 17, 20 or 21 for an active nematic.</p>
<blockquote>
<div><div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>collOp</p></td>
<td><p>int</p></td>
<td><p>Collision operator: 3 (passive); 16, 17, 20 or 21 (active)</p></td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
<p>Other main input tags that modify the behaviour of the liquid crystal are:</p>
<blockquote>
<div><div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>mfpot</p></td>
<td><p>double</p></td>
<td><p>Mean field potential (interaction energy) <span class="math notranslate nohighlight">\(U\)</span> (default 10)</p></td>
</tr>
<tr class="row-even"><td><p>mag</p></td>
<td><p>array (double)</p></td>
<td><p>Constant external magnetic field (source of external torque, default [0,0,0])</p></td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
</section>
<section id="species-tags">
<h4>Species tags<a class="headerlink" href="#species-tags" title="Permalink to this heading">#</a></h4>
<p>The following are species depenten tags (i.e., they must be set in the species environment in the json input file) that apply for all nematic liquid crystals (passive and active)</p>
<blockquote>
<div><div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>oDist</p></td>
<td><p>int</p></td>
<td><p>Initial orientation: 0 (random), 1 (<span class="math notranslate nohighlight">\(x\)</span>-axis), 2 (<span class="math notranslate nohighlight">\(y\)</span>-axis), 3 (<span class="math notranslate nohighlight">\(z\)</span>-axis) <a class="footnote-reference brackets" href="#id9" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></td>
</tr>
<tr class="row-even"><td><p>rfc</p></td>
<td><p>double</p></td>
<td><p>Nematogen rotational friction coefficient <span class="math notranslate nohighlight">\(\gamma_R\)</span> (default 0.01)</p></td>
</tr>
<tr class="row-odd"><td><p>tumble</p></td>
<td><p>double</p></td>
<td><p>Bare tumble parameter <span class="math notranslate nohighlight">\(\lambda\)</span> (default 2)</p></td>
</tr>
<tr class="row-even"><td><p>shearSusc</p></td>
<td><p>double</p></td>
<td><p>Hydrodynamic shear susceptibility <span class="math notranslate nohighlight">\(\chi_{\text{HI}}\)</span> (default 0.5)</p></td>
</tr>
<tr class="row-odd"><td><p>len</p></td>
<td><p>double</p></td>
<td><p>Effective rod lenght (only relevant for boundary conditions, see CITE  , default 0.0007)</p></td>
</tr>
<tr class="row-even"><td><p>magnSusc</p></td>
<td><p>double</p></td>
<td><p>Magnetic Suceptibility <span class="math notranslate nohighlight">\(\chi_M\)</span> (defaul 0.0001)</p></td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
<p>Active nematic have additional parameters.</p>
<blockquote>
<div><div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>act</p></td>
<td><p>double</p></td>
<td><p>Activity of the species (default 0.05)</p></td>
</tr>
<tr class="row-even"><td><p>sigWidth</p></td>
<td><p>double</p></td>
<td><p>For modulated active collision operators. Width of the modulating sigmoid <span class="math notranslate nohighlight">\(\sigma_W\)</span> (default 1.0, cannot be 0)</p></td>
</tr>
<tr class="row-odd"><td><p>sigPos</p></td>
<td><p>double</p></td>
<td><p>For modulated active collision operators. Width of the modulating sigmoid <span class="math notranslate nohighlight">\(\sigma_P\)</span> (default sigWidth )</p></td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
<p>To minimize density variations, the recommended active collision operator is the modulated average (collOp 20).</p>
</section>
</section>
<section id="outputs-for-nematic-mpcd">
<h3>Outputs for nematic MPCD<a class="headerlink" href="#outputs-for-nematic-mpcd" title="Permalink to this heading">#</a></h3>
<p>The nematic MPCD algorithm introduces as outputs</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Q\)</span> tensor field (tag: qTensOut)</p></li>
<li><p>Director field and scalar order parameter field (tag: dirSOut)</p></li>
<li><p><span class="math notranslate nohighlight">\(Q\)</span> tensor field in reciprocal space (tag: qkTensOut)</p></li>
<li><p>Orientational energy field (tag: oriEnOut)</p></li>
</ul>
<p>It is also possible to ask for statistical data</p>
<ul class="simple">
<li><p>Distribution of the director components (tag: histDirOut)</p></li>
<li><p>Distribution of the scalar order parameter (tag: histSOut)</p></li>
<li><p>Radial director autocorrelation function (tag: dirCorrOut)</p></li>
<li><p>Radial scalar order parameter autocorrelation function (tag: orderCorrOut)</p></li>
</ul>
<p>Finally, the algorithm also posses utilities to compute on the fly topological features of the liquid crystal</p>
<ul class="simple">
<li><p>Topological charge field (tag: topoFieldOut)</p></li>
<li><p><span class="math notranslate nohighlight">\(2D\)</span> defects’ positions and orientations (tag: defectsOut)</p></li>
<li><p>Disclination tensor field (disclinOut)</p></li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id9" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">1</a><span class="fn-bracket">]</span></span>
<p>For more options see the section on <a class="reference internal" href="Usage.html#orientation"><span class="std std-ref">particle properties</span></a>.</p>
</aside>
</aside>
</section>
</section>
<section id="viscek-mpcd">
<span id="chapter9"></span><h2>Viscek MPCD<a class="headerlink" href="#viscek-mpcd" title="Permalink to this heading">#</a></h2>
<section id="vicsek-model-of-collective-motion">
<h3>Vicsek model of collective motion<a class="headerlink" href="#vicsek-model-of-collective-motion" title="Permalink to this heading">#</a></h3>
<p>This collission operator is based on the famous vicsek model of self-driven particles <a class="reference internal" href="../References/References.html#vicsek1995" id="id10"><span>[Vicsek1995]</span></a>. It describes the collective behavior in the simplest possible way.  It was designed to explore how local interactions among simple, self-propelled particles can give rise to global order and collective motion.
Key Principles of the Vicsek Model:</p>
<ul class="simple">
<li><p><strong>Self-Propelled Particles</strong>: The fundamental units in the Vicsek Model are self-propelled particles, often referred to as agents or individuals. These particles move at a constant speed and possess a heading direction, which can be influenced by their local neighbors.</p></li>
<li><p><strong>Local Interaction</strong>: Agents interact with their immediate neighbors within a defined radius, simulating a finite perception range. These interactions involve aligning their velocities and directions to some extent.</p></li>
<li><p><strong>Noise</strong>: The model incorporates a random noise factor to account for unpredictability and stochasticity in the behavior of real-world entities.</p></li>
<li><p><strong>Order Parameter</strong>: The degree of alignment among the agents is quantified using an “order parameter,” which measures the average direction of motion across the group. This parameter helps to determine whether the system exhibits collective motion or remains in a disordered state.</p></li>
</ul>
</section>
<section id="vicsek-mpcd">
<h3>Vicsek MPCD<a class="headerlink" href="#vicsek-mpcd" title="Permalink to this heading">#</a></h3>
<p>MPCD employ a square-shaped cell. The particles are represented as continuously moving points on a plane, following a continuous trajectory (off-lattice).</p>
<figure class="align-center" id="id24">
<a class="reference internal image-reference" href="../_images/VicsekMPCD.jpg"><img alt="Logo" src="../_images/VicsekMPCD.jpg" style="width: 743.0px; height: 681.5px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>An example of Vicsek particles in the 2D square system</strong></span><a class="headerlink" href="#id24" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Particle positions are being update as in <a class="reference internal" href="Background.html#eq-stream"><span class="std std-ref">Streaming step</span></a>. The positions of individual particles at time <span class="math notranslate nohighlight">\(t + 1\)</span> are updated based on their current positions and velocities. Each particle moves in the direction of its velocity vector by a certain distance.</p>
<div class="math-wrapper docutils container" id="eq-positionvicsek">
<span id="equation-eq-positionvicsek"></span><div class="math notranslate nohighlight" id="eq-positionvicsek">
<span id="equation-eq-positionvicsek"></span><span class="eqno">(3)<a class="headerlink" href="#eq-positionvicsek" title="Permalink to this equation">#</a></span>\[\vec{r}_i(t+\delta t) = \vec{r}_i(t)+\delta t \cdot v_0 \cdot \vec{u}_i(t)\]</div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\vec{r}_i(t+\delta t)\)</span> is the position of particle <span class="math notranslate nohighlight">\(i\)</span> at time <span class="math notranslate nohighlight">\(t + \delta t\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{r}_i(t)\)</span> is the current position of particle <span class="math notranslate nohighlight">\(i\)</span> at time <span class="math notranslate nohighlight">\(t\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(\delta t\)</span> is the time step;</p></li>
<li><p><span class="math notranslate nohighlight">\(v_0\)</span> is the constant speed of the particle;</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{u}_i(t)\)</span> is the normalized velocity vector of particle <span class="math notranslate nohighlight">\(i\)</span> at time <span class="math notranslate nohighlight">\(t\)</span>;</p></li>
</ul>
<p>Velocity Alignment are similar with the <a class="reference internal" href="Background.html#eq-collision"><span class="std std-ref">collision step</span></a>. The velocity of each particle at time <span class="math notranslate nohighlight">\(t + 1\)</span> is updated by averaging the velocities of its neighbors within a specified radius, and then normalizing the resulting velocity vector.</p>
<div class="math-wrapper docutils container" id="eq-velocityvicsek">
<span id="equation-eq-velocityvicsek"></span><div class="math notranslate nohighlight" id="eq-velocityvicsek">
<span id="equation-eq-velocityvicsek"></span><span class="eqno">(4)<a class="headerlink" href="#eq-velocityvicsek" title="Permalink to this equation">#</a></span>\[\vec{u}_i(t+\delta t) = \frac{1}{N_c} \sum_{j=1}^{N_c} \vec{u}_j(t) + \eta \cdot \delta \Theta\]</div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\vec{u}_i(t+\delta t)\)</span> is the updated velocity vector of particle <span class="math notranslate nohighlight">\(i\)</span> at time <span class="math notranslate nohighlight">\(t + \delta t\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(N_c\)</span> is the number of neighbors within the cell <span class="math notranslate nohighlight">\(c\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{u}_j(t)\)</span> is the velocity vector of the <span class="math notranslate nohighlight">\(j\)</span>-th neighboring particle at time <span class="math notranslate nohighlight">\(t\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(\eta\)</span> is a noise parameter that introduces random perturbations;</p></li>
<li><p><span class="math notranslate nohighlight">\(\delta \Theta\)</span> is a random angle drawn from a uniform distribution;</p></li>
</ul>
<p>Example configuration for the Vicsek system. Let`s say we would have 100 by 100 square system.</p>
<p>input.json</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
</pre></div>
</div>
<p>with 1000 simluation steps and 0 warmup steps</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;warmUp&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="s2">&quot;simSteps&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
</pre></div>
</div>
<p>In order to use standart Vicsek collision operator described above set collOp paramater to 7</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;collOp&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
</pre></div>
</div>
<p>Let`s conigure one specie to have mass 1, activity value 0.5 and have random distribution.
Activity value is used as noise in the next form <span class="math notranslate nohighlight">\(\eta = 1.0 - act\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Particle density of 10 within square area&quot;</span><span class="p">,</span>
            <span class="s2">&quot;dens&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Particle`s mass&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mass&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Particle activity, effectively is used as noise. But in the next form noise = 1.0 - act&quot;</span><span class="p">,</span>
            <span class="s2">&quot;act&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Random distribution function for particles&quot;</span><span class="p">,</span>
            <span class="s2">&quot;qDist&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
    <span class="p">],</span>
</pre></div>
</div>
<p>Let`s set gravity and magnetic fields to zero.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;grav&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="s2">&quot;mag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
</pre></div>
</div>
<p>And this is enough in order to have classic vicsek experiment.</p>
<p>The main disadvantage of the vicsek collision operator is the luck of conservation laws. The one thing which is being conserved is the number of particles. However MPCD can propose modifications of the vicsek collision operator in order to apply conservation laws.</p>
</section>
<section id="vicsek-anderson-mpcd">
<h3>Vicsek-Anderson MPCD<a class="headerlink" href="#vicsek-anderson-mpcd" title="Permalink to this heading">#</a></h3>
<p>This collision operator applies a thermostat to the simulation <a class="reference internal" href="../References/References.html#holm2009" id="id11"><span>[Holm2009]</span></a>. The collision operator generates random velocity vectors for all the MPCD particles in the cell. The random velocitities are drawn from Gaussian distribtions with variance <span class="math notranslate nohighlight">\(\sqrt{k_BT/m}\)</span> and so obey Maxwell-Boltzmann statistics. The average of the random velocities is then subtracted from all to conserve momentum. Energy is not conserved; rather the system is thermostatted to <cite>KBT</cite>. Also does not conserve angular momentum.
If the streaming step remains the same the <a class="reference internal" href="Background.html#eq-collision"><span class="std std-ref">collision opearator</span></a> has the next form:</p>
<div class="math-wrapper docutils container" id="eq-vicsekanderson">
<span id="equation-eq-vicsekanderson"></span><div class="math notranslate nohighlight" id="eq-vicsekanderson">
<span id="equation-eq-vicsekanderson"></span><span class="eqno">(5)<a class="headerlink" href="#eq-vicsekanderson" title="Permalink to this equation">#</a></span>\[\vec{v}_i(t + \delta t) = \vec{v}_{cm} + \tau (\alpha \hat{v}_{cm} - \vec{v}_i(t)) + \vec{\xi}_i - \langle \vec{\xi} \rangle\]</div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\vec{v}_{cm}\)</span> - represents the center of mass velocity of the cell.</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{v}_{cm} = \vec{v}_{cm}/|v_{cm}|\)</span> - denotes the unit vector indicating the direction of the velocity.</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{\xi}_i\)</span> - stands for a random velocity assigned to each particle.</p></li>
<li><p><span class="math notranslate nohighlight">\(\langle \vec{\xi} \rangle\)</span> - signifies the cell average of random velocities.</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau\)</span> - is a relaxation rate parameter.</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> - represents the target speed.</p></li>
</ul>
<p>Effectively, this collision operator computes a new velocity for each fluid particle within a cell. It is composed of the center of mass velocity of the cell, a random direction of the center of mass, minus the sum of all random velocities within the cell. Importantly, this collision operator conserves momentum, which leads to more physically realistic particle behavior.</p>
<p>In order to run experiment with this collision operator you need to change collOp value to 11</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;collOp&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
</pre></div>
</div>
<p>Additionaly we can configure temperature relaxation time and kbt value</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;tau&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="s2">&quot;kbt&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>The Anderson-MPCD algorithm discussed so far conserves mass, energy and translational momentum but, just like the Vicsek collision operator, it does not conserve angular momentum. However, it can be extended to do so.</p>
</section>
<section id="vicsek-langevin-mpcd">
<h3>Vicsek-Langevin MPCD<a class="headerlink" href="#vicsek-langevin-mpcd" title="Permalink to this heading">#</a></h3>
<p>In conserving the angular momentum of the cell, the position of each fluid particle relative to the centre of mass of the cell <span class="math notranslate nohighlight">\(\vec{x}^{'}_i = \vec{x}_i + \vec{x}^{cm}\)</span> is important. The VicseAndersen-MPCD algorithm creates a small change in angular momentum every collision step. Let this amount be denoted <span class="math notranslate nohighlight">\(\delta \vec{L}\)</span>. This angular momentum can be exactly cancelled out by giving the entire cell an appropriate angular velocity <span class="math notranslate nohighlight">\(\vec{\omega}\)</span>. If the set of particles in the cell have a moment of inertia tensor <span class="math notranslate nohighlight">\(\hat{I}\)</span> about the centre of mass then the angular velocity needed to cancel the residual angular momentum is <span class="math notranslate nohighlight">\(\vec{\omega} = \hat{I}^{-1} \cdot \delta \vec{L}\)</span>.
The <a class="reference internal" href="Background.html#eq-collision"><span class="std std-ref">collision operator</span></a> is expressed as follows:</p>
<div class="math-wrapper docutils container" id="eq-vicseklangevin">
<span id="equation-eq-vicseklangevin"></span><div class="math notranslate nohighlight" id="eq-vicseklangevin">
<span id="equation-eq-vicseklangevin"></span><span class="eqno">(6)<a class="headerlink" href="#eq-vicseklangevin" title="Permalink to this equation">#</a></span>\[\vec{v}_i(t+\delta t) = a\vec{v}_i(t) + b\vec{\xi}_i\]</div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a = \frac{2m- \gamma \delta t}{2m+ \gamma \delta t}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(b = \frac{2\sqrt{\gamma \delta t}}{2m + \gamma \delta t}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> is the mass of the particle.</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{v}_i\)</span> is the velocity of the particle.</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{v}_{cm}\)</span> stands for the center of mass velocity of the cell.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_c\)</span> is the number of particles in the cell.</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span> constant which is represent resistive, viscous force that opposes the motion of the fluid particles.</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{\xi}_i\)</span> white noise constant.</p></li>
</ul>
<p>Similar to the rest, in order to launch experiment with this collision operator set collOp parameter to 12</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;collOp&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
</pre></div>
</div>
<p>In the equation we have friction coefficient which we also able to set</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;fricCoef&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
</pre></div>
</div>
</section>
</section>
<section id="multiphase">
<span id="chapter10"></span><h2>Multiphase<a class="headerlink" href="#multiphase" title="Permalink to this heading">#</a></h2>
<p>Multiphase fluids are implemented in this simulator by allowing for several species of particles with species-wide properties (mass, density, …)
to coexist and interact through a tuneable interaction. The theory behind this interaction is described in the <a class="reference internal" href="#landauginz"><span class="std std-ref">free energy of a bimodal fluid</span></a>
section, and the broad lines of the implementation in this algorithm are described in the <a class="reference internal" href="#mpimp"><span class="std std-ref">implementation in MPCD</span></a> section.</p>
<section id="free-energy-of-a-bimodal-fluid">
<span id="landauginz"></span><h3>Free energy of a bimodal fluid<a class="headerlink" href="#free-energy-of-a-bimodal-fluid" title="Permalink to this heading">#</a></h3>
<p>A multi-phase mixture can be described by a Landau-Ginzburg free energy functional depending on the local compositional order parameter <em>𝜙</em>,
defined as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[F = \int d^d r (\frac{\tau}{2}\phi^2+\frac{b}{4}\phi^4+\frac{\kappa}{2}(\nabla \phi)^2) ,\]</div>
</div>
<p>where <em>d</em> is the number of dimensions in the system, <em>b</em> and <em>τ</em> describe the bulk dynamic and phase separation, and <em>𝜅</em> is a surface tension
coefficient <a class="reference internal" href="../References/References.html#cates2018" id="id12"><span>[Cates2018]</span></a>. Minimising this free energy with the Euler-Lagrange equation reveals the equation of motion for the system.</p>
</section>
<section id="implementation-in-mpcd">
<span id="mpimp"></span><h3>Implementation in MPCD<a class="headerlink" href="#implementation-in-mpcd" title="Permalink to this heading">#</a></h3>
<p>To apply the equations of motion obtained through the previous paragraph, the value of compositional order must be calculated. In MPCD,
the compositional order at the scale of a cell consists of a series of Dirac delta distributions: each particle belongs to exactly one species.
This means that computing the gradient in compositional order, which is essential for accurate surface tension simulation. Two ways to smooth
this discrete distribution are presented below.</p>
<p>Bimodal models have been simulated in MPCD before using super-cells: close-by cells are grouped together, allowing for the compositional order
to be calculated between cells within the supercell <a class="reference internal" href="../References/References.html#eisenstecken2018" id="id13"><span>[Eisenstecken2018]</span></a>. The equations of motions derived from the relevant free energy can then
be applied, and phase separation is achieved - but only to the scale of supercells.</p>
<p>In this code, the compositional order parameter is estimated as a quadratic function. This allows for the gradient to be computed,
while avoiding to capture two much of the MPCD noise in the phase separation dynamics. The contributions derived from the relevant free energy
are superimposed on any given collision operators <a class="reference internal" href="../References/References.html#koch2023" id="id14"><span>[Koch2023]</span></a>. This algorithm can therefore resolve surface tension effects up to the
cell-length scale. This method still works for N&gt;=2 fluid species by running the same algorithm for each pair of species, and so a variety of multiphase fluids can be simulated.</p>
</section>
</section>
<section id="molecular-dynamics">
<span id="chapter11"></span><h2>Molecular dynamics<a class="headerlink" href="#molecular-dynamics" title="Permalink to this heading">#</a></h2>
<p>Molecular Dynamics (MD) numerically integrates the classical equations of motion for a large number of particles that interact via a set of pair potentials <a class="reference internal" href="../References/References.html#slater2009" id="id15"><span>[Slater2009]</span></a>. It is a common approach to simulate polymer dynamics. Polymer molecules are composed of a large number of equal repeat units called monomers which are connected linearly by bonds.</p>
<section id="dry-sytsem">
<h3>Dry sytsem<a class="headerlink" href="#dry-sytsem" title="Permalink to this heading">#</a></h3>
<p>The term <strong>dry</strong> indicates that there are no hydrodynamic interactions included. Moreover, in our version of the MD solver the dynamics of the chain monomers is determined by Newtons’ equations of motion (No noise). These equations are integrated using the velocity Verlet algorithm.  The standard implementation scheme of this algorithm is to</p>
<ol class="arabic simple">
<li><p>calculate <span class="math notranslate nohighlight">\({\vec v}(t+1/2 {\Delta}t) = {\vec v}(t) + 1/2 {\vec a}(t){\Delta}t\)</span>.</p></li>
<li><p>calculate <span class="math notranslate nohighlight">\({\vec x}(t+{\Delta}t) = {\vec x}(t) + {\vec v}(t+1/2{\Delta}t){\Delta}t\)</span>.</p></li>
<li><p>derive <span class="math notranslate nohighlight">\({\vec a}(t+{\Delta}t)\)</span> from the interaction potentials using <span class="math notranslate nohighlight">\({\vec x}(t+{\Delta}t)\)</span>.</p></li>
<li><p>calculate <span class="math notranslate nohighlight">\({\vec v}(t+{\Delta}t) = {\vec v}(t+1/2{\Delta}t) + 1/2 {\vec a}(t+{\Delta}t) {\Delta}t\)</span>.</p></li>
</ol>
<p>This algorithm gives the particle’s velocity and position at the next time step using the interaction forces from the potentials as <span class="math notranslate nohighlight">\(f = - \nabla U(r_{ij})\)</span> for pairs of particles that are separated by a distance <span class="math notranslate nohighlight">\(r_{ij}\)</span>. The most common pair potentials for simulating polymers are</p>
<ul class="simple">
<li><p><strong>Lennard-Jones (LJ) Potential</strong>, <span class="math notranslate nohighlight">\(U_{\text{LJ}}\)</span>: The interaction between two free, uncharged molecules (respectively labelled <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>)</p></li>
</ul>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[U_{\text{LJ}}(r_{ij}) = 4\epsilon \left[ \left(\frac{\sigma}{r_{ij}}\right)^{12} - \left(\frac{\sigma}{r_{ij}}\right)^6 \right],\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(r_{ij}\)</span> is the separation between two monomers, <span class="math notranslate nohighlight">\(\epsilon\)</span> is the well depth and <span class="math notranslate nohighlight">\(\sigma\)</span> is the effective diameter of the pair of MD particles.</p>
<ul class="simple">
<li><p><strong>Weeks-Chandler-Andersen (WCA) Potential</strong>, <span class="math notranslate nohighlight">\(U_{\text{WCA}}\)</span>: A purely repulsive, truncated form   of the LJ potential commonly used as a coarse-grained interaction. The LJ potential is shifted and truncated at its minimum value so that it ends smoothly at a distance <span class="math notranslate nohighlight">\(r_c\)</span>. The WCA potential can be written as</p></li>
</ul>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}U{\text{WCA}}(r_{ij}) = 4\epsilon
\begin{cases}
     \left(\frac{\sigma}{r_{ij}}\right)^{12} - \left(\frac{\sigma}{r_{ij}}\right)^6
    + \frac{1}{4},
    &amp; r_{ij}&lt;r_c\\
    0,
    &amp; r_{ij}&gt;r_c
\end{cases}\end{split}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(r_c = \sqrt[6]{2}\sigma\)</span>.</p>
<ul class="simple" id="fene">
<li><p><strong>Finitely Extensible Bonds</strong>, <span class="math notranslate nohighlight">\(U_{\text{FENE}}\)</span>: In any coarse-grained model of a polymer, adjacent MD beads must be connected together to form a chain of monomers. The use of harmonic potentials can lead to unphysical bond stretching effects. For this reason, a finitely extensible force with a hard limit on the bond length is utilized <a class="reference internal" href="../References/References.html#wu2014" id="id16"><span>[Wu2014]</span></a>. The most common choice is the finitely extensible nonlinear elastic potential (FENE):</p></li>
</ul>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[U_{\text{FENE}}(r_{ij})
= -\frac{k_{\text{FENE}}}{2} {r_0}^2 \ln
\left( 1-\frac{{r_{ij}}^2}{{r_0}^2} \right),\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(k_{\text{FENE}}\)</span> is a spring constant representing the stiffness of the bond in response to stretching and <span class="math notranslate nohighlight">\(r_0\)</span> is the maximum length of the bonds.</p>
<ul class="simple" id="bending-potential">
<li><p><strong>Bond Bending Potential</strong>, <span class="math notranslate nohighlight">\(U_{\text{Bend}}\)</span>: This potential captures the stiffness of the polymer in response to bending force. Since the simulations are coarse-grained these are not intended to represent chemical bending potentials but can give polymer chains microscopic characteristics such as correlations along the back-bone (a non-zero persistence length). There are several bending potentials including angular harmonic, cosine harmonic or cosine expansion <a class="reference internal" href="../References/References.html#bulacu2013" id="id17"><span>[Bulacu2013]</span></a>. For instance angular harmonic is given by</p></li>
</ul>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[U_{\text{Bend}}(\theta _{ijk}) = \frac{k_{\text {Bend}}}{2} (\theta _{ijk} - \vartheta)^2.\]</div>
</div>
<p>The angle <span class="math notranslate nohighlight">\(\theta_{ijk}\)</span> is the angle created by three consecutive monomers <span class="math notranslate nohighlight">\(i, j\)</span> and <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(\vartheta\)</span> is the equilibrium angle. The parameter to modulate the bending stiffness is <span class="math notranslate nohighlight">\(k_{\text{Bend}}\)</span> .</p>
<ul class="simple" id="coulombic">
<li><p><strong>Coulombic Potential</strong>, <span class="math notranslate nohighlight">\(U_{\text{Coul}}\)</span>: The bare electrostatic interaction between pairs of particles is given by the Coulombic potential</p></li>
</ul>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[U_{\text{Coul}}(r_{ij}) = \frac{1}{4 \pi \epsilon_0 \epsilon_r} \frac{Q_i Q_j}{r_{ij}}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(Q_i\)</span> and <span class="math notranslate nohighlight">\(Q_j\)</span> are the <em>effective</em> charges on each particle after charge reduction due
to counterion condensation. For mesoscopic simulations, <span class="math notranslate nohighlight">\(\epsilon_0 \epsilon_r\)</span> is an effective dielectric constant that includes screening effects due to the medium. Condensation effects can be encapsulated in the Bjerum length</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\lambda_B = \frac {e^2}{4 \pi \epsilon_0 \epsilon_r K_BT}\]</div>
</div>
<p>The Bjerum length is the distance beyond which thermal energy is greater than electrostatic energy. In terms of the Bjerum length, Coulombic interactions can be written</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[U_{\text{Coul}}(r_{ij}) = K_BT \frac{Q_i Q_j}{r_{ij}} \frac{\lambda_B}{r_{ij}}\]</div>
</div>
<p>The Coulombic interactions are long-range scaling like <span class="math notranslate nohighlight">\(∼ r_{ij}^{−1}\)</span>. The long-range contributions are important and for this reason, inclusion of electrostatic effects can be computationally expensive. However, in a solvent electrostatic interactions are screened by the electric double layer and so it is not always necessary to use <span class="math notranslate nohighlight">\(U_{\text{Coul}}\)</span>. Often a much shorter-ranged electrostatic interaction will suffice.</p>
<ul class="simple" id="debye-huckel">
<li><p><strong>Debye-Huckel Potential</strong>, <span class="math notranslate nohighlight">\(U_{\text{DH}}\)</span>: The electrostatic interactions are typically screened. The Debye-Huckel potential is the approximation for the electrostatic potential of a charged sphere. This electric potential is given in terms of the zeta-potential. Since MD monomers do not conveniently have a zeta-potential could be replaced with the effective charge on the <span class="math notranslate nohighlight">\(i_{th}\)</span> monomer (of radius <span class="math notranslate nohighlight">\(r = \frac {\sigma}{2}\)</span> ) ie. <span class="math notranslate nohighlight">\(Q_{\text{eff}} = 4 \pi \epsilon_0 \epsilon_r r \zeta (1+r/\lambda_{\text{D}})\)</span>. The Debye length, <span class="math notranslate nohighlight">\(\lambda_{\text{D}}\)</span>, is the length scale beyond which Coulombic interactions are screened by the distribution of counterions. Then the potential between two spheres of effective charge <span class="math notranslate nohighlight">\({Q_i}^{eff}\)</span> and <span class="math notranslate nohighlight">\({Q_j}^{eff}\)</span> in the Huckel limit of <span class="math notranslate nohighlight">\(\sigma/\lambda_{\text{D}} \ll 1\)</span> becomes</p></li>
</ul>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[U_{\text{Coul}}(r_{ij}) \approx K_BT \frac{Q_i Q_j}{e^2} \frac{\lambda_B}{r_{ij}} \exp(\frac{-r_{ij}}{\lambda_{\text{D}}})\]</div>
</div>
</section>
<section id="wet-system">
<h3>Wet system<a class="headerlink" href="#wet-system" title="Permalink to this heading">#</a></h3>
<section id="isotropic-fluid">
<h4>Isotropic fluid<a class="headerlink" href="#isotropic-fluid" title="Permalink to this heading">#</a></h4>
<p>The dynamical behavior of macromolecules in solution is strongly affected or even dominated by hydrodynamic interactions. Mesoscale hydrodynamic simulations can be used to introduce hydrodynamic interactions to molecular dynamic (MD) simulations and consequently to provide a full characterization of the polymer dynamics <a class="reference internal" href="../References/References.html#holm2008" id="id18"><span>[Holm2008]</span></a>. This coupling to the fluid can be done in two ways. Either the MD beads can be included in the MPCD algorithm or the MPCD particles can be included in the MD calculations.</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/MDinMPCD.png"><img alt="../_images/MDinMPCD.png" src="../_images/MDinMPCD.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/MPCDinMD.png"><img alt="../_images/MPCDinMD.png" src="../_images/MPCDinMD.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#md-in-mpcd-coupling"><span class="std std-ref">MD-in-MPCD Coupling</span></a></p></td>
<td><p><a class="reference internal" href="#mpcd-in-md-coupling"><span class="std std-ref">MPCD-in-MD Coupling</span></a></p></td>
</tr>
</tbody>
</table>
</div>
<section id="md-in-mpcd-coupling">
<span id="id19"></span><h5>MD-in-MPCD Coupling<a class="headerlink" href="#md-in-mpcd-coupling" title="Permalink to this heading">#</a></h5>
<p>The MD monomers can be included in the MPCD collision operations. This scheme is referred to as MD-in-MPCD coupling. In the MD-in-MPCD scheme the MD algorithm integrates the MD monomer trajectories over some number of MD time-steps <span class="math notranslate nohighlight">\(N_{\text{MD}}\)</span>. In a sense, during this period the MD simulation occurs in a vacuum. After this the program exits the MD portion of the algorithm and enters the MPCD side. The MD beads are ported into the MPCD algorithm as point particles and are included in the collision operation. In this way, the MD beads exchange momentum with the fluid. The MPCD particles perform the streaming step (the MD particles do not) before the MD algorithm is reinitiated for another <span class="math notranslate nohighlight">\(N_{\text{MD}}\)</span> MD time-steps.</p>
<p>Values of <span class="math notranslate nohighlight">\(N_{\text{MD}}\)</span> are typically large (on the order of 10 although smaller values have been used in the literature). This separation of time scales ensures that the momentum transferred to the polymer during the collision step is well distributed throughout the chain.</p>
</section>
<section id="mpcd-in-md-coupling">
<span id="id20"></span><h5>MPCD-in-MD Coupling<a class="headerlink" href="#mpcd-in-md-coupling" title="Permalink to this heading">#</a></h5>
<p>The second coupling scheme is more accurately described as a hybrid MPCD/MD approach. In the MPCD-in-MD coupling scheme MPCD solvent particles are included in the MD integrator. In the MD portion of the program the monomers interact with one another (monomer-monomer interactions) and also with the solvent fluid particles (monomer-solvent interactions) but the solvent particles do not interact with each other (no solvent-solvent interactions). In this implementation the MPCD fluid particles are cast as MD beads with the same properties as the monomers but this is not necessary. If desired, the program could be altered such that the MPCD particles would be cast as MD beads with different pair potentials than the monomers. The position and velocity of the all MPCD fluid particles is updated in time by the Verlet algorithm. After <span class="math notranslate nohighlight">\(N_{\text{MD}}\)</span> MD time-steps, the MD integrator is exited and the MPCD portion of the program is performed. MPCD fluid particles are binned into cells and exchange momentum by the MPCD collision operator. Since their positions are updated in the MD portion of the program, they do not stream.</p>
<p>The number of MD steps between an MPCD step can be much smaller that in the MD-in-MPCD scheme.</p>
<p>In both coupling schemes, the MD particles are typically given a mass <span class="math notranslate nohighlight">\(m_{\text{MD}}\)</span> that is larger than the MPCD particles’ mass in order to achieve efficient coupling.</p>
</section>
</section>
<section id="nematic-fluid">
<h4>Nematic fluid<a class="headerlink" href="#nematic-fluid" title="Permalink to this heading">#</a></h4>
<p>When it comes to a nematic background, the orientational order of the fluid also plays an important role. A polymer embedded in an isotropic fluid is just coupled to the flow field through exchanging momentum. But in the case of a nematic fluid the backbone of the polymer can be coupled to the orientation field and the following potential captures this coupling in our model</p>
<ul class="simple" id="coupling-potential">
<li><p><strong>Nematic Coupling Potential</strong>, <span class="math notranslate nohighlight">\(U_{\text{Nem}}\)</span>: This potential aligns each bond of the polymer connecting two consecutive monomers with the local nematic orientation. it works similarly to the <a class="reference internal" href="#bending-potential"><span class="std std-ref">Bond Bending Potential</span></a> with one difference. The angle in this case is the angle beween the bond and the local nematic orientation.</p></li>
</ul>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[U_{\text{Nem}}(\theta _{ijk}) = \frac{k_{\text {Nem}}}{2} (\theta - \vartheta)^2.\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\vartheta\)</span> is the equilibrium angle which in this case is <strong>zero</strong>. The parameter to modulate the alignment strength is <span class="math notranslate nohighlight">\(k_{\text{Nem}}\)</span>.</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 100.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/coupling.png"><img alt="../_images/coupling.png" src="../_images/coupling.png" style="width: 40%;" /></a>
</figure>
</td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#coupling-potential"><span class="std std-ref">Nematic Coupling Potential</span></a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<section id="swimmers">
<span id="chapter12"></span><h2>Swimmers<a class="headerlink" href="#swimmers" title="Permalink to this heading">#</a></h2>
<section id="swimmer">
<span id="id21"></span><h3>Swimmer<a class="headerlink" href="#swimmer" title="Permalink to this heading">#</a></h3>
<p>The hydrodynamical interaction of model shaped-anisotropic bacilliform are simulated using Active Dumbbell Swimmers (ADS) <a class="reference internal" href="../References/References.html#nash2008" id="id22"><span>[Nash2008]</span></a>.</p>
<p>To model the bacilliform body of swimming microbes, an ADS model is proposed composed of two monomers (head and middle) simulating the body, subject to an explicit propulsion force applied in the dimer’s polar axis. The two monomers are connected by a spring.
The surrounding MPCD fluid sees these monomers point-particles, but excluded volume with other swimmers/obstacles (Lennord-Jones potential) can be turned on (default) or off.</p>
<p>The swimmers can induce hydrodynamical forces on the surrounding MPCD fluid, which captures the far-flow field of swimming microbes.</p>
<p>The swimmer has a self-propulsion force, which is applied split evenly between the head and middle monomer to induce self-propulsion. Simultaneously, the head and middle monomer exert an equal drag force on the MPCD particles in the box they inhabit.
To make the sum of forces on the fluid force-free, an opposite force to these two drag forces is applied at a localized tail position. This induces the dipole force, which results in the far-flow field of swimming microbes.</p>
<figure class="align-center" id="id25">
<a class="reference internal image-reference" href="../_images/swimmerschematic1.jpg"><img alt="Logo" src="../_images/swimmerschematic1.jpg" style="width: 650.5px; height: 639.0px;" /></a>
<figcaption>
<p><span class="caption-text">Schematic of Dumbbell swimmer. it contains two monomers (head and middle) connected with a FENE spring. The two monomers exert drag forces on their surrounding fluid, while at a localized tail position away from the middle
an opposite but equal force to these drag forces (the total propulsion force) is also applied on the surrounding fluid. This results in a dipolar far flow field.</span><a class="headerlink" href="#id25" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Besides that, the swimmer monomers are treated as other MD particles.</p>
<p>Swimmers are included in the code by adding the following input script into the input file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;nSwim&quot;</span><span class="p">:</span>            <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>Which sets the number of swimmers to 1.</p>
<section id="extra-parameters">
<h4>Extra parameters<a class="headerlink" href="#extra-parameters" title="Permalink to this heading">#</a></h4>
<p>Swimmers can have the following additional interactions:</p>
<ul class="simple">
<li><p>Swimmers can be made to be run-and tumbling. Through the tumble step, the spring constant and spring length are reduced, so that rotational diffusion is substantially increased. This mimics the tumble part.</p></li>
<li><p>Swimemrs can induce rotlet torques on the surrounding fluid. The rotlet torque is applied om the head of the swimmer and an equal-but-opposite rotlet is applied on the tail position</p></li>
<li><p>Swimmers can experience an external magnetic field through which they allign their orientation due to the magnetic moment, exerting a torque exerted on the swimmer due to the magnetic field and the swimmer alignment mismatch.</p></li>
</ul>
</section>
<section id="input-guide">
<h4>Input Guide<a class="headerlink" href="#input-guide" title="Permalink to this heading">#</a></h4>
<p>The following inputs are necesarry to define a swimmer are their defaults are not set to zero.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`typeSwim`      | int           | 2                  | Swimmer type. Default is a dumbell swimmer with excluded volume interactions
</pre></div>
</div>
<p>This sets type of swimmer. Default is dumbell swimmer with excluded volume (2).
typeSwim=0 for a fixed swimmer. Important, is that the number of swimmers than needs to be 1.
typeSwim=1 gives moving swimmers with no excluded volume interactions.
typeswim=2 gives moving swimmers with excluded volume itneractions.
typeswim=3 gives only one force on the head, in the direction of the head, producing a monopole force.
typeswim=4 Swimmers constrained to be near the y=0 (2D) or z=0 (3D) domain boundary.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`fsSwim`        | double        | 20                 | Magnitude of swimmer propulsion force
</pre></div>
</div>
<p>Swimmer propulsion force. Sets propulsion speed of swimmers</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`dsSwim`        | double        | 1                  | Dipole strength
</pre></div>
</div>
<p>Distance from the middle (in multiples of head-middle length/spring seperation) where tail force is applied. (for a pusher DS&gt;0; for a puller DS&lt;0)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`kSwim`         | double        | 30                 | Spring constant
`roSwim`        | double        | 4                  | Spring seperation
</pre></div>
</div>
<p>Spring constant and seperation. This sets the size of the swimmers. The roSwim should be the same as the monomer size.
Springs are implemented using FENE chains.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`sigSwim`       | double        | 4                  | Diameter approx sigma
</pre></div>
</div>
<p>Size of excluded volume of the head/middle monomer part with other swimmers/MD particles. Only works if excluded volume is activated. This is implemented with a Lennord-Jones potential.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`epsSwim`       | double        | 1                  | Interaction energy
</pre></div>
</div>
<p>Interaction strength of the Lennord-Jones potential used for excluded volume interaction (Lennord-Jones potential).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`qDistSwim`     | int           | 0                  | Initial distribution of swimmer positions
`oDistSwim`     | int           | 0                  | Initial distribution of swimmer orientations
</pre></div>
</div>
<p>These set the initial distribution of swimmer position (0: randomly placed within control volume, 1: Read from file, 2: Centre of controle volume) and swimmer orientation (0: random orientation, 1: x-aligned, 2: y-aligned, 3: z-algined, 4: 45 degrees angle. 5: randomly in XY-plane, 6: randomly in XZ-plane, 7: randomly in YZ-plane,
8: Align all particles in the direction of origin towards positive right hand corner of any cartesian plane, 9: Align all particles in the direction of two oppositely charged defects.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`headMSwim`     | int           | 20                 | Mass of head monomer
`midMSwim`      | int           | 20                 | Mass of middle monomer
</pre></div>
</div>
<p>Mass of swimmer. You want this to be around the density of the fluid.</p>
</section>
<section id="extra-input">
<h4>Extra input<a class="headerlink" href="#extra-input" title="Permalink to this heading">#</a></h4>
<p>The following inputs are expansions on the ADS model. Hence, their default input parameters are set to zero.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`tsSwim`        | double        | 0                  | Magnitude of swimmer torque
</pre></div>
</div>
<p>Magnitude of torque to set the swimmers as rotlet dipole</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`hspIdSwim`     | int           | 1                  | Multiphase fluid particle type of the head monomer in the swimmer
`mspIdSwim`     | int           | 1                  | Multiphase fluid particle type of the middle monomer in the swimmer
</pre></div>
</div>
<p>If multiphase enables, treat swimmer as this type. Currently, make sure both particles are same type.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`runTSwim`      | double        | 0                  | Average run time in units of MPCD timesteps dt (iterations, not MPCD time units)
`tumTSwim`      | double        | 0                  | Average tumble time in units of MPCD timesteps dt (iterations, not MPCD time units)
</pre></div>
</div>
<p>Run and tumble parameters. In order to make swimmers run and tumble, set runTSwim and tumTSwim to non-zero values.
These set the average run and tumble time (in MPCD timesteps) that the particle runs and tumbles respectively.
Run and tumble are stochastic processes, drawn from a stochastic exponential distribution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`springShrinkSwim`      | double        | 0.1                | How much the spring constant is shrunk when tumbling
`sizeShrinkSwim`        | double        | 0.1                | How much do LJ sigma ro shrink when tumbling
</pre></div>
</div>
<p>Tumbling is implemented by reducing the sping size and particle size. For tumbling state, the spring is replaced with a Hookean spring.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`shrTSwim`      | double        | 2                  | Set time to shrink/ extend in units of MPCD timesteps dt (iterations, not MPCD time units)
</pre></div>
</div>
<p>Shrinkage during tumbling is not instantaniously, rather it is done in smaller steps, which is set here.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`magMomSwim`    | double        | 1                  | Magnetic moment/ strength
</pre></div>
</div>
<p>The strength of the magnetic moment on the swimmers (if magnetic field is applied.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`fixDistSwim`   | double        | 0                  | The fixed distance from the wall for `DUMBELL_NEARWALL` mode
</pre></div>
</div>
<p>Used for timeswim=4.</p>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../Outputs/Outputs.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Outputs</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="Usage.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Usage</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Shendruk Lab
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Extra options</a><ul>
<li><a class="reference internal" href="#turn-off-hydrodynamics">Turn-off hydrodynamics</a></li>
<li><a class="reference internal" href="#nematic-mpcd">Nematic MPCD</a><ul>
<li><a class="reference internal" href="#passive-nematics">Passive nematics</a><ul>
<li><a class="reference internal" href="#nematogen-alignment">Nematogen alignment</a></li>
<li><a class="reference internal" href="#two-way-couping-between-flow-and-orientation">Two-way couping between flow and orientation</a></li>
<li><a class="reference internal" href="#isotropic-nematic-transition">Isotropic-nematic transition</a></li>
<li><a class="reference internal" href="#frank-elastic-coefficients">Frank elastic coefficients</a></li>
<li><a class="reference internal" href="#tumbling-shear-alignment">Tumbling &amp; shear alignment</a></li>
<li><a class="reference internal" href="#magnetic-fields">Magnetic fields</a></li>
</ul>
</li>
<li><a class="reference internal" href="#active-nematic-mpcd">Active nematic MPCD</a><ul>
<li><a class="reference internal" href="#variation-on-the-strength-of-activity">Variation on the strength of activity</a><ul>
<li><a class="reference internal" href="#particle-carried-activity">Particle-carried activity</a></li>
<li><a class="reference internal" href="#cell-carried-activity">Cell-carried activity</a></li>
<li><a class="reference internal" href="#modulated-particle-carried-cell-carried-activity">Modulated particle-carried &amp; cell-carried activity</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#inputs-for-nematic-mpcd">Inputs for nematic MPCD</a><ul>
<li><a class="reference internal" href="#main-input-tags">Main input tags</a></li>
<li><a class="reference internal" href="#species-tags">Species tags</a></li>
</ul>
</li>
<li><a class="reference internal" href="#outputs-for-nematic-mpcd">Outputs for nematic MPCD</a></li>
</ul>
</li>
<li><a class="reference internal" href="#viscek-mpcd">Viscek MPCD</a><ul>
<li><a class="reference internal" href="#vicsek-model-of-collective-motion">Vicsek model of collective motion</a></li>
<li><a class="reference internal" href="#vicsek-mpcd">Vicsek MPCD</a></li>
<li><a class="reference internal" href="#vicsek-anderson-mpcd">Vicsek-Anderson MPCD</a></li>
<li><a class="reference internal" href="#vicsek-langevin-mpcd">Vicsek-Langevin MPCD</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multiphase">Multiphase</a><ul>
<li><a class="reference internal" href="#free-energy-of-a-bimodal-fluid">Free energy of a bimodal fluid</a></li>
<li><a class="reference internal" href="#implementation-in-mpcd">Implementation in MPCD</a></li>
</ul>
</li>
<li><a class="reference internal" href="#molecular-dynamics">Molecular dynamics</a><ul>
<li><a class="reference internal" href="#dry-sytsem">Dry sytsem</a></li>
<li><a class="reference internal" href="#wet-system">Wet system</a><ul>
<li><a class="reference internal" href="#isotropic-fluid">Isotropic fluid</a><ul>
<li><a class="reference internal" href="#md-in-mpcd-coupling">MD-in-MPCD Coupling</a></li>
<li><a class="reference internal" href="#mpcd-in-md-coupling">MPCD-in-MD Coupling</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nematic-fluid">Nematic fluid</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#swimmers">Swimmers</a><ul>
<li><a class="reference internal" href="#swimmer">Swimmer</a><ul>
<li><a class="reference internal" href="#extra-parameters">Extra parameters</a></li>
<li><a class="reference internal" href="#input-guide">Input Guide</a></li>
<li><a class="reference internal" href="#extra-input">Extra input</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>