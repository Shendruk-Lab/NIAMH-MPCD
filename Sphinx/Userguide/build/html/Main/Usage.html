<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Extra options" href="ExtraOptions.html" /><link rel="prev" title="Background" href="Background.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>Usage - MPCD documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">MPCD  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">MPCD  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Summary/Summary.html">Executive summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Install/Install.html">Installation &amp; run guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Background.html">Background</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="ExtraOptions.html">Extra options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Outputs/Outputs.html">Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HardCoded/HardCoded.html">Hard-coded options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials/Tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Analysis/Analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DeveloperGuide/DeveloperGuide.html">Developer’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Glossary/Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../References/References.html">Bibliography</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="usage">
<span id="usagechapter"></span><h1>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">#</a></h1>
<section id="particle-properties">
<span id="chapterparticles"></span><h2>Particle properties<a class="headerlink" href="#particle-properties" title="Permalink to this heading">#</a></h2>
<p>MPCD fluid is made of point-like particles and based on the fluid type they have different properties.</p>
<section id="basic-fluid">
<h3>Basic fluid<a class="headerlink" href="#basic-fluid" title="Permalink to this heading">#</a></h3>
<p>Any fluid solved with MPC particles has the following properties and they should be initialized in the input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file.</p>
<section id="position">
<span id="id1"></span><h4>Position<a class="headerlink" href="#position" title="Permalink to this heading">#</a></h4>
<p>Each particle has a position vector, <span class="math notranslate nohighlight">\({\vec x}_i\)</span>, pointing to its position in the control volume.</p>
<p>Available options can be found in the <a class="reference internal" href="#qdist"><span class="std std-ref">position initialization</span></a>.</p>
</section>
<section id="velocity">
<span id="id2"></span><h4>Velocity<a class="headerlink" href="#velocity" title="Permalink to this heading">#</a></h4>
<p>Each particle has a velocity vector, <span class="math notranslate nohighlight">\({\vec v}_i\)</span>.</p>
<p>Available options can be found in the <a class="reference internal" href="#qdist"><span class="std std-ref">velocity initialization</span></a>.</p>
</section>
<section id="mass">
<span id="id3"></span><h4>Mass<a class="headerlink" href="#mass" title="Permalink to this heading">#</a></h4>
<p>Each MPCD particle is assigned a mass specifing its contribution in the velocity collision step, when its momentum is exchanged with other particles belonging to the same cell. To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;mass&quot;:   &lt;value&gt;,</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value = 1 and it should be <strong>always</strong> be 1 for at least one species since it sets the mass scale .</p>
</div>
</section>
<section id="population">
<span id="id4"></span><h4>Population<a class="headerlink" href="#population" title="Permalink to this heading">#</a></h4>
<p>It is the total population of the particles of this species. For more details check <a class="reference internal" href="#pop"><span class="std std-ref">population initialization</span></a> .</p>
</section>
<section id="damping-coefficient">
<span id="damping"></span><h4>Damping coefficient<a class="headerlink" href="#damping-coefficient" title="Permalink to this heading">#</a></h4>
<p>A damping coefficient to control hydrodynamics in other words to go from wet to dry that could be <span class="math notranslate nohighlight">\([0,1]\)</span>. For more details check <a class="reference internal" href="#damp"><span class="std std-ref">Damping initialization</span></a> .</p>
</section>
</section>
<section id="nematic-fluid">
<h3>Nematic fluid<a class="headerlink" href="#nematic-fluid" title="Permalink to this heading">#</a></h3>
<p>The MPC particles can be given nematic orientational symmetry. In that case they have the following properties and they should be initialized in the input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file.</p>
<section id="orientation">
<span id="id5"></span><h4>Orientation<a class="headerlink" href="#orientation" title="Permalink to this heading">#</a></h4>
<p>Each MPCD particle is assigned an orientation <span class="math notranslate nohighlight">\({\vec u}_i\)</span> contributing to tensor order parameter of the cell</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Q_c = {\frac {1}{d-1}} &lt; d {\vec u}_i {\vec u}_i - {\hat 1}&gt;_{N_c}\]</div>
</div>
<p>For a nematic fluid, the largest eigenvalue of this tensor order is the local scalar order parameter, <span class="math notranslate nohighlight">\(S_c\)</span>, of the cell and the local director, <span class="math notranslate nohighlight">\(n_c\)</span>, is parallel to the corresponding eigenvector.</p>
<p>More details can be found in <a class="reference internal" href="#odist"><span class="std std-ref">orientation initialization</span></a>.</p>
</section>
<section id="rotational-friction-coefficient">
<span id="rotationfriction"></span><h4>Rotational friction coefficient<a class="headerlink" href="#rotational-friction-coefficient" title="Permalink to this heading">#</a></h4>
<p>Rotational friction coefficient of this species.</p>
<p>The angular drift velocity <span class="math notranslate nohighlight">\({\omega} = d{\theta}/dt\)</span> in response to an external torque <span class="math notranslate nohighlight">\({\Gamma}\)</span> is s given by <span class="math notranslate nohighlight">\({\omega} = {\Gamma}/f_r\)</span> where <span class="math notranslate nohighlight">\(f_r\)</span> is the rotational drag coefficient.</p>
<p>For more details check <a class="reference internal" href="#rfc"><span class="std std-ref">friction initialization</span></a> .</p>
</section>
<section id="tumbling-parameter">
<span id="tumbling"></span><h4>Tumbling parameter<a class="headerlink" href="#tumbling-parameter" title="Permalink to this heading">#</a></h4>
<p>Coupling between the director and fluid flow is crucial for reproducing nematohydrodynamics since flows can rotate the nematogens just as it can rotate any rodlike, or elongated object. The director profile is not only rotated by the flow, but can also align when subject to a shear. The tumbling parameter specifiec how the nematogens response to a shear, if it is ≥ 1 the director field aligns with the flow - such LCs are known as “flow-aligning” , if it is &lt; 1 the director field rotates in the flow continuously – such LCs are known as “flow-tumbling” <a class="reference internal" href="../References/References.html#shendruk2015" id="id6"><span>[Shendruk2015]</span></a> .</p>
<p>For more details check <a class="reference internal" href="#tumble"><span class="std std-ref">Tumbling initialization</span></a> .</p>
</section>
<section id="shear-susceptibility">
<span id="shearsus"></span><h4>Shear susceptibility<a class="headerlink" href="#shear-susceptibility" title="Permalink to this heading">#</a></h4>
<p>It is the susceptibility of the director to shear. Based on theory it is always 1 but practically a heuristic shear coupling coefficient should exit, that tunes the alignment relaxation time relative to <span class="math notranslate nohighlight">\({\delta} t\)</span>. For the rotation of an individual prolate particle subject to shear flow, CHIHI = 1. When the shear coupling coefficient is set to zero there is no coupling of the director to the velocity field.</p>
<p>For more details check <a class="reference internal" href="#chihi"><span class="std std-ref">Shear initialization</span></a> .</p>
</section>
<section id="magnetic-susceptibility">
<span id="magsus"></span><h4>Magnetic susceptibility<a class="headerlink" href="#magnetic-susceptibility" title="Permalink to this heading">#</a></h4>
<p>It is the susceptibility of the director to a magnetic field by which it is only rotated. The magnitude of the torque applied to the nematogen is proportional to <span class="math notranslate nohighlight">\(chia {\times} ({\vec u} {\cdot} {\vec H})\)</span> in which the <span class="math notranslate nohighlight">\({\vec u}\)</span> is the particle’s orientation and <span class="math notranslate nohighlight">\({\vec H}\)</span> is the magnetic field.</p>
<p>For more details check <a class="reference internal" href="#chia"><span class="std std-ref">Magnetic initialization</span></a> .</p>
</section>
<section id="length">
<span id="id7"></span><h4>Length<a class="headerlink" href="#length" title="Permalink to this heading">#</a></h4>
<p>It is the effective length of the nematogens in order to couple the torque on MPCD particle into force on boundaries.</p>
<p>If <span class="math notranslate nohighlight">\({\vec \Gamma}\)</span> is the torque on MPCD particle, <span class="math notranslate nohighlight">\({\vec \Gamma}  = {\vec r} {\times} {\vec F}\)</span>,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}{\vec r} {\times} {\vec \Gamma} &amp;= {\vec r} {\times} ({\vec r} {\times} {\vec F}) \\
                         &amp;= {\vec r} ({\vec r} {\cdot} {\vec F}) - {\vec F}({\vec r} {\cdot}{\vec r})\end{split}\]</div>
</div>
<p>then the force can be calculated after the rearrangments the  as the following</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[{\vec F} = {\frac {{\vec r}({\vec r} {\cdot} {\vec F}) - {\vec r} {\times} {\vec \Gamma}}{|r^2|}}\]</div>
</div>
<p>Here we assume that the force is perpendicular to the particle, <span class="math notranslate nohighlight">\({\vec r} {\cdot} {\vec F} = 0\)</span>, hence</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[{\vec F} = {\frac {- {\vec r} {\times} {\vec \Gamma}}{|r^2|}}\]</div>
</div>
<p>which means the smaller the length of the particle the stronger the force and the longer the particle the weaker the force.</p>
<p>For more details check <a class="reference internal" href="#len"><span class="std std-ref">Length initialization</span></a> .</p>
</section>
<section id="activity">
<span id="id8"></span><h4>Activity<a class="headerlink" href="#activity" title="Permalink to this heading">#</a></h4>
<p>The force dipole density acting on nematogens in the direction of the local cell director <span class="math notranslate nohighlight">\({\vec n}_c\)</span>.</p>
<p>To make MPCD active, an intrinsically out-of-equilibrium term must be included in the collision operation. To have a MPCD algorithm that conserves momentum (wet) in the active fluids, energy is injected to the fluid constituents in the collision opertaor not momentum. To do so, active stress is introduced to fluid in the form of force dipole density acting on nematogens. This force dipole can be extensile or contractile <a class="reference internal" href="../References/References.html#kozhukhov2022" id="id9"><span>[Kozhukhov2022]</span></a>.</p>
<p>For more details check <a class="reference internal" href="#act"><span class="std std-ref">Activity initialization</span></a> .</p>
</section>
<section id="local-activity-modulators">
<span id="modulators"></span><h4>Local activity modulators<a class="headerlink" href="#local-activity-modulators" title="Permalink to this heading">#</a></h4>
<p>There are two parameters <span class="math notranslate nohighlight">\({\sigma}_p\)</span> and <span class="math notranslate nohighlight">\({\sigma}_w\)</span> used to modulate the local activity as a function of density <a class="reference internal" href="../References/References.html#kozhukhov2023" id="id10"><span>[Kozhukhov2023]</span></a> .</p>
<p><span class="math notranslate nohighlight">\({\sigma}_w\)</span> represents how fast should the modulation fall-off as a function of density. <span class="math notranslate nohighlight">\({\sigma}_p\)</span> is a measure of when modulation should begin.</p>
<p>For more details check <a class="reference internal" href="#sig"><span class="std std-ref">Modulators initialization</span></a> .</p>
</section>
<section id="ratio-of-active-particles">
<span id="actratio"></span><h4>Ratio of active particles<a class="headerlink" href="#ratio-of-active-particles" title="Permalink to this heading">#</a></h4>
<p>Activity could be applied to a proportion of particles in the cell, the <strong>Minimum</strong> of which is this parameter.</p>
<p>For more details check <a class="reference internal" href="#minactratio"><span class="std std-ref">Active ratio initialization</span></a> .</p>
</section>
</section>
<section id="multiphase">
<h3>Multiphase<a class="headerlink" href="#multiphase" title="Permalink to this heading">#</a></h3>
<p>The MPC particles could belong to different species to induce multi-phases.</p>
<section id="interaction-matrix">
<span id="interaction"></span><h4>Interaction matrix<a class="headerlink" href="#interaction-matrix" title="Permalink to this heading">#</a></h4>
<p>Each species has a different interaction with all other species in a multiphase fluids and this matrix specifies how ther interact.</p>
<p>For more details check <a class="reference internal" href="#matrix"><span class="std std-ref">Interaction matrix initialization</span></a> .</p>
</section>
</section>
</section>
<section id="cell-properties">
<span id="chaptercell"></span><h2>Cell properties<a class="headerlink" href="#cell-properties" title="Permalink to this heading">#</a></h2>
<p>Though particle properties are continuous, collision events occur on a descretized lattice of cells.
Each cell <span class="math notranslate nohighlight">\(c\)</span> has a number of properties, which are interpretted as the discretized values of the macroscopic fields.</p>
<section id="number-density">
<span id="numberincell"></span><h3>Number density<a class="headerlink" href="#number-density" title="Permalink to this heading">#</a></h3>
<p>Each cell has an instantaneous number of MPCD particles <span class="math notranslate nohighlight">\(N_c\)</span>.
The average number <span class="math notranslate nohighlight">\(\left\langle N_c \right\rangle\)</span> can be set in your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file for each fluid-species by setting the total number of particles of that species <span class="math notranslate nohighlight">\(N_\text{tot}\)</span> in the input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;species&quot;:</span>
<span class="go">[</span>
<span class="go">    {</span>
<span class="go">        &quot;POP&quot;:         100000</span>
<span class="go">    }</span>
<span class="go">]</span>
</pre></div>
</div>
<p>and dividing by the number of accessible MPCD cells in the control volume.
Alternatively, the number density for each species can be set explicitly  in the input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;species&quot;:</span>
<span class="go">[</span>
<span class="go">    {</span>
<span class="go">        &quot;dens&quot;:         20</span>
<span class="go">    }</span>
<span class="go">]</span>
</pre></div>
</div>
<p>This uses a Monte Carlo integration of the accessible volume to determine the total number of MPCD particles required to set <em>e.g.</em> <span class="math notranslate nohighlight">\(\left\langle N_c \right\rangle = 20\)</span>.</p>
</section>
<section id="galilean-invariance">
<span id="galilean"></span><h3>Galilean invariance<a class="headerlink" href="#galilean-invariance" title="Permalink to this heading">#</a></h3>
<p>By discretizing the space into cells, <strong>Galilean invariance</strong> is broken <a class="reference internal" href="../References/References.html#ihle2003" id="id11"><span>[Ihle2003]</span></a>.
To understand why, consider a simulation of slow moving fluid particles (low temperatures).
If the mean-free path of the molecules (see <a class="reference internal" href="#chaptervisc"><span class="std std-ref">Viscosity</span></a>) is much smaller than the cell size (<span class="math notranslate nohighlight">\(\lambda \ll a\)</span>) then particles will often fail to travel far enough to leave the cell and may repeatedly exchange momentum with the same set of neighbours.
Thus, the implicit assumption of underlying molecular chaos fails and the fixed lattice of cells causes the behaviour in a moving reference frame to be different than a fixed reference frame, since in the moving frame the set of neighbours would be different in each (fig{fig:galInv}).
However, Galilean invariance can be completely reestablished by shifting the cell grid each time step by a random vector.
Galilean invariance is then remedied.
Practically speaking, this is implemented by shifting all the fluid particles by the same vector whose components were chosen at random from the interval <span class="math notranslate nohighlight">\(\left[-a/2,a/2\right]\)</span>.</p>
<figure class="align-center" id="id49">
<a class="reference internal image-reference" href="../_images/galileanInv.png"><img alt="Logo" src="../_images/galileanInv.png" style="width: 462.59999999999997px; height: 453.0px;" /></a>
<figcaption>
<p><span class="caption-text">Galilean invariance is restored by randomly shifting the lattice of MPCD cells.</span><a class="headerlink" href="#id49" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="conservation-of-angular-momentum">
<span id="angmom"></span><h3>Conservation of angular momentum<a class="headerlink" href="#conservation-of-angular-momentum" title="Permalink to this heading">#</a></h3>
<p>Multiple MPCD algorithm do not conserve angular momentum since they do not consider the positions of the fluid particles within the cell during a collision operation.
In many advecting situations angular momentum does not play an essential role and so this fact is inconsequential <a class="reference internal" href="../References/References.html#gotze2007" id="id12"><span>[Götze2007]</span></a> <a class="reference internal" href="../References/References.html#gotze2011" id="id13"><span>[Götze2011]</span></a> <a class="reference internal" href="../References/References.html#babu2012" id="id14"><span>[Babu2012]</span></a>.
To conserving the angular momentum of the cell, the change in angular momentum relative to the centre of mass position during the collision event position is calculated.
This angular momentum is then exactly cancelled out by giving the entire cell an appropriate angular velocity.
For situations in which angular momentum conservation within the solvent plays an important role, appropriate collision operators should be chosen (see <a class="reference internal" href="#chaptercollop"><span class="std std-ref">Collision operators</span></a>).</p>
</section>
<section id="thermostats">
<span id="thermostat"></span><h3>Thermostats<a class="headerlink" href="#thermostats" title="Permalink to this heading">#</a></h3>
<p><strong>TYLER DO THIS TONIGHT</strong></p>
</section>
</section>
<section id="collision-operators">
<span id="chaptercollop"></span><h2>Collision operators<a class="headerlink" href="#collision-operators" title="Permalink to this heading">#</a></h2>
<p>MPCD supports over 20 unique collision operators <span class="math notranslate nohighlight">\(\vec\Xi\)</span>.
These are set in the input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file using either the <code class="docutils literal notranslate"><span class="pre">&quot;rTech&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;collOp&quot;</span></code> keywords as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;collOp&quot;: &lt;int value&gt;</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;int</span> <span class="pre">value&gt;</span></code> is an integer code corresponding to the desired collision operator.</p>
<p>In this section, we describe the various families of collision operators available in MPCD, state their associated keycodes, and describe the parameters they use.</p>
<section id="stochastic-rotation-dynamics">
<span id="srd"></span><h3>Stochastic rotation dynamics<a class="headerlink" href="#stochastic-rotation-dynamics" title="Permalink to this heading">#</a></h3>
<p>The original implementation of MPCD is known as Stochastic Rotation Dynamics (SRD) <a class="reference internal" href="../References/References.html#gompper2009" id="id15"><span>[Gompper2009]</span></a>.
Translating to modern terminology, SRD’s collision operator <span class="math notranslate nohighlight">\(\vec\Xi\)</span> choses a random axis, around which it performs
a rotation through an angle <span class="math notranslate nohighlight">\(\theta\)</span>. This is done by conservating energy, preserving isotropy and the Maxwell Boltzmann velocity distribution in the continuum limit.
This random rotation is what gives its this MPCD variant its name: Stochastic Rotation Dynamics (SRD).</p>
<p>More formally, the SRD the collision operator is</p>
<div class="math-wrapper docutils container" id="eq-srd">
<span id="equation-eq-srd"></span><div class="math notranslate nohighlight" id="eq-srd">
<span id="equation-eq-srd"></span><span class="eqno">(1)<a class="headerlink" href="#eq-srd" title="Permalink to this equation">#</a></span>\[\vec{\Xi}_i^\mathrm{SRD}(t) = \Omega_\theta \cdot \left(
    \vec{v}_i(t) - \vec{v}_{cm}(t)
\right)\]</div>
</div>
<p>in which <span class="math notranslate nohighlight">\(\Omega_\theta\)</span> is a rotation tensor through an angle <span class="math notranslate nohighlight">\(\theta\)</span> about a given axis, and <span class="math notranslate nohighlight">\(\vec{v}_{cm}\)</span> is the center of mass velocity of the particles in the collision cell.</p>
<p>Being a 3D rotation tensor, <span class="math notranslate nohighlight">\(\Omega_\theta\)</span> is defined as</p>
<div class="math-wrapper docutils container" id="eq-srd-rotation-tensor">
<span id="equation-eq-srd-rotation-tensor"></span><div class="math notranslate nohighlight" id="eq-srd-rotation-tensor">
<span id="equation-eq-srd-rotation-tensor"></span><span class="eqno">(2)<a class="headerlink" href="#eq-srd-rotation-tensor" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{align}
    \Omega_\theta &amp;= \begin{pmatrix}
        n_x^2+(1-n_x^2)\cos\theta &amp; n_xn_y\left(1 - \cos\theta\right)-n_z \sin\theta &amp; n_xn_z\left(1-\cos\theta\right)+n_y \sin\theta \\
        n_xn_y \left(1 - \cos\theta\right)+n_z \sin\theta &amp; n_y^2 + \left(1-n_y^2\right)\cos\theta &amp; n_yn_z \left(1 - \cos\theta\right)-n_x \sin\theta \\
        n_xn_z\left(1 - \cos\theta\right)-n_y \sin\theta &amp; n_yn_z\left(1 - \cos\theta\right)+n_x \sin\theta  &amp;n_z^2 + \left(1-n_z^2\right)\cos\theta
    \end{pmatrix},
\end{align}\end{split}\]</div>
</div>
<p>in which the vector <span class="math notranslate nohighlight">\(\hat{n} = [n_x, n_y, n_z]\)</span> defines a unit vector representing the axis of rotation.</p>
<p>A visual description of the algorithmic implementation of the SRD collision operator is shown below.</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 33.3%" />
<col style="width: 33.3%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/SRD1.png"><img alt="../_images/SRD1.png" class="align-center" src="../_images/SRD1.png" style="width: 95%;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/SRD2.png"><img alt="../_images/SRD2.png" class="align-center" src="../_images/SRD2.png" style="width: 95%;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/SRD3.png"><img alt="../_images/SRD3.png" class="align-center" src="../_images/SRD3.png" style="width: 95%;" /></a>
</td>
</tr>
<tr class="row-even"><td><p><strong>(a)</strong> Bin MPCD particles into cells.</p></td>
<td><p><strong>(b)</strong> Calculate the center of mass velocity <span class="math notranslate nohighlight">\(\vec{v}^\mathrm{cm}\)</span> of the cell.</p></td>
<td><p><strong>(c)</strong> For each MPCD particle, calculate the difference from <span class="math notranslate nohighlight">\(\vec{v}^\mathrm{cm}\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/SRD4.png"><img alt="../_images/SRD4.png" class="align-center" src="../_images/SRD4.png" style="width: 95%;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/SRD5.png"><img alt="../_images/SRD5.png" class="align-center" src="../_images/SRD5.png" style="width: 95%;" /></a>
</td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>(d)</strong> For each MPCD particle, generate a random unit vector <span class="math notranslate nohighlight">\(\hat{n}^\mathrm{ran}\)</span>.</p></td>
<td><p><strong>(e)</strong> Rotate each difference about <span class="math notranslate nohighlight">\(\hat{n}^\mathrm{ran}\)</span> by <span class="math notranslate nohighlight">\(\theta\)</span>.</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>The version of SRD in where <span class="math notranslate nohighlight">\(\hat{n}\)</span> is chosen from the unit sphere is implemented with a keycode of <code class="docutils literal notranslate"><span class="pre">0</span></code>.
To use it add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;collOp&quot;: 0</span>
</pre></div>
</div>
<p>However, in order to reproduce in bulk a fluid with the correct hydrodynamic properties, it is sufficient to choose the axis of rotation <span class="math notranslate nohighlight">\(\vec{\hat{n}}\)</span> randomly from the cartesian axes, i.e., <span class="math notranslate nohighlight">\(\vec{\hat{n}} = [1, 0, 0]\)</span>, <span class="math notranslate nohighlight">\([0, 1, 0]\)</span> or <span class="math notranslate nohighlight">\([0, 0, 1]\)</span>, which increases the efficiency of the algorithm.</p>
<p>This version of SRD is implemented with a keycode of <code class="docutils literal notranslate"><span class="pre">1</span></code>.
To use it add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;collOp&quot;: 1</span>
</pre></div>
</div>
<p>It is possible to verify that momentum and energy are conserved before and after collision by explicitly computing them.</p>
</section>
<section id="andersen-thermostatted-mpcd">
<span id="andersen"></span><h3>Andersen-thermostatted MPCD<a class="headerlink" href="#andersen-thermostatted-mpcd" title="Permalink to this heading">#</a></h3>
<p>While SRD is sufficient for some applications, it is not without its drawbacks:</p>
<ul class="simple">
<li><p>The SRD collision operator does not generally conserve angular momentum, as it does not consider the positions of particles within the cell.</p></li>
<li><p>An explicit external thermostat is required to control the system energy when external forces or activity are applied.</p></li>
</ul>
<p>Following other mesoscale simulation techniques, such as DPD, where a thermostat is included intrinsically as part of the simulation technique, thermostats have been incoroporated into MPCD collision operators.
That is, <span class="math notranslate nohighlight">\(\vec\Xi\)</span> acts both as the collision operator and a local thermostat for the cell, such that no velocity rescaling techniques are necessary.</p>
<p>The primary thermostatted collision operator in this simulator is the Andersen thermostatted collision operator <a class="reference internal" href="../References/References.html#gompper2009" id="id16"><span>[Gompper2009]</span></a>, defined as</p>
<div class="math-wrapper docutils container" id="eq-andersenop">
<span id="equation-eq-andersenop"></span><div class="math notranslate nohighlight" id="eq-andersenop">
<span id="equation-eq-andersenop"></span><span class="eqno">(3)<a class="headerlink" href="#eq-andersenop" title="Permalink to this equation">#</a></span>\[\vec{\Xi}_i^\mathrm{A}(t) =
\vec\xi_i -
\frac{\sum_j^{N_C} m_j \vec\xi_j}{\sum_j^{N_C} m_j},\]</div>
</div>
<p>in which each component of <span class="math notranslate nohighlight">\(\vec\xi_i\)</span> is randomly generated from a Gaussian distribution with variance <span class="math notranslate nohighlight">\(\sqrt{k_B T/ m}\)</span>.</p>
<p>The final term in <a class="reference internal" href="#eq-andersenop"><span class="std std-ref">the Andersen collision operator</span></a> is referred to as the residual, and denoted <span class="math notranslate nohighlight">\(\langle \vec\xi_j \rangle_{N_C}\)</span>.
Each fluid particle in a given cell is assigned a new, randomly chosen velocity during each collision.
However, the presence of the residual means that each particle’s velocity is a new randomly assigned value, minus the mass weighted velocity of all the new random values for that cell. This ensures that the center of mass velocity of each cell does not change during collision, ensuring moomentum conservation.</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/Andersen1.png"><img alt="../_images/Andersen1.png" class="align-center" src="../_images/Andersen1.png" style="width: 95%;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/Andersen2.png"><img alt="../_images/Andersen2.png" class="align-center" src="../_images/Andersen2.png" style="width: 95%;" /></a>
</td>
</tr>
<tr class="row-even"><td><p><strong>(a)</strong> Bin MPCD particles into cells.</p></td>
<td><p><strong>(b)</strong> Calculate the center of mass velocity <span class="math notranslate nohighlight">\(\vec{v}^\mathrm{cm}\)</span> of the cell.</p></td>
</tr>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/Andersen3.png"><img alt="../_images/Andersen3.png" class="align-center" src="../_images/Andersen3.png" style="width: 95%;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/Andersen4.png"><img alt="../_images/Andersen4.png" class="align-center" src="../_images/Andersen4.png" style="width: 95%;" /></a>
</td>
</tr>
<tr class="row-even"><td><p><strong>(c)</strong> For each MPCD particle, generate a random velocity that sums to <span class="math notranslate nohighlight">\(\vec{v}^\mathrm{cm}\)</span>.</p></td>
<td><p><strong>(d)</strong> Apply to each MPCD particle.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The Andersen thermostatted collision operator is implemented with a keycode of <code class="docutils literal notranslate"><span class="pre">2</span></code>.
To use it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;collOp&quot;: 2</span>
</pre></div>
</div>
<p>Note that the <a class="reference internal" href="#eq-andersenop"><span class="std std-ref">the basic Andersen collision operator</span></a> conserves mass and translational momentum, but not angular momentum (or energy, as it is thermostatted).
However, it can be extended to do so. The basic Andersen collision operator introduces a small change in angular momentum every timestep, which we denote <span class="math notranslate nohighlight">\(\delta \vec{L}\)</span>.
This can be cancelled out by applying a small counter-rotation to each particle, such that the total angular momentum change is zero.
If the particles in the cell have a given intertia tensor <span class="math notranslate nohighlight">\(I\)</span> about the center of mass, then the required counter-rotation required is <span class="math notranslate nohighlight">\(\vec \omega = I^{-1} \cdot \delta \vec{L}\)</span>.</p>
<p>This correction is done by adding an extra term to the Andersen collision operator that performs this counter-rotation</p>
<div class="math-wrapper docutils container" id="eq-andersenopangular">
<span id="equation-eq-andersenopangular"></span><div class="math notranslate nohighlight" id="eq-andersenopangular">
<span id="equation-eq-andersenopangular"></span><span class="eqno">(4)<a class="headerlink" href="#eq-andersenopangular" title="Permalink to this equation">#</a></span>\[\vec{\Xi}_i^\mathrm{A}(t) =
\vec\xi_i -
\langle \vec\xi_j \rangle_{N_C} +
\left[
    I^{-1} \cdot \left(
        \sum_j^{N_C} m_j \left\lbrace
            \vec{x}'_j \times (\vec{v}_j - \vec\xi_j)
        \right\rbrace
    \right)
\right] \times \vec{x}'_j,\]</div>
</div>
<p>in which vec{x}’_j denotes the position of the particle with respect to the cell’s cooridnate center of mass.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The angular-conserving Andersen thermostatted collision operator above is the default, and preferred, collision operator in this MPCD simulator for traditional fluids.</p>
</div>
<p>The angular-conserving Andersen thermostatted collision operator is implemented with a keycode of <code class="docutils literal notranslate"><span class="pre">3</span></code>.
To use it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;collOp&quot;: 3</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The angular-conserving Andersen thermostatted collision operator is the basis used for the <a class="reference internal" href="ExtraOptions.html#chapter8"><span class="std std-ref">Nematic MPCD</span></a> algorithm.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MPCD can also simulate active nematics using the <a class="reference internal" href="ExtraOptions.html#activenematic"><span class="std std-ref">Active Nematic MPCD</span></a> algorithm.</p>
</div>
</section>
</section>
<section id="initialization">
<span id="chapterinit"></span><h2>Initialization<a class="headerlink" href="#initialization" title="Permalink to this heading">#</a></h2>
<p id="particleinitialization">The fluid is determined in the input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file and all relevant values need to be declared there.</p>
<section id="id17">
<h3>Basic fluid<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h3>
<p>Any fluid solved with MPC particles needs to have the following properties initialized.</p>
<section id="qdist">
<span id="id18"></span><h4>Position<a class="headerlink" href="#qdist" title="Permalink to this heading">#</a></h4>
<p>qdist specifies how the position of this species’ particles are initialised. The available options are to :</p>
<ul class="simple">
<li><p>place the particles randomly and freely within the control volume.</p></li>
</ul>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;qdist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<ul class="simple">
<li><p>read the particles’ positions from a file.</p></li>
</ul>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;qdist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value is 0.</p>
</div>
</section>
<section id="vdist">
<span id="id19"></span><h4>Velocity<a class="headerlink" href="#vdist" title="Permalink to this heading">#</a></h4>
<p>vdist specifies how the velocity of this species’ particles is initialised. The available options are to :</p>
<ul>
<li><p>draw the velocity from an uniformly random distribution. To get uniform must consider from zero to <span class="math notranslate nohighlight">\((2 {\times} K_{B}T/MASS)^{1/2}\)</span> for each component. To get the negative velocity we make the interval twice as big and subtract off the original max.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;vdist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>read the particles’ velocities from a file. (HOW DOES THE USER GIVE THIS FILE?)</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;vdist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>give all the particles the same initial speed but in different directions.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;vdist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>give all the particles the same initial speed along each axis in either direction.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;vdist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">3</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>draw the particles’ velocity from a gaussian distribution scaled by <span class="math notranslate nohighlight">\((K_{B}T/MASS)^{1/2}\)</span>
for each component of the velocity.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;vdist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">4</span><span class="p">,</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value is 0.</p>
</div>
</section>
<section id="massinitialization">
<span id="id20"></span><h4>Mass<a class="headerlink" href="#massinitialization" title="Permalink to this heading">#</a></h4>
<p>Mass of this species’ particles. To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;mass&quot;:  &lt;value&gt;,</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value = 1 and it should be <strong>always</strong> be 1 for at least one species since it sets the mass scale .</p>
</div>
</section>
<section id="pop">
<span id="id21"></span><h4>Population<a class="headerlink" href="#pop" title="Permalink to this heading">#</a></h4>
<p>It is the total population of the particles of this species. To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;pop&quot;:    &lt;value&gt;,</span>
</pre></div>
</div>
<p>It is equal to control volume <span class="math notranslate nohighlight">\({\times} 20\)</span> ( <span class="math notranslate nohighlight">\(20 =\)</span> the average number of particles in each cell).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value is 18000.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>“dens” can override it for simple geometries that do not have cut cells, so each cell has <span class="math notranslate nohighlight">\(20\)</span> particles.</p>
<p>To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;dens&quot;</span><span class="p">:</span><span class="w">    </span><span class="mi">20</span><span class="p">,</span>
</pre></div>
</div>
</div>
</section>
<section id="damp">
<span id="id22"></span><h4>Damping coefficient<a class="headerlink" href="#damp" title="Permalink to this heading">#</a></h4>
<p>A friction coefficient to control hydrodynamics. in other words to go from wet to dry that could be <span class="math notranslate nohighlight">\([0,1]\)</span>. To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;damp&quot;: &lt;value&gt;,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value is 0.</p>
</div>
</section>
</section>
<section id="id23">
<h3>Nematic fluid<a class="headerlink" href="#id23" title="Permalink to this heading">#</a></h3>
<p>The MPC particles can be given nematic orientational symmetry, by setting</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;lc&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>In that case, the following properties need to be initialized.</p>
<section id="odist">
<span id="id24"></span><h4>Orientation<a class="headerlink" href="#odist" title="Permalink to this heading">#</a></h4>
<p>odist specifies how the direction of this species’ particles is initialised. The available options are to :</p>
<ul>
<li><p>get a unit vector within a sphere distribution.</p>
<ul class="simple">
<li><p>3D: Sample the z component on <span class="math notranslate nohighlight">\([{\cos(\pi)}, 1]\)</span> and then sample the azimuthal angle, <span class="math notranslate nohighlight">\({\phi}\)</span> on <span class="math notranslate nohighlight">\([0, 2{\pi})\)</span>.</p></li>
<li><p>2D: Simply sample the azimuthal angle homogeneously.</p></li>
<li><p>1D: Checks if <span class="math notranslate nohighlight">\({\cos(\phi)}\)</span> would be parallel or anti-parallel, returning +1.0 or -1.0.</p></li>
</ul>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;odist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>align all particles along X axis.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;odist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>align all particles along Y axis.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;odist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>align all particles along Z axis.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;odist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">3</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>align all particles along 45 degree angle.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;odist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">4</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>align all particles randomly within XY axis.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;odist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">5</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>align all particles randomly within XZ axis.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;odist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">6</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>align all particles randomly within YZ axis.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;odist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">7</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>align all particles in the direction of origin towards positive right hand corner of any cartesian plane.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;odist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">8</span><span class="p">,</span>
</pre></div>
</div>
</li>
<li><p>align all particles in the direction of two oppositely charged defects.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;odist&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">9</span><span class="p">,</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value is 2.</p>
</div>
</section>
<section id="rfc">
<span id="id25"></span><h4>Rotational friction coefficient<a class="headerlink" href="#rfc" title="Permalink to this heading">#</a></h4>
<p>Rotational friction coefficient of this species. To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;rfc&quot;:    &lt;value&gt;,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value is 0.01.</p>
</div>
</section>
<section id="tumble">
<span id="id26"></span><h4>Tumbling parameter<a class="headerlink" href="#tumble" title="Permalink to this heading">#</a></h4>
<p>The tumbling parameter specifiec how the nematogens response to a shear in the flow, if it is ≥ 1 the director field aligns with the flow - such LCs are known as “flow-aligning” , if it is &lt; 1 the director field rotates in the flow continuously – such LCs are known as “flow-tumbling”. To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;tumble&quot;:    &lt;value&gt;,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value is 2.</p>
</div>
</section>
<section id="chihi">
<span id="id27"></span><h4>Shear susceptibility<a class="headerlink" href="#chihi" title="Permalink to this heading">#</a></h4>
<p>A heuristic shear coupling coefficient that tunes the alignment relaxation time relative to <span class="math notranslate nohighlight">\({\delta} t\)</span>.</p>
<p>To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;shearSusc&quot;:    &lt;value&gt;,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value is 0.5.</p>
</div>
</section>
<section id="chia">
<span id="id28"></span><h4>Magnetic susceptibility<a class="headerlink" href="#chia" title="Permalink to this heading">#</a></h4>
<p>It is the susceptibility of the director to a magnetic field. To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;magSusc&quot;:    &lt;value&gt;,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value is 0.001.</p>
</div>
</section>
<section id="len">
<span id="id29"></span><h4>Length<a class="headerlink" href="#len" title="Permalink to this heading">#</a></h4>
<p>It is the effective length of the nematogens in order to couple the torque on MPCD particle into force on boundaries. The smaller the length of the particle the stronger the force and the longer the particle the weaker the force. To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;len&quot;:    &lt;value&gt;,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value, 0.007, is set.</p>
</div>
</section>
<section id="act">
<span id="id30"></span><h4>Activity<a class="headerlink" href="#act" title="Permalink to this heading">#</a></h4>
<p>It sets the type and the magnitude of the force dipole on each MPCD particle. Positive values corresponds to extensile force dipoles and negative values to contractile ones. Each collision operator has a defined region for this activity parameter in which <strong>active</strong> turbulence exists.</p>
<p>To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;act&quot;:    &lt;value&gt;,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The default value is 0.05.</p></li>
<li><p>The turbulence regime for extensile and contractile are not the same.</p></li>
</ul>
</div>
</section>
<section id="sig">
<span id="id31"></span><h4>Local activity modulators<a class="headerlink" href="#sig" title="Permalink to this heading">#</a></h4>
<p><span class="math notranslate nohighlight">\({\sigma}_w\)</span> represents how fast should the modulation fall-off as a function of density , should be &gt; 0, ideally around 0.4.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;sigWidth&quot;:    &lt;value&gt;,</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\({\sigma}_p\)</span> is a measure of when modulation should begin, should be in a range 0 to 2, ideally around 0.5.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;sigPos&quot;:    &lt;value&gt;,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The default values are 1.0 for both parameters.</p></li>
</ul>
</div>
</section>
<section id="minactratio">
<span id="id32"></span><h4>Ratio of active particles<a class="headerlink" href="#minactratio" title="Permalink to this heading">#</a></h4>
<p>Activity could be applied to a proportion of particles in the cell, the <strong>Minimum</strong> of which is this parameter.  To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;minActRatio&quot;:    &lt;value&gt;,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value is 0.</p>
</div>
</section>
</section>
<section id="id33">
<h3>Multiphase<a class="headerlink" href="#id33" title="Permalink to this heading">#</a></h3>
<p>The MPC particles can also be of different species to induce multi-phases. In order to introduce different species with different properties to the system, <code class="docutils literal notranslate"><span class="pre">&quot;species&quot;</span></code> array in the <code class="docutils literal notranslate"><span class="pre">.json</span></code> file gets several elements. The number of elements is equal to the number of species. for instance if there are two species with different activities the following changes should be applied</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;species&quot;:</span>
<span class="go">[</span>
<span class="go">  {</span>
<span class="go">    ...</span>
<span class="go">    ...</span>
<span class="go">    ...</span>
<span class="go">    &quot;act&quot;:          0.08</span>
<span class="go">  },</span>
<span class="go">  {</span>
<span class="go">    ...</span>
<span class="go">    ...</span>
<span class="go">    ...</span>
<span class="go">    &quot;act&quot;:          0.03</span>
<span class="go">  }</span>
<span class="go">],</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Other properties mentioned earlier in this section should be initialized for each species based on the required properties, otherwise the default values would be given.</p></li>
<li><p>In our code up to ten different species are supported.</p></li>
</ul>
<div class="highlight-console notranslate" id="maxspeci"><div class="highlight"><pre><span></span><span class="gp"># </span>define<span class="w"> </span>MAXSPECI<span class="w"> </span><span class="m">10</span>
</pre></div>
</div>
</div>
<section id="matrix">
<span id="id34"></span><h4>Interaction matrix<a class="headerlink" href="#matrix" title="Permalink to this heading">#</a></h4>
<p>Each species has a different interaction with all other species in a multiphase fluids and this matrix specifies how ther interact. To set it, add the following to your input <code class="docutils literal notranslate"><span class="pre">.json</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;interMatr&quot;:    &lt;value&gt;,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It <strong>Must</strong> be of the same length as the number of species. Default will autopopulate with 0s, [0,…].</p>
</div>
</section>
</section>
</section>
<section id="boundary-conditions">
<span id="chapterbc"></span><h2>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this heading">#</a></h2>
<p id="subsection-boundarysurfaces">All simulations require boundary conditions.
Creating surfaces to define the fluid control volume, establishes the fluid domain over which the hydrodynamic interactions take place.
For this algorithm, boundary conditions are applied directly to fluid particles that violate <a class="reference internal" href="#eq-bccondition"><span class="std std-ref">surface equations</span></a>.</p>
<p>The following steps are required:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#subsection-boundarysurfaces"><span class="std std-ref">Surface definitions</span></a></p></li>
<li><p><a class="reference internal" href="#subsection-boundaryrules"><span class="std std-ref">Boundary condition rules</span></a></p></li>
</ul>
<p>These two processes can model a wide variety of fluid settings, including open systems (through periodic boundary conditions), channels and confinement in complex environments.</p>
<section id="surfaces">
<h3>Surfaces<a class="headerlink" href="#surfaces" title="Permalink to this heading">#</a></h3>
<p>All boundaries are defined by an implicit surface equation <span class="math notranslate nohighlight">\(S(\vec{x})=0\)</span>,
where <span class="math notranslate nohighlight">\(\vec{x}= (x,y,z)\)</span> are points on the surface.
There are multiple forms of implemented surfaces, which can be combined (setting non-zero surface parameters) or removed (setting surface parameters to zero).</p>
<section id="standard-surfaces">
<h4>Standard surfaces<a class="headerlink" href="#standard-surfaces" title="Permalink to this heading">#</a></h4>
<p>Standard surfaces have the form,</p>
<div class="math-wrapper docutils container" id="eq-surface">
<span id="equation-eq-surface"></span><div class="math notranslate nohighlight" id="eq-surface">
<span id="equation-eq-surface"></span><span class="eqno">(5)<a class="headerlink" href="#eq-surface" title="Permalink to this equation">#</a></span>\[S^S(\vec{x})=[A_x\left(x-Q_x\right)]^{p_x} + [A_y\left(y-Q_y\right)]^{p_y} + [A_z\left(z-Q_z\right)]^{p_z} - R^{p_R} = 0\]</div>
</div>
<p>where the surface parameters represent the surface position’s <span class="math notranslate nohighlight">\(\vec{Q}=(Q_x,Q_y,Q_z)\)</span>,
surface coefficient’s <span class="math notranslate nohighlight">\(\vec{A}=(A_x,A_y,A_z)\)</span>, surface power’s <span class="math notranslate nohighlight">\((p_x,p_y,p_z,p_R)\)</span> and radius <span class="math notranslate nohighlight">\(R\)</span>.
Writing surfaces in this way is versatile and enables <a class="reference internal" href="#eq-surfaceplane1"><span class="std std-ref">planes</span></a>, <a class="reference internal" href="#eq-surfacesphere"><span class="std std-ref">spheres</span></a>, <a class="reference internal" href="#eq-surfaceellipsoid"><span class="std std-ref">ellipsoids</span></a>, <a class="reference internal" href="#eq-surfacecylinder"><span class="std std-ref">cylinders</span></a>, <a class="reference internal" href="#eq-surfacesquircle"><span class="std std-ref">squircles</span></a> and <a class="reference internal" href="#eq-surfacesuperellipsoid"><span class="std std-ref">superellipsoids</span></a> to be created</p>
<p>Boundary properties can be created inside the input, using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Boundary properties&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="n">Qx</span><span class="p">,</span> <span class="n">Qy</span><span class="p">,</span> <span class="n">Qz</span><span class="p">],</span>
    <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="n">Ax</span><span class="p">,</span> <span class="n">Ay</span><span class="p">,</span> <span class="n">Az</span><span class="p">],</span>
    <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">pz</span><span class="p">,</span> <span class="n">pR</span><span class="p">],</span>
    <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="n">R</span>
  <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>2D surfaces can be defined using the same surface parameters as 3D.
These are slices of 3D surfaces in the <span class="math notranslate nohighlight">\(xy\)</span> plane, where <span class="math notranslate nohighlight">\(z=0\)</span>.</p>
</div>
<ol class="arabic simple">
<li><p><strong>Plane</strong></p></li>
</ol>
<blockquote>
<div><p>To construct a plane, set <span class="math notranslate nohighlight">\(p_x=p_y=p_z=p_R=1\)</span>,
<span class="math notranslate nohighlight">\(Q_x=Q_y=Q_z=0\)</span> and <span class="math notranslate nohighlight">\(R=d\)</span> to give the surface equation</p>
<div class="math-wrapper docutils container" id="eq-surfaceplane1">
<span id="equation-eq-surfaceplane1"></span><div class="math notranslate nohighlight" id="eq-surfaceplane1">
<span id="equation-eq-surfaceplane1"></span><span class="eqno">(6)<a class="headerlink" href="#eq-surfaceplane1" title="Permalink to this equation">#</a></span>\[S(\vec{x})= A_x x + A_y y + A_z z  - d = 0\]</div>
</div>
<p>Describing a plane with normal vector <span class="math notranslate nohighlight">\(\hat{n} = (A_x,A_y,A_z)\)</span> and located at a distance <span class="math notranslate nohighlight">\(d\)</span> from the origin.
Alternatively, can write the surface equation with <span class="math notranslate nohighlight">\(R=0\)</span> so that</p>
<div class="math-wrapper docutils container" id="eq-surfaceplane2">
<span id="equation-eq-surfaceplane2"></span><div class="math notranslate nohighlight" id="eq-surfaceplane2">
<span id="equation-eq-surfaceplane2"></span><span class="eqno">(7)<a class="headerlink" href="#eq-surfaceplane2" title="Permalink to this equation">#</a></span>\[S(\vec{x})= A_x (x-Q_x) + A_y(y-Q_y) + A_z (z-Q_z) = 0\]</div>
</div>
<p>with the perpendicular distance from the origin as <span class="math notranslate nohighlight">\(A \cdot Q = d\)</span>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/Plane.png"><img alt="Logo" src="../_images/Plane.png" style="width: 216.0px; height: 216.0px;" /></a>
</figure>
<p>An example input for a plane with the normal <span class="math notranslate nohighlight">\(\hat{n}=(0,1,0)\)</span>, located at a distance <span class="math notranslate nohighlight">\(L_y\)</span> from the origin,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Plane BC&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
  <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
  <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
  <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="n">Ly</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p><strong>Sphere</strong></p></li>
</ol>
<blockquote>
<div><p>To construct a sphere, <span class="math notranslate nohighlight">\(p_x=p_y=p_z=p_R=2\)</span>,
<span class="math notranslate nohighlight">\(A_x=A_y=A_z=1\)</span> and <span class="math notranslate nohighlight">\(R\neq0\)</span> to give the surface equation</p>
<div class="math-wrapper docutils container" id="eq-surfacesphere">
<span id="equation-eq-surfacesphere"></span><div class="math notranslate nohighlight" id="eq-surfacesphere">
<span id="equation-eq-surfacesphere"></span><span class="eqno">(8)<a class="headerlink" href="#eq-surfacesphere" title="Permalink to this equation">#</a></span>\[S(\vec{x})= \left(x-Q_x\right)^2 + \left(y-Q_y\right)^2 + \left(z-Q_z\right)^2  - R^2 = 0\]</div>
</div>
<p>Describing a sphere centred at <span class="math notranslate nohighlight">\(\vec{Q} = (Q_x,Q_y,Q_z)\)</span> with a radius <span class="math notranslate nohighlight">\(R\)</span>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/Sphere.png"><img alt="Logo" src="../_images/Sphere.png" style="width: 216.0px; height: 216.0px;" /></a>
</figure>
<p>An example input for a sphere with the centre coordinate <span class="math notranslate nohighlight">\(\vec{Q}=(Q_x,Q_y,Q_z)\)</span> can be constructed with the input parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Sphere BC&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="n">Qx</span><span class="p">,</span> <span class="n">Qy</span><span class="p">,</span> <span class="n">Qz</span><span class="p">],</span>
  <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
  <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
  <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="n">radius</span> <span class="n">of</span> <span class="n">sphere</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p><strong>Ellipsoid</strong></p></li>
</ol>
<blockquote>
<div><p>To construct an ellipsoid, <span class="math notranslate nohighlight">\(p_x=p_y=p_z=p_R=2\)</span> and
<span class="math notranslate nohighlight">\(A_x=\frac{1}{a}, A_z=\frac{1}{b}, A_z=\frac{1}{c}\)</span> and <span class="math notranslate nohighlight">\(R=1\)</span> to give the surface equation</p>
<div class="math-wrapper docutils container" id="eq-surfaceellipsoid">
<span id="equation-eq-surfaceellipsoid"></span><div class="math notranslate nohighlight" id="eq-surfaceellipsoid">
<span id="equation-eq-surfaceellipsoid"></span><span class="eqno">(9)<a class="headerlink" href="#eq-surfaceellipsoid" title="Permalink to this equation">#</a></span>\[S(\vec{x})= \left(\frac{x-Q_x}{a}\right)^2 + \left(\frac{y-Q_y}{b}\right)^2 + \left(\frac{z-Q_z}{c}\right)^2  - 1 = 0\]</div>
</div>
<p>Describing an ellipsoid centred at <span class="math notranslate nohighlight">\(\vec{Q} = (Q_x,Q_y,Q_z)\)</span> with principle semi-axes <span class="math notranslate nohighlight">\(a, b, c\)</span>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/Ellipsoid.png"><img alt="Logo" src="../_images/Ellipsoid.png" style="width: 216.0px; height: 216.0px;" /></a>
</figure>
<p>An example ellipsoid input,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Ellipsoid BC&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="n">Qx</span><span class="p">,</span> <span class="n">Qy</span><span class="p">,</span> <span class="n">Qz</span><span class="p">],</span>
  <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">b</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">c</span><span class="p">],</span>
  <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
  <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p><strong>Cylinder</strong></p></li>
</ol>
<blockquote>
<div><p>A cylinder aligned along <span class="math notranslate nohighlight">\(\hat{e}_z\)</span> can be constructed using <span class="math notranslate nohighlight">\(p_x=p_y=p_R=2\)</span>, <span class="math notranslate nohighlight">\(A_x=A_y=1, A_z=0\)</span> and <span class="math notranslate nohighlight">\(R\neq 0\)</span>.</p>
<div class="math-wrapper docutils container" id="eq-surfacecylinder">
<span id="equation-eq-surfacecylinder"></span><div class="math notranslate nohighlight" id="eq-surfacecylinder">
<span id="equation-eq-surfacecylinder"></span><span class="eqno">(10)<a class="headerlink" href="#eq-surfacecylinder" title="Permalink to this equation">#</a></span>\[S(\vec{x})= \left(x-Q_x\right)^2 + \left(y-Q_y\right)^2 - R^2 = 0\]</div>
</div>
<p>Describing an cylinder centred at <span class="math notranslate nohighlight">\(\vec{Q} = (Q_x,Q_y)\)</span> on the <span class="math notranslate nohighlight">\(xy\)</span> plane with radius <span class="math notranslate nohighlight">\(R\)</span>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/Cylinder.png"><img alt="Logo" src="../_images/Cylinder.png" style="width: 223.2px; height: 209.4px;" /></a>
</figure>
<p>An example cylinder input,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Cylinder BC&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="n">Qx</span><span class="p">,</span> <span class="n">Qy</span><span class="p">,</span> <span class="n">Qz</span><span class="p">],</span>
  <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
  <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
  <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="n">radius</span> <span class="n">of</span> <span class="n">cylinder</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" id="squircle" start="5">
<li><p><strong>Squircle</strong></p></li>
</ol>
<blockquote>
<div><p>A squircle is a surface that is intermediate between a sphere and a cube.
The construction of a squircle has <span class="math notranslate nohighlight">\(p_x=p_y=p_z=p_R=4\)</span> and <span class="math notranslate nohighlight">\(A_x=A_y=A_z=1\)</span></p>
<div class="math-wrapper docutils container" id="eq-surfacesquircle">
<span id="equation-eq-surfacesquircle"></span><div class="math notranslate nohighlight" id="eq-surfacesquircle">
<span id="equation-eq-surfacesquircle"></span><span class="eqno">(11)<a class="headerlink" href="#eq-surfacesquircle" title="Permalink to this equation">#</a></span>\[S(\vec{x})= \left(x-Q_x\right)^4 + \left(y-Q_y\right)^4 + \left(z-Q_z\right)^4  - R^4 = 0\]</div>
</div>
<p>Describing a squircle centred at <span class="math notranslate nohighlight">\(\vec{Q} = (Q_x,Q_y,Q_z)\)</span> with a minor radius <span class="math notranslate nohighlight">\(R\)</span>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/Squircle.png"><img alt="Logo" src="../_images/Squircle.png" style="width: 216.0px; height: 216.0px;" /></a>
</figure>
<p>An example squircle input,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Squircle BC&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="n">Qx</span><span class="p">,</span> <span class="n">Qy</span><span class="p">,</span> <span class="n">Qz</span><span class="p">],</span>
  <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
  <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
  <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="n">Minor</span> <span class="n">radius</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p><strong>Superellipsoid</strong></p></li>
</ol>
<blockquote>
<div><p>A superellipse is a closed surface that resembles an ellipse, featuring a semi-major axis and semi-minor axis, but with different shape.
The construction of a superellipse has <span class="math notranslate nohighlight">\(p_x=p_y=p_z=p_R=n\)</span> and
<span class="math notranslate nohighlight">\(A_x=\frac{1}{a}, A_z=\frac{1}{b}, A_z=\frac{1}{c}\)</span> and <span class="math notranslate nohighlight">\(R=1\)</span>.
A super ellipsoid provide an increasingly closer approximation to a cuboid for large positive <span class="math notranslate nohighlight">\(n\)</span>.</p>
<div class="math-wrapper docutils container" id="eq-surfacesuperellipsoid">
<span id="equation-eq-surfacesuperellipsoid"></span><div class="math notranslate nohighlight" id="eq-surfacesuperellipsoid">
<span id="equation-eq-surfacesuperellipsoid"></span><span class="eqno">(12)<a class="headerlink" href="#eq-surfacesuperellipsoid" title="Permalink to this equation">#</a></span>\[S(\vec{x})= \left(\frac{x-Q_x}{a}\right)^n + \left(\frac{y-Q_y}{b}\right)^n + \left(\frac{z-Q_z}{c}\right)^n  - 1 = 0\]</div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/SuperEllipsoid.png"><img alt="Logo" src="../_images/SuperEllipsoid.png" style="width: 216.0px; height: 216.0px;" /></a>
</figure>
<p>An example superellipsoid input,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Superellipsoid BC&quot;</span><span class="p">,</span>
  <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="n">Qx</span><span class="p">,</span> <span class="n">Qy</span><span class="p">,</span> <span class="n">Qz</span><span class="p">],</span>
  <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">b</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">c</span><span class="p">],</span>
  <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">],</span>
  <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="additional-surface-forms">
<h4>Additional surface forms<a class="headerlink" href="#additional-surface-forms" title="Permalink to this heading">#</a></h4>
<p>MPCD boundaries are versatile and many possible surface geometries can be implemented.</p>
<section id="wavy-surfaces">
<h5>Wavy surfaces<a class="headerlink" href="#wavy-surfaces" title="Permalink to this heading">#</a></h5>
<p>Modulated planes, spheres and cylinders can be created with surface equations <span class="math notranslate nohighlight">\(S(\vec{x})=S^S(\vec{x})+S^W(\vec{x})\)</span>, combining standard surfaces <span class="math notranslate nohighlight">\(S^{S}(\vec{x})\)</span> with a wavy component <span class="math notranslate nohighlight">\(S^{W}(\vec{x})\)</span> <a class="reference internal" href="../References/References.html#wamsler2023" id="id35"><span>[Wamsler2023]</span></a>.
For a surface indexed by <span class="math notranslate nohighlight">\(b\)</span>, wavy surfaces are implemented with the form</p>
<div class="math-wrapper docutils container" id="eq-surfacewavy">
<span id="equation-eq-surfacewavy"></span><div class="math notranslate nohighlight" id="eq-surfacewavy">
<span id="equation-eq-surfacewavy"></span><span class="eqno">(13)<a class="headerlink" href="#eq-surfacewavy" title="Permalink to this equation">#</a></span>\[S^{W}_b(\vec{x})= B_{b,0}\cos(B_{b,1}S_{b,1}(\vec{x}))\cos(B_{b,2}S_{b,2}(\vec{x}))\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(B_{b,0}\)</span> is a modulation amplitude, <span class="math notranslate nohighlight">\(B_{b,1}\)</span> and <span class="math notranslate nohighlight">\(B_{b,2}\)</span>
are modulation frequencies, and <span class="math notranslate nohighlight">\(S_{b,1}\)</span> and <span class="math notranslate nohighlight">\(S_{b,2}\)</span> define the orientation of the modulation.
By setting one of <span class="math notranslate nohighlight">\(B_{b,1}\)</span> and <span class="math notranslate nohighlight">\(B_{b,2}\)</span> to zero, surfaces can be given waves in one axis (corrugated),
while when both frequencies are non-zero, surfaces take on double modulated surfaces.</p>
<p>The wavy surfaces can be used in the input scripts as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;comment&quot;</span><span class="p">:</span>              <span class="s2">&quot;Wavy BC&quot;</span><span class="p">,</span>
  <span class="n">Wavy</span>  <span class="p">[</span><span class="n">B0</span><span class="p">,</span><span class="n">B1</span><span class="p">,</span><span class="n">B2</span><span class="p">]</span>        <span class="s2">&quot;B0 = amplitube, B1,B2 = wave frequencies&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Depending on the combined <a class="reference internal" href="#eq-surface"><span class="std std-ref">standard surface</span></a> <span class="math notranslate nohighlight">\(S^{S}(\vec{x})\)</span>,
the orientation equations <span class="math notranslate nohighlight">\(S_{b,1}(\vec{x})\)</span> and <span class="math notranslate nohighlight">\(S_{b,2}(\vec{x})\)</span> are given different forms, as outlined below.</p>
<ol class="arabic simple">
<li><p><strong>Wavy planes</strong></p></li>
</ol>
<blockquote>
<div><p>For wavy planes, the orientation functions take the form</p>
<div class="math-wrapper docutils container" id="eq-planewavys1">
<span id="equation-eq-planewavys1"></span><div class="math notranslate nohighlight" id="eq-planewavys1">
<span id="equation-eq-planewavys1"></span><span class="eqno">(14)<a class="headerlink" href="#eq-planewavys1" title="Permalink to this equation">#</a></span>\[\begin{split}S_{b,1}(\vec{x}) &amp;= \frac{A_y x - A_x y}{\sqrt{A_x^2+ A_y^2}} \\
S_{b,2}(\vec{x}) &amp;= \frac{A_x A_z x + A_y A_z y - (A_x^2 + A_y^2) z}{\sqrt{A_x^4 + A_y^4 + 2 A_x^2 A_z^2 + 2 A_y^2 A_z^2 + 2 A_x^2 A_y^2}}\end{split}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(S_{b,1}\)</span> generates longitudinal waves (number set by the frequency <span class="math notranslate nohighlight">\(B_{b,1}\)</span>) and <span class="math notranslate nohighlight">\(S_{b,2}(\vec{x})\)</span> creates latitudinal waves (number set by the frequency <span class="math notranslate nohighlight">\(B_{b,2}\neq0\)</span>).</p>
<p>The accompanying standard surface <span class="math notranslate nohighlight">\(S^S(\vec{x})\)</span>, defines the <a class="reference internal" href="#eq-surfaceplane1"><span class="std std-ref">plane</span></a>.</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/WavyPlane.png"><img alt="../_images/WavyPlane.png" class="align-center" src="../_images/WavyPlane.png" style="width: 95%;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/EggPlane.png"><img alt="../_images/EggPlane.png" class="align-center" src="../_images/EggPlane.png" style="width: 95%;" /></a>
</td>
</tr>
<tr class="row-even"><td><p>Corrugated plane for either <span class="math notranslate nohighlight">\(B_{b,1}\neq 0\)</span> or <span class="math notranslate nohighlight">\(B_{b,2}\neq 0\)</span>.</p>
<p><em>This example has</em> <span class="math notranslate nohighlight">\(B_{b,0} = 0.2\)</span>, <span class="math notranslate nohighlight">\(B_{b,1} = 10\)</span>, <span class="math notranslate nohighlight">\(B_{b,2} = 0\)</span>
<em>and</em> <span class="math notranslate nohighlight">\(\vec{A}=(0,1,0)\)</span>, <em>to define a plane with normal in</em> <span class="math notranslate nohighlight">\(\hat{y}\)</span> <em>that has transverse modulation in</em> <span class="math notranslate nohighlight">\(\hat{x}\)</span> <em>direction with amplitude</em> <span class="math notranslate nohighlight">\(0.2\)</span>.</p>
</td>
<td><p>Egg carton plane for both <span class="math notranslate nohighlight">\(B_{b,1}\neq 0\)</span> and <span class="math notranslate nohighlight">\(B_{b,2}\neq 0\)</span>.</p>
<p><em>This example has</em> <span class="math notranslate nohighlight">\(B_{b,0} = 0.2\)</span>, <span class="math notranslate nohighlight">\(B_{b,1} = 10\)</span>, <span class="math notranslate nohighlight">\(B_{b,2} = 10\)</span>
<em>and</em> <span class="math notranslate nohighlight">\(\vec{A}=(0,1,0)\)</span>, <em>to define a plane with normal in</em> <span class="math notranslate nohighlight">\(\hat{y}\)</span> <em>that has transverse modulation in</em> <span class="math notranslate nohighlight">\(\hat{x}\)</span> <em>and</em> <span class="math notranslate nohighlight">\(\hat{z}\)</span> <em>direction with amplitude</em> <span class="math notranslate nohighlight">\(0.2\)</span>.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p><strong>Wavy spheres</strong></p></li>
</ol>
<blockquote>
<div><p>For wavy spheres, the orientation functions take the form</p>
<div class="math-wrapper docutils container" id="eq-spherewavys1">
<span id="equation-eq-spherewavys1"></span><div class="math notranslate nohighlight" id="eq-spherewavys1">
<span id="equation-eq-spherewavys1"></span><span class="eqno">(15)<a class="headerlink" href="#eq-spherewavys1" title="Permalink to this equation">#</a></span>\[\begin{split}\tan S_{b,1}(\vec{x}) &amp;= \frac{A_y y - Q_y}{A_x x - Q_x} \\
\tan S_{b,2}(\vec{x}) &amp;= \frac{\sqrt{A_x^2(x-Q_x)^2 + A_y^2(y-Q_y)^2}}{A_z(z-Q_z)}\end{split}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(S_{b,1}\)</span> generates longitudinal waves (number set by the frequency <span class="math notranslate nohighlight">\(B_{b,1}\)</span>) and <span class="math notranslate nohighlight">\(S_{b,2}(\vec{x})\)</span> creates latitudinal waves (number set by the frequency <span class="math notranslate nohighlight">\(B_{b,2}\neq0\)</span>).</p>
<p>The accompanying standard surface <span class="math notranslate nohighlight">\(S^S(\vec{x})\)</span>, defines the <a class="reference internal" href="#eq-surfacesphere"><span class="std std-ref">sphere</span></a>.</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 33.3%" />
<col style="width: 33.3%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/LatitudeSphere.png"><img alt="../_images/LatitudeSphere.png" class="align-center" src="../_images/LatitudeSphere.png" style="width: 95%;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/LongitudinalSphere.png"><img alt="../_images/LongitudinalSphere.png" class="align-center" src="../_images/LongitudinalSphere.png" style="width: 95%;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/eggCartonSphere.png"><img alt="../_images/eggCartonSphere.png" class="align-center" src="../_images/eggCartonSphere.png" style="width: 95%;" /></a>
</td>
</tr>
<tr class="row-even"><td><p>Latitudinal waves for <span class="math notranslate nohighlight">\(B_{b,1} = 0\)</span> and <span class="math notranslate nohighlight">\(B_{b,2}\neq 0\)</span>.</p>
<p><em>This example has</em> <span class="math notranslate nohighlight">\(B_{b,0} = 0.2\)</span>, <span class="math notranslate nohighlight">\(B_{b,1} = 0\)</span>, <span class="math notranslate nohighlight">\(B_{b,2} = 10\)</span>
<em>and</em> <span class="math notranslate nohighlight">\(\vec{A}=(1,1,1)\)</span>, <em>to define a sphere that has latitudinal modulation with amplitude</em> <span class="math notranslate nohighlight">\(0.2\)</span>.</p>
</td>
<td><p>Longitudinal waves for <span class="math notranslate nohighlight">\(B_{b,1} \neq 0\)</span> and <span class="math notranslate nohighlight">\(B_{b,2} = 0\)</span>.</p>
<p><em>This example has</em> <span class="math notranslate nohighlight">\(B_{b,0} = 0.2\)</span>, <span class="math notranslate nohighlight">\(B_{b,1} = 10\)</span>, <span class="math notranslate nohighlight">\(B_{b,2} = 0\)</span>
<em>and</em> <span class="math notranslate nohighlight">\(\vec{A}=(1,1,1)\)</span>, <em>to define a sphere that has longitudinal modulation with amplitude</em> <span class="math notranslate nohighlight">\(0.2\)</span>.</p>
</td>
<td><p>Egg carton waves for <span class="math notranslate nohighlight">\(B_{b,1} \neq 0\)</span> and <span class="math notranslate nohighlight">\(B_{b,2} \neq 0\)</span>.</p>
<p><em>This example has</em> <span class="math notranslate nohighlight">\(B_{b,0} = 0.2\)</span>, <span class="math notranslate nohighlight">\(B_{b,1} = 10\)</span>, <span class="math notranslate nohighlight">\(B_{b,2} = 10\)</span>
<em>and</em> <span class="math notranslate nohighlight">\(\vec{A}=(1,1,1)\)</span>, <em>to define a sphere that has both latitudinal and longitudinal modulation with amplitude</em> <span class="math notranslate nohighlight">\(0.2\)</span>.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p><strong>Wavy cylinders</strong></p></li>
</ol>
<blockquote>
<div><p>The two orientation functions <span class="math notranslate nohighlight">\(S_{b,1}(\vec{x})\)</span> and <span class="math notranslate nohighlight">\(S_{b,2}(\vec{x})\)</span> have cylic properties with respect to cylinder orientation along the cartesian direction <span class="math notranslate nohighlight">\(\hat{x},\hat{y},\hat{z}\)</span>.</p>
<p>If the cylinder is oriented in the</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{x}\)</span>-direction, then <span class="math notranslate nohighlight">\(A_x=0\)</span> and <span class="math notranslate nohighlight">\((i,j,k)=(x,y,z)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{y}\)</span>-direction, then <span class="math notranslate nohighlight">\(A_y=0\)</span> and <span class="math notranslate nohighlight">\((i,j,k)=(y,z,x)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{z}\)</span>-direction, then <span class="math notranslate nohighlight">\(A_z=0\)</span> and <span class="math notranslate nohighlight">\((i,j,k)=(z,x,y)\)</span></p></li>
</ul>
<p>The orientation functions then take the form,</p>
<div class="math-wrapper docutils container" id="id36">
<span id="equation-eq-spherewavys1"></span><div class="math notranslate nohighlight" id="id36">
<span id="equation-eq-spherewavys1"></span><span class="eqno">(16)<a class="headerlink" href="#id36" title="Permalink to this equation">#</a></span>\[\begin{split}\tan S_{b,1}(\vec{x}) &amp;= \frac{A_k x_k - Q_k}{A_j x_j - Q_j} \\
\tan S_{b,2}(\vec{x}) &amp;= \frac{\sqrt{A_j^2(x_j-Q_j)^2 + A_k^2(x_k-Q_k)^2}}{A_i(x_i-Q_i)}\end{split}\]</div>
</div>
<p>The accompanying standard surface <span class="math notranslate nohighlight">\(S^S(\vec{x})\)</span>, defining the <a class="reference internal" href="#eq-surfacecylinder"><span class="std std-ref">cylinder</span></a>, has the following form under the cyclic axes,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[S^S(\vec{x}) = \left(x_j-Q_j \right )^2 + \left(x_k-Q_k \right)^2 - R^2 = 0\]</div>
</div>
</div></blockquote>
</section>
</section>
</section>
<section id="boundary-rules">
<span id="subsection-boundaryrules"></span><h3>Boundary rules<a class="headerlink" href="#boundary-rules" title="Permalink to this heading">#</a></h3>
<section id="requirements">
<h4>Requirements<a class="headerlink" href="#requirements" title="Permalink to this heading">#</a></h4>
<p>The implicit representation for the surface has the property that</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S(\vec{x}) &gt; 0\)</span>, a point is <strong>outside</strong> the surface</p></li>
<li><p><span class="math notranslate nohighlight">\(S(\vec{x}) = 0\)</span>, a point is <strong>on</strong> the surface</p></li>
<li><p><span class="math notranslate nohighlight">\(S(\vec{x}) &lt; 0\)</span>, a point is <strong>inside</strong> the surface.</p></li>
</ul>
<p>Following a streaming step, boundary conditions are applied to an MPCD particle if the particle has passed inside a boundary.
For a particle <span class="math notranslate nohighlight">\(i\)</span> with position <span class="math notranslate nohighlight">\(\vec{x}_i\)</span> this condition is</p>
<div class="math-wrapper docutils container" id="eq-bccondition">
<span id="equation-eq-bccondition"></span><div class="math notranslate nohighlight" id="eq-bccondition">
<span id="equation-eq-bccondition"></span><span class="eqno">(17)<a class="headerlink" href="#eq-bccondition" title="Permalink to this equation">#</a></span>\[S(\vec{x}_i) \leq 0\]</div>
</div>
<p>Boundary conditions are only applied to a particle when the position is exactly on the surface,
which requires tracing back the particle’s position <span class="math notranslate nohighlight">\(\vec{x}_i^*\)</span> to where <span class="math notranslate nohighlight">\(S(\vec{x}_i^*) = 0\)</span>
at time <span class="math notranslate nohighlight">\(t^*\)</span> where <span class="math notranslate nohighlight">\(0&lt;t^*&lt;\delta t\)</span>.
Following boundary rules, the particle resumes streaming for the remaining time <span class="math notranslate nohighlight">\(\delta t-t^*\)</span>.</p>
</section>
<section id="boundary-operators">
<h4>Boundary operators<a class="headerlink" href="#boundary-operators" title="Permalink to this heading">#</a></h4>
<p>Boundary rules are operators on a particle’s position <span class="math notranslate nohighlight">\(\vec{x}_i\)</span>, velocity <span class="math notranslate nohighlight">\(\vec{v}_i\)</span> or orientation properties <span class="math notranslate nohighlight">\(\hat{u}_i\)</span>.</p>
<p>For a general property <span class="math notranslate nohighlight">\(\vec{f}_i (t)\)</span>, the rules have the following form</p>
<div class="math-wrapper docutils container" id="eq-bcoperators1">
<span id="equation-eq-bcoperators1"></span><div class="math notranslate nohighlight" id="eq-bcoperators1">
<span id="equation-eq-bcoperators1"></span><span class="eqno">(18)<a class="headerlink" href="#eq-bcoperators1" title="Permalink to this equation">#</a></span>\[\vec{f}_i(t&gt;t^*) \: \text{+=} \: D_{f,\hat{\nu}}\hat{\nu}\]</div>
</div>
<div class="math-wrapper docutils container" id="eq-bcoperators2">
<span id="equation-eq-bcoperators2"></span><div class="math notranslate nohighlight" id="eq-bcoperators2">
<span id="equation-eq-bcoperators2"></span><span class="eqno">(19)<a class="headerlink" href="#eq-bcoperators2" title="Permalink to this equation">#</a></span>\[\vec{f}_i(t&gt;t^*) \: \text{+=} \: M_{f,\hat{\nu}} \vec{f}_{i,\hat{\nu}}(t&lt;t^*)\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\hat{\nu}\)</span> are implemented as each of the cartesian axes <span class="math notranslate nohighlight">\(\hat{x},\hat{y},\hat{z}\)</span>, the local surface normal <span class="math notranslate nohighlight">\(\hat{n}\)</span> and the local surface tangent <span class="math notranslate nohighlight">\(\hat{t}\)</span>.
The properties before and after the boundary rules are applied are <span class="math notranslate nohighlight">\(\vec{f}_i(t&lt;t^*)\)</span> and <span class="math notranslate nohighlight">\(\vec{f}_i(t&gt;t^*)\)</span>.
The <a class="reference internal" href="#eq-bcoperators1"><span class="std std-ref">shift operator</span></a> is an additive shift on vector <span class="math notranslate nohighlight">\(\vec{f}_i\)</span> in direction <span class="math notranslate nohighlight">\(\hat{\nu}\)</span> with magnitude <span class="math notranslate nohighlight">\(D_{f,\hat{\nu}}\)</span>
and the <a class="reference internal" href="#eq-bcoperators2"><span class="std std-ref">multiplier operator</span></a> <span class="math notranslate nohighlight">\(M_{f,\hat{\nu}}\)</span> acts on the projection <span class="math notranslate nohighlight">\(\vec{f}_{i,\hat{\nu}}\)</span> of the property <span class="math notranslate nohighlight">\(\vec{f}_i\)</span> in the direction <span class="math notranslate nohighlight">\(\hat{\nu}\)</span>.</p>
<section id="examples">
<h5>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h5>
<p>Defaults for no applied conditions are <span class="math notranslate nohighlight">\(D_{f,\hat{\nu}} = 0\)</span> and <span class="math notranslate nohighlight">\(M_{f,\hat{\nu}} = 1\)</span>,
leaving all components of <span class="math notranslate nohighlight">\(f_i\)</span> unchanged and without shifts.
The default operator values in the input scripts are shown below, which can be edited to define particular boundary condition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;position operators&quot;</span><span class="p">,</span>
  <span class="n">DN</span>  <span class="mi">0</span>           <span class="s2">&quot;position shift in normal direction&quot;</span><span class="p">,</span>
  <span class="n">DT</span>  <span class="mi">0</span>           <span class="s2">&quot;position shift in tangential direction&quot;</span><span class="p">,</span>

  <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;velocity operators&quot;</span><span class="p">,</span>
  <span class="n">DVN</span> <span class="mi">0</span>           <span class="s2">&quot;velocity added in the normal direction&quot;</span><span class="p">,</span>
  <span class="n">DVT</span> <span class="mi">0</span>           <span class="s2">&quot;velocity added in the tangential direction&quot;</span><span class="p">,</span>
  <span class="n">DVxyz</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>   <span class="s2">&quot;velocity added in the [x,y,z] cartesian directions&quot;</span><span class="p">,</span>

  <span class="n">MVN</span> <span class="mi">1</span>           <span class="s2">&quot;multiplies velocity in normal direction&quot;</span><span class="p">,</span>
  <span class="n">MVT</span> <span class="mi">1</span>           <span class="s2">&quot;multiplies velocity in tangential direction&quot;</span><span class="p">,</span>
  <span class="n">MVxyz</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>   <span class="s2">&quot;multiplies velocity in cartesian direction&quot;</span><span class="p">,</span>

  <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;orientation operators&quot;</span><span class="p">,</span>
  <span class="n">DUxyz</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>   <span class="s2">&quot;orientation added in the [x,y,z] cartesian directions&quot;</span><span class="p">,</span>
  <span class="n">MVN</span> <span class="mi">1</span>           <span class="s2">&quot;multiplies orientation in normal direction&quot;</span><span class="p">,</span>
  <span class="n">MVT</span> <span class="mi">1</span>           <span class="s2">&quot;multiplies orientation in tangential direction&quot;</span><span class="p">,</span>
  <span class="n">MVxyz</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>   <span class="s2">&quot;multiplies velocity in cartesian direction&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Commonly used boundary rules are:</p>
<ol class="arabic simple">
<li><p><strong>Position</strong></p></li>
</ol>
<blockquote>
<div><p><strong>Periodic boundary conditions</strong></p>
<p>Extended geometries, such as open systems or channel flows, often use periodic boundary conditions.
Periodic boundary conditions makes it possible to approximate an infinite system by wrapping coordinates around by their boundaries.
In order to achieve periodicity,
a planar boundary surface are created with <span class="math notranslate nohighlight">\(D_{x,\hat{n}}=L\)</span> as a shift equivalent to the system dimension.</p>
<figure class="align-center" id="id50">
<a class="reference internal image-reference" href="../_images/PBCschematic.png"><img alt="Logo" src="../_images/PBCschematic.png" style="width: 270.75px; height: 248.1px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Example of a particle that passes through a through a periodic boundary.</em>
<em>The particle rewinds back to the point on the surface, and a shift is applied</em>
<em>in the surface normal direction that takes the particle to the left side.</em>
<em>There, the particle resumes streaming for time</em> <span class="math notranslate nohighlight">\(\delta t-t^*\)</span>.</span><a class="headerlink" href="#id50" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Periodic boundary conditions are implemented as the default boundary conditions (so no boundaries required in input scripts).
An example of the manual input for periodic boundary conditions on the left and right wall would be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Left PBC&quot;</span><span class="p">,</span>
<span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>              <span class="s2">&quot;Ghost particles turned off (only required for solid boundaries)&quot;</span><span class="p">,</span>
<span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>      <span class="s2">&quot;Located on left-hand side of simulation domain &quot;</span><span class="p">,</span>
<span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>      <span class="s2">&quot;Normal vector faces right-ward&quot;</span><span class="p">,</span>
<span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>   <span class="s2">&quot;Surface power = 1 (plane)&quot;</span><span class="p">,</span>
<span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>              <span class="s2">&quot;Position - easiest to set to zero if using Q to define distance from origin&quot;</span><span class="p">,</span>
<span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="n">Lx</span><span class="p">,</span>             <span class="s2">&quot;Shift particle position by Lx in the direction of surface normal (shift right by Lx)&quot;</span><span class="p">,</span>
<span class="s2">&quot;DT&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>              <span class="s2">&quot;No shift in tangent direction&quot;</span>
<span class="p">},</span>
<span class="p">{</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Right PBC&quot;</span><span class="p">,</span>
<span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>              <span class="s2">&quot;Ghost particles turned off (only required for solid boundaries)&quot;</span><span class="p">,</span>
<span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="n">Lx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>     <span class="s2">&quot;Located on right-hand side of simulation domain &quot;</span><span class="p">,</span>
<span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>     <span class="s2">&quot;Normal vector faces left-ward&quot;</span><span class="p">,</span>
<span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>   <span class="s2">&quot;Surface power = 1 (plane)&quot;</span><span class="p">,</span>
<span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>              <span class="s2">&quot;Position - easiest to set to zero if using Q to define distance from origin&quot;</span><span class="p">,</span>
<span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="n">Lx</span><span class="p">,</span>             <span class="s2">&quot;Shift particle position by Lx in the direction of surface normal (shift left by Lx)&quot;</span><span class="p">,</span>
<span class="s2">&quot;DT&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>              <span class="s2">&quot;No shift in tangent direction&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p><strong>Velocity</strong></p></li>
</ol>
<blockquote>
<div><p><strong>Perfect-slip</strong></p>
<p>Perfect-slip rules are suitable for solid boundaries where viscous effects at the wall are negligible (shear stress at the boundary is zero).
Achieving perfect-slip utilises <em>reflective</em> boundary rules to the velocity.
The normal component of the velocity is reversed <span class="math notranslate nohighlight">\(M_{v,\hat{n}} = -1\)</span>,
while the tangential component is unchanged <span class="math notranslate nohighlight">\(M_{v,\hat{t}} = 1\)</span>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/perfectslip.png"><img alt="Logo" src="../_images/perfectslip.png" style="width: 330.8px; height: 160.4px;" /></a>
</figure>
<p>In the input files, perfect slip can be enabled by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Perfect slip BC&quot;</span><span class="p">,</span>
<span class="s2">&quot;MVN&quot;</span><span class="p">:</span>      <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;MVT&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p><strong>No slip</strong></p>
<p>No-slip refers to any impermeable boundary condition that brings the velocity of the fluid to zero at the wall.
Achieving no-slip utilises <em>bounce-back</em> boundary rules to the velocity <a class="reference internal" href="../References/References.html#allahyarov2002" id="id37"><span>[Allahyarov2002]</span></a>,
reversing the normal and tangential component of the velocity so that <span class="math notranslate nohighlight">\(M_{v,\hat{n}} = M_{v,\hat{t}} = -1\)</span>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/noslip.png"><img alt="Logo" src="../_images/noslip.png" style="width: 330.8px; height: 160.4px;" /></a>
</figure>
<p>In the input files, no-slip can be enabled by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;No-slip BC&quot;</span><span class="p">,</span>
<span class="s2">&quot;MVN&quot;</span><span class="p">:</span>      <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;MVT&quot;</span><span class="p">:</span>      <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p><strong>Orientation</strong></p></li>
</ol>
<p>For liquid crystalline fluids, boundary conditions (or anchoring conditions)
can be applied so that the particle orientation <span class="math notranslate nohighlight">\(\hat{u}_i\)</span> aligns in the normal direction to the boundary (homeotropic)
or tangential with the boundary (planar).</p>
<blockquote>
<div><p><strong>Homeotropic</strong></p>
<p>Alignment normal to the boundary requires <span class="math notranslate nohighlight">\(M_{v,\hat{n}} = 1\)</span> and <span class="math notranslate nohighlight">\(M_{v,\hat{t}} = 0\)</span>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/homeotropic.png"><img alt="Logo" src="../_images/homeotropic.png" style="width: 292.40000000000003px; height: 74.2px;" /></a>
</figure>
<p>In the input files, homeotropic anchoring can be enabled by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Homeotropic anchoring&quot;</span><span class="p">,</span>
<span class="s2">&quot;MUN&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;MUT&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p><strong>Planar</strong></p>
<p>Alignment tangential to the boundary requires <span class="math notranslate nohighlight">\(M_{v,\hat{n}} = 0\)</span> and <span class="math notranslate nohighlight">\(M_{v,\hat{t}} = 1\)</span>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/planar.png"><img alt="Logo" src="../_images/planar.png" style="width: 293.2px; height: 74.2px;" /></a>
</figure>
<p>In the input files, planar anchoring can be enabled by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>           <span class="s2">&quot;Planar anchoring&quot;</span><span class="p">,</span>
<span class="s2">&quot;MUN&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
<span class="s2">&quot;MUT&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="boundary-corrections">
<h4>Boundary corrections<a class="headerlink" href="#boundary-corrections" title="Permalink to this heading">#</a></h4>
<section id="ghost-particles">
<h5>Ghost particles<a class="headerlink" href="#ghost-particles" title="Permalink to this heading">#</a></h5>
<p>The random grid shifts (for Galilean invariance) can result in fluid cells being intersected by the boundary,
reducing the cell’s population below the average number density.
With fewer particles in the cell, the centre of mass velocity <span class="math notranslate nohighlight">\(\vec{v}^{\mathrm{cm}}_c\)</span> can fail to satisfy no-slip <a class="reference internal" href="../References/References.html#lamura2001" id="id38"><span>[Lamura2001]</span></a>.
A standard method to correct no-slip, so that <span class="math notranslate nohighlight">\(\vec{v}^{\mathrm{cm}}_c \approx 0\)</span>,
is to fill the cell with <span class="math notranslate nohighlight">\(N_\mathrm{ghost} =\langle N_c \rangle - N_c\)</span> virtual particles so that the effective cell density <span class="math notranslate nohighlight">\(N_c\)</span> is equal to the average density <span class="math notranslate nohighlight">\(\langle N_c \rangle\)</span>.</p>
<div class="math-wrapper docutils container" id="eq-virtualparticles1">
<span id="equation-eq-virtualparticles1"></span><div class="math notranslate nohighlight" id="eq-virtualparticles1">
<span id="equation-eq-virtualparticles1"></span><span class="eqno">(20)<a class="headerlink" href="#eq-virtualparticles1" title="Permalink to this equation">#</a></span>\[\vec{v}^{\mathrm{cm}}_c = \frac{1}{N_c}\left(\sum_{i=1}^{N_c} \vec{v_i} + \sum_{j=1}^{N_{\mathrm{ghost}}} \vec{v_j}^{\mathrm{ghost}} \right)\]</div>
</div>
<p>Each of these virtual particles <span class="math notranslate nohighlight">\(\vec{v_j}^{\mathrm{ghost}}\)</span> have a velocity drawn from a Maxwell Boltzmann distribution about zero with the same temperature of the fluid, <span class="math notranslate nohighlight">\(k_B T\)</span>.
Instead of determining each ghost particle’s velocity individually,
a simpler method is instead to select the entire correction <span class="math notranslate nohighlight">\(\vec{v}^{\mathrm{ghost}}\)</span>
from a Maxwell Boltzmann distribution about zero but with a variance of <span class="math notranslate nohighlight">\(N_{\mathrm{ghost}} k_B T\)</span> <a class="reference internal" href="../References/References.html#lamura2002" id="id39"><span>[Lamura2002]</span></a>.</p>
<div class="math-wrapper docutils container" id="eq-virtualparticles2">
<span id="equation-eq-virtualparticles2"></span><div class="math notranslate nohighlight" id="eq-virtualparticles2">
<span id="equation-eq-virtualparticles2"></span><span class="eqno">(21)<a class="headerlink" href="#eq-virtualparticles2" title="Permalink to this equation">#</a></span>\[\vec{v}^{\mathrm{cm}}_c = \frac{1}{N_c}\left(\sum_{i=1}^{N_c} \vec{v_i} + \vec{v}^{\mathrm{ghost}} \right)\]</div>
</div>
<p>Ghost particles are turned on for each boundary through the <code class="docutils literal notranslate"><span class="pre">phantom</span></code> tag.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;BC&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>          <span class="s2">&quot;this is 0 for off and 1 for on&quot;</span>
    <span class="p">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Ghost particles should be turned on for any solid boundary (e.g. no-slip, perfect slip).
Without it, the reduced particle density in cells leads to a lower viscosity in the proximity of walls.</p>
</div>
</section>
<section id="strong-anchoring">
<h5>Strong anchoring<a class="headerlink" href="#strong-anchoring" title="Permalink to this heading">#</a></h5>
<p>Since orientation boundary conditions are only applied to the subset of particles <span class="math notranslate nohighlight">\(N_{c*} \leq N_c\)</span> that violate the surface boundary equation <span class="math notranslate nohighlight">\(S(\vec{x})\leq0\)</span>,
the cell director <span class="math notranslate nohighlight">\(\hat{n}_c\)</span> mixes between the anchored and un-anchored orientations.
The effective anchoring strength is therefore heavily dependent on the proportion <span class="math notranslate nohighlight">\(N_{c*} / N_c\)</span>, with strongest anchoring acheived when <span class="math notranslate nohighlight">\(N_{c*} = N_c\)</span>.
To strengthen the effective anchoring, we apply the orientation boundary condition to all <span class="math notranslate nohighlight">\(N_c\)</span> particles <a class="reference internal" href="../References/References.html#head2023" id="id40"><span>[Head2023]</span></a>.</p>
<p>Strong anchoring is applied by default for solid boundaries, but requires the <code class="docutils literal notranslate"><span class="pre">phantom</span></code> tag to be turned on.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;BC&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>          <span class="s2">&quot;this is 0 for off and 1 for on&quot;</span>
    <span class="p">]</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="mobile-boundaries">
<h3>Mobile boundaries<a class="headerlink" href="#mobile-boundaries" title="Permalink to this heading">#</a></h3>
<section id="colloids">
<h4>Colloids<a class="headerlink" href="#colloids" title="Permalink to this heading">#</a></h4>
<p>MPCD Colloids are implemented as boundaries that are able to translate and rotate in response to interactions with the fluid.
Mobile boundaries have temporally-dependent surface parameters <span class="math notranslate nohighlight">\(\vec{Q}(t)\)</span> and <span class="math notranslate nohighlight">\(\vec{A}(t)\)</span>.
Translational and rotational motion are supported through upating <span class="math notranslate nohighlight">\(\vec{Q}(t)\)</span> and <span class="math notranslate nohighlight">\(\vec{A}(t)\)</span> using the boundary’s velocity and angular velocity properties <span class="math notranslate nohighlight">\(\vec{v}_{b}(t)\)</span> and <span class="math notranslate nohighlight">\(\vec{\omega}_{b}(t)\)</span>.</p>
<p>The boundary velocity and angular velocity each have three contributions</p>
<div class="math-wrapper docutils container" id="eq-colloidvelangvel">
<span id="equation-eq-colloidvelangvel"></span><div class="math notranslate nohighlight" id="eq-colloidvelangvel">
<span id="equation-eq-colloidvelangvel"></span><span class="eqno">(22)<a class="headerlink" href="#eq-colloidvelangvel" title="Permalink to this equation">#</a></span>\[\begin{split}\vec{v}_{b}(t) = \sum_i^{N_{c*}} \left( \Delta \vec{v}_{b,i}^{\mathrm{vel}} + \Delta \vec{v}_{b,i}^\mathrm{ori} \right) + \sum_j^{N_{col*}} \Delta \vec{v}_{b,j}^{\mathrm{col}} \\
\vec{\omega}_{b}(t) = \sum_i^{N_{c*}} \left( \Delta \vec{\omega}_{b,i}^{\mathrm{vel}} + \Delta \vec{\omega}_{b,i}^\mathrm{ori} \right) + \sum_j^{N_{col*}} \Delta \vec{\omega}_{b,j}^{\mathrm{col}}\end{split}\]</div>
</div>
<p>coming from incremental contributions due to conserving impulse and angular impulse between each of <span class="math notranslate nohighlight">\(N_{c*}\leq N\)</span> individual particles that have had applied velocity (<span class="math notranslate nohighlight">\(\mathrm{vel}\)</span>) and orientation (<span class="math notranslate nohighlight">\(\mathrm{ori}\)</span>) boundary conditions.
In addition, boundaries may move into other boundaries. For each of the <span class="math notranslate nohighlight">\(N_{col*}\)</span> overlapping boundaries, denoted by index <span class="math notranslate nohighlight">\(j\)</span>, additional boundary rules must be applied to simulate boundary-boundary interactions.
Like particles, these also enter as corrections to the boundaries <span class="math notranslate nohighlight">\(\vec{v}_{b}(t)\)</span> and <span class="math notranslate nohighlight">\(\vec{\omega}_{b}(t)\)</span>, through increments denoted by (<span class="math notranslate nohighlight">\(\mathrm{col}\)</span>).
Colloid-colloid interactions are treated as elastic collisions.</p>
<p>Boundaries are enabled to be mobile by setting <code class="docutils literal notranslate"><span class="pre">&quot;dsplc&quot;</span> <span class="pre">=</span> <span class="pre">1</span></code> in the boundary input.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;BC&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="s2">&quot;dsplc&quot;</span><span class="p">:</span>    <span class="mi">1</span><span class="p">,</span>
    <span class="p">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The current version only support mobile spherical colloids where <span class="math notranslate nohighlight">\(\vec{A}(t) = \vec{A}(0)\)</span>.</p>
</div>
<section id="motion-from-velocity-rules">
<h5>Motion from velocity rules<a class="headerlink" href="#motion-from-velocity-rules" title="Permalink to this heading">#</a></h5>
<p>When <a class="reference internal" href="#subsection-boundaryrules"><span class="std std-ref">boundary rules</span></a> are applied to a particle, the velocity can be updated through the velocity shift <span class="math notranslate nohighlight">\(D_{v,\hat{\nu}}\)</span> and multiplier operators <span class="math notranslate nohighlight">\(M_{v,\hat{\nu}}\)</span> in the directions specified by <span class="math notranslate nohighlight">\(\hat{\nu}\)</span> — corresponding to a change in the particle’s momentum (if any <span class="math notranslate nohighlight">\(M_{v,\hat{\nu}}\neq 1\)</span> or <span class="math notranslate nohighlight">\(D_{v,\hat{\nu}}\neq 0\)</span>).
The change of momentum of the particle over the time-step interval <span class="math notranslate nohighlight">\(\delta t\)</span> can be written in terms of the particle impulse <span class="math notranslate nohighlight">\(\vec{J}_i\)</span></p>
<div class="math-wrapper docutils container" id="eq-impulse">
<span id="equation-eq-impulse"></span><div class="math notranslate nohighlight" id="eq-impulse">
<span id="equation-eq-impulse"></span><span class="eqno">(23)<a class="headerlink" href="#eq-impulse" title="Permalink to this equation">#</a></span>\[\vec{p}_i(t+\delta t) - \vec{p}_i(t) = \vec{J}_i.\]</div>
</div>
<p>If the boundary is static, then the impulse is absorbed by the boundary. However,
if the boundary is mobile, then we assume impulse conservation between the particle and boundary, <span class="math notranslate nohighlight">\(\vec{J}_i+\vec{J}_b=0\)</span>.
Where <span class="math notranslate nohighlight">\(b\)</span> denotes the boundary index.</p>
<p>In satisfying the impulse conservation, the correction to the colloid’s velocity and angular velocity, due to the applied velocity boundary rules on particle <span class="math notranslate nohighlight">\(i\)</span>, is</p>
<div class="math-wrapper docutils container" id="eq-impulsetocolloid">
<span id="equation-eq-impulsetocolloid"></span><div class="math notranslate nohighlight" id="eq-impulsetocolloid">
<span id="equation-eq-impulsetocolloid"></span><span class="eqno">(24)<a class="headerlink" href="#eq-impulsetocolloid" title="Permalink to this equation">#</a></span>\[\begin{split}\Delta \vec{v}_{b,i}^{\mathrm{vel}} = I_b^{-1}\vec{J}_{b,\hat{n}} \\
\Delta \vec{\omega}_{b,i}^{\mathrm{vel}} = \vec{r}\times(I_b^{-1}\vec{J}_{b,\hat{t}})\end{split}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\vec{J}_{b,\hat{n}}=(\vec{J}_b\cdot\hat{n})\hat{n}\)</span> is the normal component and <span class="math notranslate nohighlight">\(\vec{J}_{b,\hat{t}}=\vec{J}_b-(\vec{J}_b\cdot\hat{n})\hat{n}\)</span> is the tangential component of the impulse.
The inverse of the moment of inertia tensor is <span class="math notranslate nohighlight">\(I_b^{-1}\)</span>. The vector from the centre of mass to the collision on the wall is <span class="math notranslate nohighlight">\(\vec{r}\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The current version only support mobile spherical colloids where the local
surface normal and tangent projections of the impulse are sufficient for separating translational and rotational motion.</p>
</div>
</section>
<section id="motion-from-orientation-rules">
<h5>Motion from orientation rules<a class="headerlink" href="#motion-from-orientation-rules" title="Permalink to this heading">#</a></h5>
<p>The particle-boundary interactions can update the particle orientation through the multiplier operations <span class="math notranslate nohighlight">\(M_{u,\hat{\nu}}\)</span> in the directions specified by <span class="math notranslate nohighlight">\(\hat{\nu}\)</span>.
The reorientation of particle <span class="math notranslate nohighlight">\(i\)</span> corresponds to a rotational impulse <span class="math notranslate nohighlight">\(\vec{\mathcal{T}}_i\)</span> due to a change in angular momentum over time interval <span class="math notranslate nohighlight">\(\delta t\)</span>.</p>
<div class="math-wrapper docutils container" id="eq-angularimpulse">
<span id="equation-eq-angularimpulse"></span><div class="math notranslate nohighlight" id="eq-angularimpulse">
<span id="equation-eq-angularimpulse"></span><span class="eqno">(25)<a class="headerlink" href="#eq-angularimpulse" title="Permalink to this equation">#</a></span>\[\vec{\omega}_i(t+\delta t) - \vec{\omega}_i(t) = \vec{\mathcal{T}}_i.\]</div>
</div>
<p>The equation has a pivot point defined at the particle position on the boundary.</p>
<p>Similar to the velocity rules, if the boundary is static, then the rotational impulse is absorbed by the boundary.
However, if the boundary is mobile, then we assume rotational impulse conservation between the particle and boundary.
It is the rotational impulse that needs to be converted into boundary increments <span class="math notranslate nohighlight">\(\Delta \vec{v}_{b,i}^\mathrm{ori}\)</span> and <span class="math notranslate nohighlight">\(\Delta \vec{\omega}_{b,i}^\mathrm{ori}\)</span> <a class="reference internal" href="../References/References.html#head2023" id="id41"><span>[Head2023]</span></a>.</p>
<p>For our mobile colloid, <a class="reference internal" href="#eq-angularimpulse"><span class="std std-ref">rotational impulse conservation</span></a> can be recast into a torque balance, through <span class="math notranslate nohighlight">\(\vec{\mathcal{T}}_i=\vec{\Gamma}_i \delta t\)</span></p>
<div class="math-wrapper docutils container" id="eq-torqueconservation">
<span id="equation-eq-torqueconservation"></span><div class="math notranslate nohighlight" id="eq-torqueconservation">
<span id="equation-eq-torqueconservation"></span><span class="eqno">(26)<a class="headerlink" href="#eq-torqueconservation" title="Permalink to this equation">#</a></span>\[\vec{\Gamma}_i + \vec{\Gamma}_{b,i} = 0\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\vec{\Gamma}_{b,i}\)</span> is the torque that is transferred to the colloid at the position of particle <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>For a particle with initial orientation <span class="math notranslate nohighlight">\(\hat{u}_i\)</span> with an anchoring axis <span class="math notranslate nohighlight">\(\hat{\nu}\)</span>, the torque on the particle takes the form</p>
<div class="math-wrapper docutils container" id="eq-impulse3">
<span id="equation-eq-impulse3"></span><div class="math notranslate nohighlight" id="eq-impulse3">
<span id="equation-eq-impulse3"></span><span class="eqno">(27)<a class="headerlink" href="#eq-impulse3" title="Permalink to this equation">#</a></span>\[\vec{\Gamma}_i = \frac{\gamma_R}{\ell_u \delta t} \frac{M_{\nu}-M_{\perp}}{\sqrt{M_\nu^2 + M_\perp^2}}\left(\hat{u}_i \cdot \hat{\nu} \right)\left( \hat{u}_i \times \hat{\nu} \right)\]</div>
</div>
<p>with <span class="math notranslate nohighlight">\(\frac{M_{\nu}-M_{\perp}}{\sqrt{M_\nu^2 + M_\perp^2}}=1\)</span> when anchoring is fixed along <span class="math notranslate nohighlight">\(\hat{\nu}\)</span> using <span class="math notranslate nohighlight">\(M_{\nu}=1\)</span> and <span class="math notranslate nohighlight">\(M_{\perp}=0\)</span> (the multiplier perpendicular to <span class="math notranslate nohighlight">\(M_{\nu}\)</span>).</p>
<p>The torque is only dependent on fixed simulation parameters and the relative alignment of <span class="math notranslate nohighlight">\(\hat{u}_i\)</span> and <span class="math notranslate nohighlight">\(\hat{\nu}\)</span>.
Defining the alignment as <span class="math notranslate nohighlight">\(\cos\theta_i = \hat{u}_i\cdot \hat{\nu}\)</span>, the torque <span class="math notranslate nohighlight">\(\Gamma_i = \frac{\gamma_R}{\ell_u \delta t} \sin 2\theta\)</span>.
The torque is odd under <span class="math notranslate nohighlight">\(\Gamma_i(-\theta)=-\Gamma_i(\theta)\)</span>,
which motivates that the torque transferred to the colloid can be treated as a virtual MPCD particle at the same point,
oriented in the direction <span class="math notranslate nohighlight">\(\hat{u}_{b,i}\)</span> that has angle <span class="math notranslate nohighlight">\(-\theta\)</span> relative to <span class="math notranslate nohighlight">\(\hat{\nu}\)</span>, and rotates in the opposite sense to <span class="math notranslate nohighlight">\(\hat{u}_i\)</span>.
This construction satisfies the <a class="reference internal" href="#eq-torqueconservation"><span class="std std-ref">torque conservation equation</span></a>.</p>
<p>The torque <span class="math notranslate nohighlight">\(\vec{\Gamma}_{b,i}\)</span> on the virtual particle, is converted into a force at the colloidal boundary by,</p>
<div class="math-wrapper docutils container" id="eq-force">
<span id="equation-eq-force"></span><div class="math notranslate nohighlight" id="eq-force">
<span id="equation-eq-force"></span><span class="eqno">(28)<a class="headerlink" href="#eq-force" title="Permalink to this equation">#</a></span>\[\vec{F}_{b,i} = \frac{\vec{\Gamma}_{b,i} \times \hat{u}_{b,i}}{\ell_u}\]</div>
</div>
<p>where the above is only valid with the assumption <span class="math notranslate nohighlight">\(\hat{u}_{b,i}\)</span> and <span class="math notranslate nohighlight">\(\vec{F}_{b,i}\)</span> are orthogonal.
The parameter <span class="math notranslate nohighlight">\(\ell_u\)</span> has units of length, and is the effective length of the rod <code class="docutils literal notranslate"><span class="pre">len</span></code>.
This assumption is motivated by the anchoring reorientation being purely rotational motion around the pivot point, and hence no colinear contributions between the force and orientation <span class="math notranslate nohighlight">\(\hat{u}_{b,i}\cdot\hat{F}_{b,i} = 0\)</span>.</p>
<p>Since the orientation <span class="math notranslate nohighlight">\(\hat{u}_{b,i}\)</span> is head-tail symmetric, the force has an ambiguous sign under <span class="math notranslate nohighlight">\(\vec{F}(-\hat{u}_{b,i})=-\vec{F}(\hat{u}_{b,i})\)</span>.
For this reason, the force is chosen to be oriented into the boundary, motivated by nematic colloids moving away from large elastic stress in reducing elastic deformation.</p>
<p>The increments to the colloid’s velocity and angular velocity are</p>
<div class="math-wrapper docutils container" id="id42">
<span id="equation-eq-impulsetocolloid"></span><div class="math notranslate nohighlight" id="id42">
<span id="equation-eq-impulsetocolloid"></span><span class="eqno">(29)<a class="headerlink" href="#id42" title="Permalink to this equation">#</a></span>\[\begin{split}\Delta \vec{v}_{b,i}^{\mathrm{ori}} = I_b^{-1} \vec{F}_{b,\hat{n}}\delta t \\
\Delta \vec{\omega}_{b,i}^{\mathrm{ori}} =  \vec{r}\times (I_b^{-1}\vec{F}_{b,\hat{t}}\delta t)\end{split}\]</div>
</div>
<p>where the vector from the centre of mass to the collision on the wall is <span class="math notranslate nohighlight">\(\vec{r}\)</span>,
<span class="math notranslate nohighlight">\(\vec{F}_{b,\hat{n}}=(\vec{F}_b\cdot\hat{n})\hat{n}\)</span> is the normal component and <span class="math notranslate nohighlight">\(\vec{F}_{b,\hat{t}}=\vec{F}_b-(\vec{F}_b\cdot\hat{n})\hat{n}\)</span> is the tangential component the force.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The current version only support mobile spherical colloids with homeotropic anchoring (<span class="math notranslate nohighlight">\(\hat{\nu}=\hat{n}\)</span>)</p>
</div>
</section>
</section>
</section>
<section id="liquids-inside-or-outside-boundaries">
<h3>Liquids inside or outside boundaries<a class="headerlink" href="#liquids-inside-or-outside-boundaries" title="Permalink to this heading">#</a></h3>
<p>We can not only have partcies/liquids inside closed system. Like we have a 2D square system with absolute solid walls</p>
<img alt="../_images/BC_classic.jpg" src="../_images/BC_classic.jpg" />
<p>But the boudaries also can be movable and interact with other boundaries and particles/liquids in the system.
The ones which are solid</p>
<img alt="../_images/BC_another_bc_inside.jpg" src="../_images/BC_another_bc_inside.jpg" />
<p>Teh example configuration for this boundary looks like this</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;BC&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="s2">&quot;inv&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;A&quot;</span><span class="p">:</span>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;P&quot;</span><span class="p">:</span>        <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;Q&quot;</span><span class="p">:</span>        <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
        <span class="s2">&quot;R&quot;</span><span class="p">:</span>        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;dsplc&quot;</span><span class="p">:</span>    <span class="mi">1</span><span class="p">,</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>inv parameter is necessary there, 0 indicates that particles should move outside the obstacle in the initialization. Dsplc parameter indicates that obstacle can be moved.</p>
<p>And the ones which can have particles/liquid inside.
If we want the liquid to be inside the obstacle we should set inv paramter to 1 can set species distribution to be inside the obstacle. An example configuration for it</p>
<img alt="../_images/BC_another_bc_filled.jpg" src="../_images/BC_another_bc_filled.jpg" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;dens&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s2">&quot;mass&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;qDist&quot;</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="s2">&quot;BC&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="s2">&quot;inv&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;A&quot;</span><span class="p">:</span>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;P&quot;</span><span class="p">:</span>        <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
        <span class="s2">&quot;Q&quot;</span><span class="p">:</span>        <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
        <span class="s2">&quot;R&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
        <span class="s2">&quot;dsplc&quot;</span><span class="p">:</span>    <span class="mi">1</span><span class="p">,</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>The inv 1 will make sure that particles will be inside our obstacle and qDist 2 will place all particles in the center of control volume.</p>
</section>
<section id="other">
<h3>Other<a class="headerlink" href="#other" title="Permalink to this heading">#</a></h3>
<section id="thermal-boundary-conditions">
<h4>Thermal boundary conditions<a class="headerlink" href="#thermal-boundary-conditions" title="Permalink to this heading">#</a></h4>
<p>MPCD boundaries are able interact with the particles in natural physical way.
Depending on the collision type of the boundary</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;BC&quot;:</span>
<span class="go">[</span>
<span class="go">    {</span>
<span class="go">        &quot;colType&quot;:</span>
<span class="go">    }</span>
<span class="go">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">colType</span><span class="p">:</span>
<span class="mi">0</span> <span class="o">-</span> <span class="n">Respects</span> <span class="nb">all</span> <span class="n">conservation</span> <span class="n">laws</span> <span class="n">by</span> <span class="n">impact</span> <span class="n">analysis</span><span class="o">.</span>
<span class="mi">1</span> <span class="o">-</span> <span class="n">Rule</span> <span class="n">based</span> <span class="n">collisions</span> <span class="n">at</span> <span class="n">the</span> <span class="n">surface</span><span class="o">.</span>
<span class="mi">2</span> <span class="o">-</span> <span class="n">Probabilistic</span> <span class="n">reflections</span> <span class="n">at</span> <span class="n">the</span> <span class="n">surface</span><span class="o">.</span>
</pre></div>
</div>
<p>If we have collision type 2 for boundaries - particles will draw random velocities from a thermal distribution.
All the interactions are based on KBT value. Tangential value of the velocity of the particle is being drawn from Maxwell-Boltzmann distribution.
And the normal value is being drawn from Rayleigh distribution.</p>
</section>
</section>
</section>
<section id="transport-coefficients">
<span id="chaptervisc"></span><h2>Transport coefficients<a class="headerlink" href="#transport-coefficients" title="Permalink to this heading">#</a></h2>
<p id="viscositysection">As any other transport coefficient, the viscocity estimates of an MPCD fluid, both dynamical (<span class="math notranslate nohighlight">\(\eta\)</span>) and kinematic (<span class="math notranslate nohighlight">\(\nu = \eta/\rho = \eta/(\langle N_c\rangle m/a^d\)</span>) viscocities, have kinematic and collisional contributions. Here, we focus on estimating the kinematic viscocity.
We first consider the case of a diluted gas. In this case, the kinematic viscocity is dominated by its kinematic contribution, namely, the momentum carried by fluid particles to other regions of space. This can be estimated to be approximately the thermal velocity <span class="math notranslate nohighlight">\(\sqrt{K_B T/m}\)</span> times the mean free path <span class="math notranslate nohighlight">\(\lambda = \delta t \sqrt{K_B T/m}\)</span> <a class="reference internal" href="../References/References.html#gompper2009" id="id43"><span>[Gompper2009]</span></a>.</p>
<div class="math-wrapper docutils container" id="eq-vis-kin">
<span id="equation-eq-vis-kin"></span><div class="math notranslate nohighlight" id="eq-vis-kin">
<span id="equation-eq-vis-kin"></span><span class="eqno">(30)<a class="headerlink" href="#eq-vis-kin" title="Permalink to this equation">#</a></span>\[\nu_{\text{kin}} \sim \delta t \frac{k_B T}{m}.\]</div>
</div>
<p>As density increases and the dilute gas regime is abandoned, momentum stops being primarely carried out by moving particles but rather is transported through collision events. As such, the collision contribution to the viscocity becomes dominant. Since collisions occur once every <span class="math notranslate nohighlight">\(\delta t\)</span> in cells of size <span class="math notranslate nohighlight">\(a\)</span>, simple scaling suggests that collisions contribute to the viscocity approximately as</p>
<div class="math-wrapper docutils container" id="eq-vis-col">
<span id="equation-eq-vis-col"></span><div class="math notranslate nohighlight" id="eq-vis-col">
<span id="equation-eq-vis-col"></span><span class="eqno">(31)<a class="headerlink" href="#eq-vis-col" title="Permalink to this equation">#</a></span>\[\nu_{\text{col}}\sim  \frac{a^2}{\delta t}.\]</div>
</div>
<p>As such, when the mean free path is small compared to the cell size, the collisional contribution dominates. In the opposite case, the kinetic term dominates. In general, the total kinematic viscocity is the sum of kinematic and collisional terms.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\nu = \nu_{\text{kin}} + \nu_{\text{col}}.\]</div>
</div>
<p>The specific way in which the estimates for the kinematic and <a class="reference internal" href="#eq-vis-col"><span class="std std-ref">collisional</span></a> contributions are weighted depends on the specifics of the model being used. These are captured through auxiliary functions <span class="math notranslate nohighlight">\(f_\text{kin}(\theta,\langle N_c\rangle,d)\)</span> and <span class="math notranslate nohighlight">\(f_\text{col}(\theta,\langle N_c\rangle,d)\)</span>, such that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
    \nu_{\text{kin}} =&amp; \delta t  \frac{k_B T}{m}\, f_\text{kin}(\theta,\langle N_c\rangle,d),\\
    \nu_{\text{col}} =&amp; \frac{a^2}{\delta t} f_\text{col}(\theta,\langle N_c\rangle,d).
\end{eqnarray}\end{split}\]</div>
</div>
<p>The table below list these functions for the most common collision operators <a class="reference internal" href="../References/References.html#kikuchi2003" id="id44"><span>[Kikuchi2003]</span></a>, <a class="reference internal" href="../References/References.html#tuzel2003" id="id45"><span>[Tüzel2003]</span></a>, <a class="reference internal" href="../References/References.html#gotze2007" id="id46"><span>[Götze2007]</span></a>, <a class="reference internal" href="../References/References.html#noguchi2007" id="id47"><span>[Noguchi2007]</span></a>, <a class="reference internal" href="../References/References.html#gompper2009" id="id48"><span>[Gompper2009]</span></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Collision Operator</p></th>
<th class="head"><p>Contribution</p></th>
<th class="head" colspan="2"><p>Expression</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="3"><p>SRD fluid</p></td>
<td rowspan="2"><p><span class="math notranslate nohighlight">\(f_\text{kin}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\left[\frac{\Upsilon}{\sin^2(\theta)}-1\right]\)</span></p></td>
<td><p>2D</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\left[\frac{5\,\Upsilon}{2-\cos(\theta)-\cos(2 \theta)}-1\right]\)</span></p></td>
<td><p>3D</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(f_\text{col}\)</span></p></td>
<td colspan="2"><p><span class="math notranslate nohighlight">\(\frac{1-\cos(\theta)}{6\, d \,\Upsilon}\)</span></p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>Andersen</p></td>
<td><p><span class="math notranslate nohighlight">\(f_\text{kin}\)</span></p></td>
<td colspan="2"><p><span class="math notranslate nohighlight">\(\Upsilon-\frac{1}{2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(f_\text{col}\)</span></p></td>
<td colspan="2"><p><span class="math notranslate nohighlight">\(\frac{1}{12 \Upsilon}\)</span></p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>Langevin</p></td>
<td><p><span class="math notranslate nohighlight">\(f_\text{kin}\)</span></p></td>
<td colspan="2"><p><span class="math notranslate nohighlight">\(\frac{[1+\alpha/2]^2}{2 \alpha}\,\Upsilon-\frac{1}{2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(f_\text{col}\)</span></p></td>
<td colspan="2"><p><span class="math notranslate nohighlight">\(\frac{1}{12}\frac{\alpha}{1+\alpha/2}\frac{1}{\Upsilon}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>in which <span class="math notranslate nohighlight">\(\Upsilon \equiv \langle N_c \rangle/( \langle N_c \rangle-1+\exp(- \langle N_c \rangle))\)</span> and <span class="math notranslate nohighlight">\(\alpha \equiv (\gamma \delta t)/m\)</span> (with <span class="math notranslate nohighlight">\(\gamma\)</span> the inverse of the Langevin relaxation time) are defined for convenience.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="ExtraOptions.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Extra options</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="Background.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Background</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Shendruk Lab
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Usage</a><ul>
<li><a class="reference internal" href="#particle-properties">Particle properties</a><ul>
<li><a class="reference internal" href="#basic-fluid">Basic fluid</a><ul>
<li><a class="reference internal" href="#position">Position</a></li>
<li><a class="reference internal" href="#velocity">Velocity</a></li>
<li><a class="reference internal" href="#mass">Mass</a></li>
<li><a class="reference internal" href="#population">Population</a></li>
<li><a class="reference internal" href="#damping-coefficient">Damping coefficient</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nematic-fluid">Nematic fluid</a><ul>
<li><a class="reference internal" href="#orientation">Orientation</a></li>
<li><a class="reference internal" href="#rotational-friction-coefficient">Rotational friction coefficient</a></li>
<li><a class="reference internal" href="#tumbling-parameter">Tumbling parameter</a></li>
<li><a class="reference internal" href="#shear-susceptibility">Shear susceptibility</a></li>
<li><a class="reference internal" href="#magnetic-susceptibility">Magnetic susceptibility</a></li>
<li><a class="reference internal" href="#length">Length</a></li>
<li><a class="reference internal" href="#activity">Activity</a></li>
<li><a class="reference internal" href="#local-activity-modulators">Local activity modulators</a></li>
<li><a class="reference internal" href="#ratio-of-active-particles">Ratio of active particles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multiphase">Multiphase</a><ul>
<li><a class="reference internal" href="#interaction-matrix">Interaction matrix</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#cell-properties">Cell properties</a><ul>
<li><a class="reference internal" href="#number-density">Number density</a></li>
<li><a class="reference internal" href="#galilean-invariance">Galilean invariance</a></li>
<li><a class="reference internal" href="#conservation-of-angular-momentum">Conservation of angular momentum</a></li>
<li><a class="reference internal" href="#thermostats">Thermostats</a></li>
</ul>
</li>
<li><a class="reference internal" href="#collision-operators">Collision operators</a><ul>
<li><a class="reference internal" href="#stochastic-rotation-dynamics">Stochastic rotation dynamics</a></li>
<li><a class="reference internal" href="#andersen-thermostatted-mpcd">Andersen-thermostatted MPCD</a></li>
</ul>
</li>
<li><a class="reference internal" href="#initialization">Initialization</a><ul>
<li><a class="reference internal" href="#id17">Basic fluid</a><ul>
<li><a class="reference internal" href="#qdist">Position</a></li>
<li><a class="reference internal" href="#vdist">Velocity</a></li>
<li><a class="reference internal" href="#massinitialization">Mass</a></li>
<li><a class="reference internal" href="#pop">Population</a></li>
<li><a class="reference internal" href="#damp">Damping coefficient</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id23">Nematic fluid</a><ul>
<li><a class="reference internal" href="#odist">Orientation</a></li>
<li><a class="reference internal" href="#rfc">Rotational friction coefficient</a></li>
<li><a class="reference internal" href="#tumble">Tumbling parameter</a></li>
<li><a class="reference internal" href="#chihi">Shear susceptibility</a></li>
<li><a class="reference internal" href="#chia">Magnetic susceptibility</a></li>
<li><a class="reference internal" href="#len">Length</a></li>
<li><a class="reference internal" href="#act">Activity</a></li>
<li><a class="reference internal" href="#sig">Local activity modulators</a></li>
<li><a class="reference internal" href="#minactratio">Ratio of active particles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id33">Multiphase</a><ul>
<li><a class="reference internal" href="#matrix">Interaction matrix</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#boundary-conditions">Boundary conditions</a><ul>
<li><a class="reference internal" href="#surfaces">Surfaces</a><ul>
<li><a class="reference internal" href="#standard-surfaces">Standard surfaces</a></li>
<li><a class="reference internal" href="#additional-surface-forms">Additional surface forms</a><ul>
<li><a class="reference internal" href="#wavy-surfaces">Wavy surfaces</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#boundary-rules">Boundary rules</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#boundary-operators">Boundary operators</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#boundary-corrections">Boundary corrections</a><ul>
<li><a class="reference internal" href="#ghost-particles">Ghost particles</a></li>
<li><a class="reference internal" href="#strong-anchoring">Strong anchoring</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mobile-boundaries">Mobile boundaries</a><ul>
<li><a class="reference internal" href="#colloids">Colloids</a><ul>
<li><a class="reference internal" href="#motion-from-velocity-rules">Motion from velocity rules</a></li>
<li><a class="reference internal" href="#motion-from-orientation-rules">Motion from orientation rules</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#liquids-inside-or-outside-boundaries">Liquids inside or outside boundaries</a></li>
<li><a class="reference internal" href="#other">Other</a><ul>
<li><a class="reference internal" href="#thermal-boundary-conditions">Thermal boundary conditions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#transport-coefficients">Transport coefficients</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>