<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Analysis" href="../Analysis/Analysis.html" /><link rel="prev" title="Hard-coded options" href="../HardCoded/HardCoded.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>Tutorials - MPCD documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">MPCD  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">MPCD  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Summary/Summary.html">Executive summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Install/Install.html">Installation &amp; run guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Main/Background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Main/Usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Main/ExtraOptions.html">Extra options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Outputs/Outputs.html">Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HardCoded/HardCoded.html">Hard-coded options</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Analysis/Analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DeveloperGuide/DeveloperGuide.html">Developer’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Glossary/Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../References/References.html">Bibliography</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="tutorials">
<span id="id1"></span><h1>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this heading">#</a></h1>
<section id="first-simulation">
<span id="isoptropic"></span><h2>First simulation<a class="headerlink" href="#first-simulation" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to run the most basic MPCD simulation conceivable:</p>
<ul class="simple">
<li><p>an isotropic fluid</p></li>
<li><p>in 2D</p></li>
<li><p>with no flow or external forces</p></li>
<li><p>and no solutes</p></li>
<li><p>contained within periodic boundary conditions.</p></li>
</ul>
<p>This is simply a thermalized fluid to introduce how the input files works for first time users.</p>
<p>This tutorial is based on the input file found in <code class="docutils literal notranslate"><span class="pre">MPCD/SampleInputs/01_FirstSimulation_PassiveIsotropic2D/input.json</span></code>.</p>
<section id="input-file">
<h3>Input File<a class="headerlink" href="#input-file" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;SIMULATION-SCALE INPUTS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Small, square geometry --- Regardless of boundary conditions, you need to specify the simulation box size&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Number of simulation steps to perform in the simulation --- this is in iterations; not MPCD time units&quot;</span><span class="p">,</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">2000</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Number of times steps to perform prior to outputting data --- this allows the system to reach equilibrium or steady state&quot;</span><span class="p">,</span>
    <span class="s2">&quot;warmUp&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Streaming time step in MPCD time units&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dt&quot;</span><span class="p">:</span>               <span class="mf">0.1</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;collOp&quot;</span><span class="p">:</span>           <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;MPCD relies on generating random numbers. If need to repeat a simulation exactly can set random seed by hand. seed==0 generates a &#39;random&#39; random seed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;seed&quot;</span><span class="p">:</span>             <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;FLUID PARTICLE SPECIES INPUTS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;All the information regarding the chemical species --- can have multiple species but commonly just one species&quot;</span><span class="p">,</span>
    <span class="s2">&quot;species&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;pop sets the total number of particles of this type in the simulation. Given the system size this sets an average cell density of 20 particles per MPCD cell, which is is standard&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pop&quot;</span><span class="p">:</span>         <span class="mi">18000</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;An equivalent to the above line is &#39;&#39;dens&#39;: 20&#39;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Mass of particles&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mass&quot;</span><span class="p">:</span>         <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Initial velocity distribution --- MPCD quickly thermalizes due to thermostate. 0==isorandom; 4==Gaussian dist&quot;</span><span class="p">,</span>
            <span class="s2">&quot;vDist&quot;</span><span class="p">:</span>        <span class="mi">0</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;All the above species information is the DEFAULT --- therefore, extraneous and could have left out&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;BOUNDARY CONDITION INPUTS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;c&quot;</span><span class="p">:</span>                <span class="s2">&quot;BCs are four periodic boundary conditions (PBC) at the edges of the system box&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BC&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;c&quot;</span><span class="p">:</span>            <span class="s2">&quot;Left PBC&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Position of BC&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Direction/surface normal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Power on terms --- 1==plane, 2==sphere or ellipsoid, etc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Constant term --- typically, radius for spheres&quot;</span><span class="p">,</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;PBCs displace/shift/teleport the particles in the normal direction&quot;</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">50</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;PBCs do NOT modify particle positions in the tangential direction&quot;</span><span class="p">,</span>
            <span class="s2">&quot;DT&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;PBCs do NOT modify particle velocity in either the normal or tangential directions --- MVN=multiplicative factor in normal direction; MVT=multiplicative factor in tangential direction&quot;</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;c&quot;</span><span class="p">:</span>            <span class="s2">&quot;Right PBC&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">50</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;c&quot;</span><span class="p">:</span>            <span class="s2">&quot;Bottom wall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">50</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;c&quot;</span><span class="p">:</span>            <span class="s2">&quot;Top wall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">50</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;The above is just PBCs and since this is a standard BC, all those lines could be replaced by just ``domainWalls&#39;:1&#39; sets PBCs around the domain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Furthermore, `domainWalls&#39;:1&#39; is the default so even that is extraneous and could have left out&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;OUTPUTS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;There are very many things that can be outputted but you will never need all of the possible output, so specify what to output&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;ALWAYS output a synopsis file so that you can check if the simulation is really what you thought it was&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Synopsis file also includes info like the viscosity of the fluid based on input parameters&quot;</span><span class="p">,</span>
    <span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;debugOut specifies how much information is writen to the terminal. When programming you might want lots, when running small, local, simulations you might want a little (like just writing the current time step; debugOut==3) but when running on a cluster/super computer you don&#39;t want any (debugOut==0)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;debugOut&quot;</span><span class="p">:</span>         <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;All other outputs are NOT outputted if zero. If not zero, then they output data at a frequency determined by their value&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Checkpointing dumps ALL simulation information so that the simulation can be restarted from a fail point. Only use for big, important simulations&quot;</span><span class="p">,</span>
    <span class="s2">&quot;checkpointOut&quot;</span><span class="p">:</span>    <span class="mi">999</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Output the average velocity every 10 iterations&quot;</span><span class="p">,</span>
    <span class="s2">&quot;avVelOut&quot;</span><span class="p">:</span>         <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Contributions to energy&quot;</span><span class="p">,</span>
    <span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Standard deviation of density&quot;</span><span class="p">,</span>
    <span class="s2">&quot;densSDOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Instantaneous flow field --- notice that fields are much large data files than global values&quot;</span><span class="p">,</span>
    <span class="s2">&quot;velOut&quot;</span><span class="p">:</span>           <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Pressure field&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pressureOut&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Histogram of velocities&quot;</span><span class="p">,</span>
    <span class="s2">&quot;histVelOut&quot;</span><span class="p">:</span>       <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Histogram of speed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;histSpeedOut&quot;</span><span class="p">:</span>     <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Histogram of number of particles per cell&quot;</span><span class="p">,</span>
    <span class="s2">&quot;histNOut&quot;</span><span class="p">:</span>         <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Velocity-velocity autocorrelation function --- autocorrelation functions are costly to calculate so beware of including&quot;</span><span class="p">,</span>
    <span class="s2">&quot;velCorrOut&quot;</span><span class="p">:</span>       <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Density-density autocorrelation function&quot;</span><span class="p">,</span>
    <span class="s2">&quot;densCorrOut&quot;</span><span class="p">:</span>      <span class="mi">100</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="running">
<h3>Running<a class="headerlink" href="#running" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">code</span><span class="o">-</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">-</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="mi">01</span><span class="n">_FirstSimulation_PassiveIsotropic2D</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">&lt;</span><span class="n">output</span><span class="o">-</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="understanding-the-script">
<h3>Understanding the Script<a class="headerlink" href="#understanding-the-script" title="Permalink to this heading">#</a></h3>
<p>In this first script, many options are being included for the purpose of introducing them — in future tutorials and when users create their own scripts, often default values will be used and so the arguments can be left out.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This tutorial goes through this basic input script line-by-line to explain each argument.</p>
</div>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;SIMULATION-SCALE INPUTS&quot;</span><span class="p">,</span>
</pre></div>
</div>
<p>The input arguments must all be contained between curly brackets <code class="docutils literal notranslate"><span class="pre">{}</span></code> — The first line is the opening bracket.
Arguments are given in quotation marks <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>, followed by a colon <code class="docutils literal notranslate"><span class="pre">:</span></code> then the argument and concluded with a comma <code class="docutils literal notranslate"><span class="pre">,</span></code> to indicate that an subsequent argument will follow.
<code class="docutils literal notranslate"><span class="pre">&quot;comment&quot;</span></code> is an example tag, which allows users to comment their input scripts, for their own reference.
If a given argument does not exist then the simulation will exit and give the warning</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">JSON</span> <span class="n">Read</span> <span class="ne">Warning</span><span class="p">:</span> <span class="n">Found</span> <span class="n">unrecognised</span> <span class="n">json</span> <span class="n">tag</span><span class="p">:</span> <span class="n">commental</span><span class="o">.</span> <span class="n">Tag</span> <span class="n">will</span> <span class="n">be</span> <span class="n">ignored</span><span class="o">.</span>
<span class="n">JSON</span> <span class="n">Read</span> <span class="n">Error</span><span class="p">:</span> <span class="n">Errors</span> <span class="n">found</span><span class="o">.</span>
</pre></div>
</div>
<p>Comments can be left using the tags <code class="docutils literal notranslate"><span class="pre">&quot;comment&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;c&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;//&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;#&quot;</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
</pre></div>
</div>
<p>The domain is set to <span class="math notranslate nohighlight">\(30\times30\)</span>.
The dimensionality is determined to be 2D from the length of the domain array.
A 3D simulation of a <span class="math notranslate nohighlight">\(30\times30\times30\)</span> domain would instead set</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
</pre></div>
</div>
<p>A 2D rectangular system of <span class="math notranslate nohighlight">\(30\times120\)</span> domain would instead set</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting the domain for the simulation <strong>does not</strong> set the boundary conditions.
Boundary conditions must be set independently, later in the <code class="docutils literal notranslate"><span class="pre">.json</span></code> file.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">2000</span><span class="p">,</span>
</pre></div>
</div>
<p>The number of simulations steps tells the simulation how many iterations to loop over.
This value should be an integer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;simSteps&quot;</span></code> is in iterations/steps, <strong>not the time in MPCD units</strong> τ (see <a class="reference internal" href="../Main/Background.html#derivedunits"><span class="std std-ref">Derived units</span></a>).</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;warmUp&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>The code can also run for warmup phase (for a number of iterations <code class="docutils literal notranslate"><span class="pre">&quot;warmUp&quot;</span></code>) prior to the productions phase (of <code class="docutils literal notranslate"><span class="pre">&quot;simSteps&quot;</span></code> iterations).
In the warmup phase, the simulation runs but results are not outputted, allowing the simulation to achieve equilibrium or steady state prior to writing data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;dt&quot;</span><span class="p">:</span>               <span class="mf">0.1</span><span class="p">,</span>
</pre></div>
</div>
<p>The streaming time step <code class="docutils literal notranslate"><span class="pre">&quot;dt&quot;</span></code> in MPCD units (see <a class="reference internal" href="../Main/Background.html#derivedunits"><span class="std std-ref">Derived units</span></a>).
Varying the streaming time, will modify the (see <a class="reference internal" href="../Main/Usage.html#chaptervisc"><span class="std std-ref">transport coefficients</span></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;collOp&quot;</span><span class="p">:</span>            <span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>To set the MPCD collision operator (see <a class="reference internal" href="../Main/Usage.html#chaptercollop"><span class="std std-ref">Collision operators</span></a>) one uses the tag <code class="docutils literal notranslate"><span class="pre">&quot;collOp&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;rTech&quot;</span></code> (which are aliases).
By choosing <code class="docutils literal notranslate"><span class="pre">2</span></code> here, the collision operator is being set to the basic Andersen thermostatted operator (see <a class="reference internal" href="../Main/Usage.html#andersen"><span class="std std-ref">Andersen-thermostatted MPCD</span></a>).
Many other options are available, including <a class="reference internal" href="../Main/Usage.html#srd"><span class="std std-ref">SRD</span></a> (<code class="docutils literal notranslate"><span class="pre">&quot;collOp&quot;:</span> <span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>), <a class="reference internal" href="../Main/Usage.html#andersen"><span class="std std-ref">angular-conserving Andersen thermostatted MPCD</span></a> (<code class="docutils literal notranslate"><span class="pre">&quot;collOp&quot;:</span> <span class="pre">3</span></code>) and <a class="reference internal" href="../Main/Usage.html#chaptercollop"><span class="std std-ref">others</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;seed&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>Since the collision operators stochastically exchange properties between particles within the same cell, MPCD relies heavily on generating random numbers.
Setting <code class="docutils literal notranslate"><span class="pre">&quot;seed&quot;:</span> <span class="pre">0</span></code> generates a ‘random’ random seed by combing microseconds from the clock and the process id.
If one wishes to repeat a simulation exactly, they can set random seed by hand.
The seed used by a simulation is written to <code class="docutils literal notranslate"><span class="pre">synopsis.dat</span></code> (see <a class="reference internal" href="../Outputs/Outputs.html#id1"><span class="std std-ref">Outputs</span></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="o">&lt;</span><span class="n">arguments</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>To set the particle properties (see <a class="reference internal" href="../Main/Usage.html#chapterparticles"><span class="std std-ref">Particle properties</span></a>) and initializations (see <a class="reference internal" href="../Main/Usage.html#chapterinit"><span class="std std-ref">Initialization</span></a>), the particles are divided into species.
For multiphase flows (see <a class="reference internal" href="../Main/ExtraOptions.html#chapter10"><span class="std std-ref">Multiphase</span></a>), the simulation can include multiple species, but typically only a single fluid species is required.
Within <code class="docutils literal notranslate"><span class="pre">&quot;species&quot;</span></code>, the particle properties and initializations are specified.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;pop&quot;</span><span class="p">:</span>         <span class="mi">18000</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&quot;pop&quot;</span></code> sets the total number of particles of this species type in the simulation.
Since the simulation volume is <span class="math notranslate nohighlight">\(30\times30\)</span>, this produces a density of <code class="docutils literal notranslate"><span class="pre">20</span></code> particles per cell.
A density of <code class="docutils literal notranslate"><span class="pre">20</span></code> particles per MPCD cell is a standard choice (earlier studies would previously use <code class="docutils literal notranslate"><span class="pre">5</span></code>).
<code class="docutils literal notranslate"><span class="pre">&quot;dens&quot;</span></code> is an alternative to <code class="docutils literal notranslate"><span class="pre">&quot;pop&quot;</span></code> for setting the average cell density (see <a class="reference internal" href="#overrides"><span class="std std-ref">Overrides</span></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;mass&quot;</span><span class="p">:</span>         <span class="mi">1</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>The mass of individual MPCD particles is set by <code class="docutils literal notranslate"><span class="pre">&quot;mass&quot;</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The MPCD particle mass is a <strong>fundamental unit</strong> (see <a class="reference internal" href="../Main/Background.html#set-values"><span class="std std-ref">Fundamental units</span></a>).
Like thermal energy <span class="math notranslate nohighlight">\(k_\text{B}T\)</span> and cell size <span class="math notranslate nohighlight">\(a\)</span>, mass should <em>always</em> be set to unity.
However, to allow <a class="reference internal" href="../Main/ExtraOptions.html#chapter10"><span class="std std-ref">multiphase fluids</span></a> to have different material properties it is technically allowed to vary.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;vDist&quot;</span><span class="p">:</span>        <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>In addition to setting the properties of the species, the initializations are also set here.
MPCD quickly thermalizes and so the choice for the initial velocity distribution should have little consequence.
Typical choices are <code class="docutils literal notranslate"><span class="pre">&quot;vDist&quot;:</span> <span class="pre">0</span></code> for isotropically random and <code class="docutils literal notranslate"><span class="pre">4</span></code> for Gaussian distributions of the components.
Because this is the last argument within this <cite>“species”</cite>, there is no comma at the end of this line.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All of the species arguments given above are the <strong>DEFAULT</strong>; therefore, they are all extraneous and could have been completely left out.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="o">&lt;</span><span class="n">arguments</span> <span class="k">for</span> <span class="n">first</span> <span class="n">BC</span><span class="o">&gt;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="o">&lt;</span><span class="n">arguments</span> <span class="k">for</span> <span class="mi">2</span><span class="n">nd</span> <span class="n">BC</span><span class="o">&gt;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="o">&lt;</span><span class="n">arguments</span> <span class="k">for</span> <span class="mi">3</span><span class="n">rd</span> <span class="n">BC</span><span class="o">&gt;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="o">&lt;</span><span class="n">arguments</span> <span class="k">for</span> <span class="mi">4</span><span class="n">th</span> <span class="n">BC</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>In this example, there are four boundary conditions (BC), each given as an element of the array set by the argument <code class="docutils literal notranslate"><span class="pre">&quot;BC&quot;</span></code>.
Boundary coditions must always be set to contain the domain (though overrides exist for convienence, see <a class="reference internal" href="#overrides"><span class="std std-ref">Overrides</span></a>).
In this case, four periodic boundary conditions (PBC) are set at the edges of the domain.
The first BC is the left-hand PBC.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
    <span class="p">},</span>
</pre></div>
</div>
<p>As described in <a class="reference internal" href="../Main/Usage.html#chapterbc"><span class="std std-ref">Boundary conditions</span></a>, boundaries are composed of (i) <a class="reference internal" href="../Main/Usage.html#subsection-boundarysurfaces"><span class="std std-ref">surfaces</span></a> and (ii) <a class="reference internal" href="../Main/Usage.html#subsection-boundaryrules"><span class="std std-ref">rules</span></a>.
The arguments above set the <a class="reference internal" href="../Main/Usage.html#subsection-boundarysurfaces"><span class="std std-ref">boundary surface</span></a> for a planar surface:</p>
<ul class="simple">
<li><p>No phantom particles are required for PBCs.</p></li>
<li><p>Position vector <code class="docutils literal notranslate"><span class="pre">&quot;Q&quot;</span></code>. Here, the left-hand PBC passes through the origin.</p></li>
<li><p>Inverse of the surface normal <code class="docutils literal notranslate"><span class="pre">&quot;aInv&quot;</span></code>. The inverse is used because it is more convienent for ellipses and similar surfaces, while equivalent to the normal itself for planes and spheres. Here, the left-hand BC has a surface normal pointing in the +x direction. The sign matters since particles on the positive side of a surface are in accessible space, while particles on the negative side will trigger the <a class="reference internal" href="../Main/Usage.html#subsection-boundaryrules"><span class="std std-ref">boundary rules</span></a>.</p></li>
<li><p>Power on the terms in the surface equation <code class="docutils literal notranslate"><span class="pre">&quot;P&quot;</span></code> for the x-, y- and z-components and the constant term. Powers of <code class="docutils literal notranslate"><span class="pre">1</span></code> correspond to a plane, <code class="docutils literal notranslate"><span class="pre">2</span></code> to a sphere or ellipsoid, etc… Here, the planar PBC has powers of <code class="docutils literal notranslate"><span class="pre">1</span></code> on all terms.</p></li>
<li><p>The constant term <code class="docutils literal notranslate"><span class="pre">&quot;R&quot;</span></code>, typically employed for the radius of spheres. Here, it is zero.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">50</span><span class="p">,</span>
        <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
    <span class="p">},</span>
</pre></div>
</div>
<p>As described in <a class="reference internal" href="../Main/Usage.html#subsection-boundaryrules"><span class="std std-ref">Boundary rules</span></a>, when a particle impinges on a boundary surface, a set of rules will be applied to the particle.</p>
<ul class="simple">
<li><p>For PBCs, particle position is shifted in the normal direction as set by <code class="docutils literal notranslate"><span class="pre">&quot;DN&quot;</span></code>. The value should match the system size in the normal direction, which in this case is <code class="docutils literal notranslate"><span class="pre">50</span></code>.</p></li>
<li><p>For PBCs, particle position is <em>not</em> shifted in the tangential direction and so <code class="docutils literal notranslate"><span class="pre">&quot;DT&quot;:</span> <span class="pre">0</span></code>.</p></li>
<li><dl class="simple">
<dt>Similarly, PBCs do not modify particle velocity; therefore, the multiplicative factors on the velocity are set to unity:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;MVN&quot;</span></code> is the multiplicative factor in normal direction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;MVT&quot;</span></code> is the multiplicative factor in tangential direction.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">{</span>
        <span class="s2">&quot;c&quot;</span><span class="p">:</span>            <span class="s2">&quot;Right PBC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">50</span><span class="p">,</span>
        <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;c&quot;</span><span class="p">:</span>            <span class="s2">&quot;Bottom wall&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">50</span><span class="p">,</span>
        <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;c&quot;</span><span class="p">:</span>            <span class="s2">&quot;Top wall&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">50</span><span class="p">,</span>
        <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>The other three BCs are the same but must pass through appropriate points by setting <code class="docutils literal notranslate"><span class="pre">&quot;Q&quot;</span></code> and have surface normals that point in the correct (signed) directions by setting <code class="docutils literal notranslate"><span class="pre">&quot;aInv&quot;</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There exists an <a class="reference internal" href="#overrides"><span class="std std-ref">override</span></a> to conveniently set:</p>
<ul class="simple">
<li><dl class="simple">
<dt>PBCs</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;domainWalls&quot;:1</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>impermeable, no-slip planar walls</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;domainWalls&quot;:0</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>which match the simulation domain size <code class="docutils literal notranslate"><span class="pre">&quot;domain&quot;</span></code>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.json</span></code> input file also sets the outputs.
There are many optional outputs things that can be outputted but one should never output all possible outputs.
However, one option that should always be outputted is the synopsis file.
This little text file reports all the inputs the code has used, as well as summary information about the simulation.
The <code class="docutils literal notranslate"><span class="pre">synopsis.dat</span></code> file allows users to directly check if the simulation is really what was intended.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;debugOut&quot;</span><span class="p">:</span>         <span class="mi">3</span><span class="p">,</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&quot;debugOut&quot;</span></code> specifies the verbosity with which information is writen to the terminal.
When running small local simulations, one might want a little (such as the current time step; <code class="docutils literal notranslate"><span class="pre">''debugOut&quot;:</span> <span class="pre">3</span></code>) but when generating data for long simulations or running on a cluster, one might not want any (<code class="docutils literal notranslate"><span class="pre">''debugOut&quot;:</span> <span class="pre">0</span></code>)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;checkpointOut&quot;</span><span class="p">:</span>    <span class="mi">999</span><span class="p">,</span>
</pre></div>
</div>
<p>All outputting up to this point, use flags, while all other outputs are <strong>not</strong> outputted if zero and outputted at a frequency determined by their value numerical value.
For example, the simulation is <a class="reference internal" href="../Outputs/Outputs.html#checkpointing"><span class="std std-ref">checkpointed</span></a> every 999 iterations/steps.
These are given in iterations, not in MPCD time units.</p>
<p>Checkpointing dumps <em>all</em> simulation information so that the simulation can be restarted from a fail point.
Checkpointing should be used sparingly since writing this data takes computational time and the resulting checkpoint files are large.
This is only recommended for simulations that will take substantially longer than a week.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;avVelOut&quot;</span><span class="p">:</span>         <span class="mi">10</span><span class="p">,</span>
<span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
<span class="s2">&quot;densSDOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
</pre></div>
</div>
<p>These three arguments output the average velocity <code class="docutils literal notranslate"><span class="pre">&quot;avVelOut&quot;</span></code>, contributions to energy <code class="docutils literal notranslate"><span class="pre">&quot;energyOut&quot;</span></code> and Standard deviation of density <code class="docutils literal notranslate"><span class="pre">&quot;densSDOut&quot;</span></code> every 10 iterations”.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;velOut&quot;</span><span class="p">:</span>          <span class="mi">50</span><span class="p">,</span>
<span class="s2">&quot;pressureOut&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>These two arguments output two instantaneous fields: the instantaneous velocity field <code class="docutils literal notranslate"><span class="pre">&quot;velOut&quot;</span></code> and the pressure field <code class="docutils literal notranslate"><span class="pre">&quot;pressureOut&quot;</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Fields are much larger data files than global values and so one should choose the output rate appropriately.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;histVelOut&quot;</span><span class="p">:</span>       <span class="mi">100</span><span class="p">,</span>
<span class="s2">&quot;histSpeedOut&quot;</span><span class="p">:</span>     <span class="mi">100</span><span class="p">,</span>
<span class="s2">&quot;histNOut&quot;</span><span class="p">:</span>         <span class="mi">100</span><span class="p">,</span>
</pre></div>
</div>
<p>Histograms can be outputted as well.
Here, the velocity <code class="docutils literal notranslate"><span class="pre">&quot;histVelOut&quot;</span></code>, speed <code class="docutils literal notranslate"><span class="pre">&quot;histSpeedOut&quot;</span></code> and density <code class="docutils literal notranslate"><span class="pre">&quot;histNOut&quot;</span></code> are output every 100 time steps.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The distribution of instantaneous values for the 100th step are outputted (non-cumulative).
Therefore, the instantaneous range will vary slightly between output times and the ranges must be merged to produce a time averaged distribution.
One example of doing this for scalar values is available in <code class="docutils literal notranslate"><span class="pre">/analysisScripts/probDistScalar.py</span></code> and for vector values in <code class="docutils literal notranslate"><span class="pre">/analysisScripts/probDistVector.py</span></code></p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;velCorrOut&quot;</span><span class="p">:</span>       <span class="mi">100</span><span class="p">,</span>
<span class="s2">&quot;densCorrOut&quot;</span><span class="p">:</span>      <span class="mi">100</span>
</pre></div>
</div>
<p>A variety of <strong>spatial</strong> autocorrelation functions can be out putted. Here, the velocity-velocity and density-densioty spatial autocorrelation functions are output every 100 time steps.
Autocorrelation functions are relatively costly to calculate so beware of outputting these overly frequently.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Spatial correlation functions are build into the code but temporal correlation functions are not, because the code does not preserve past states.
Users must calculate temporal correlation functions from outputted data using their own analysis routines.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>Finally, the closing bracket for the arguments must end the file.
Also note there should be no comma after the final argument (in this example <code class="docutils literal notranslate"><span class="pre">&quot;densCorrOut&quot;:</span> <span class="pre">100</span></code>)</p>
</section>
</section>
<section id="overrides">
<span id="id2"></span><h2>Overrides<a class="headerlink" href="#overrides" title="Permalink to this heading">#</a></h2>
<p>This tutorial repeats the same simulation as <a class="reference internal" href="#isoptropic"><span class="std std-ref">First simulation</span></a> <strong>but</strong> uses a much cleaner input file, that utilizes <em>defaults</em> and <em>overrides</em> for clarity.
Users’ actual input files are expected to more frequently look like the file used here.</p>
<p>This tutorial is based on the input file found in <code class="docutils literal notranslate"><span class="pre">MPCD/SampleInputs/02_cleanerFirstSimulation/input.json</span></code>.</p>
<section id="id3">
<h3>Input File<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;SIMULATION-SCALE INPUTS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">2000</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;FLUID PARTICLE SPECIES INPUTS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;species&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;&#39;&#39;dens&#39;&#39; overides the &#39;&#39;pop&#39;&#39; argument to set the desired number density&quot;</span><span class="p">,</span>
            <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;BOUNDARY CONDITION INPUTS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;&#39;&#39;domainWalls&#39;&#39; overrides the &#39;&#39;BC&#39;&#39; to set periodic boundary conditions at all edges of the system (additional BCs can be added after)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domainWalls&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;OUTPUTS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;checkpointOut&quot;</span><span class="p">:</span>    <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;checkpointTimerOut&quot;</span><span class="p">:</span>    <span class="mf">0.0056</span><span class="p">,</span>
    <span class="s2">&quot;avVelOut&quot;</span><span class="p">:</span>         <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;densSDOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;histSpeedOut&quot;</span><span class="p">:</span>     <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;histNOut&quot;</span><span class="p">:</span>         <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;velCorrOut&quot;</span><span class="p">:</span>       <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;densCorrOut&quot;</span><span class="p">:</span>      <span class="mi">100</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id4">
<h3>Running<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">code</span><span class="o">-</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">-</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="mi">02</span><span class="n">_cleanerFirstSimulation</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">&lt;</span><span class="n">output</span><span class="o">-</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="id5">
<h3>Understanding the Script<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">2000</span><span class="p">,</span>
</pre></div>
</div>
<p>The input arguments are contained between curly brackets <code class="docutils literal notranslate"><span class="pre">{}</span></code> — The first line is the opening bracket.
The system wide inputs set here are <code class="docutils literal notranslate"><span class="pre">&quot;domain&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;simSteps&quot;</span></code>.
All other arguments take their default values (an isotropic fluid using the :ref:<code class="docutils literal notranslate"><span class="pre">basic</span> <span class="pre">Andersen-thermostatted</span> <span class="pre">collision</span> <span class="pre">operator</span> <span class="pre">&lt;Andersen&gt;</span></code>).
In fact, even the <code class="docutils literal notranslate"><span class="pre">&quot;domain&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;simSteps&quot;</span></code> are set to their default values but users are always expected to run larger and longer simulations when doing research.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;&#39;&#39;dens&#39;&#39; overides the &#39;&#39;pop&#39;&#39; argument to set the desired number density&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Next are the fluid particle properties.
This is a single species with all default values.
Except the <code class="docutils literal notranslate"><span class="pre">&quot;dens&quot;</span></code> <strong>override</strong> argument is used to set the average number of MPCD particles per accessible MPCD cell rather than the total population.
Here the number density is set to <code class="docutils literal notranslate"><span class="pre">20</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="s2">&quot;domainWalls&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Next the boundary conditions are set.
In this example, simple periodic boundary conditions are required and therefore an override can be employed.
<code class="docutils literal notranslate"><span class="pre">&quot;domainWalls&quot;:</span> <span class="pre">1</span></code> creates four periodic boundaries around the domain in 2D and six in 3D.
If one wishes to run a simulation inside impermeable/no-slip walls, then <code class="docutils literal notranslate"><span class="pre">&quot;domainWalls&quot;:</span> <span class="pre">0</span></code> can override the boundaries.
All other boundaries/geometries must be created boundary-surface-by-boundary-surface.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Additional boundaries can be added <strong>after</strong> the <code class="docutils literal notranslate"><span class="pre">&quot;domainWalls&quot;</span></code> override.
In this way, solid obstacles or mobile colloids can be suspended within the domain with PBCs or impermeable/no-slip BCs.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;checkpointOut&quot;</span><span class="p">:</span>    <span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;checkpointTimerOut&quot;</span><span class="p">:</span>    <span class="mf">0.0056</span><span class="p">,</span>
</pre></div>
</div>
<p>Rather than setting the checkpointing to a number of iterations (here set to every time step), <code class="docutils literal notranslate"><span class="pre">&quot;checkpointTimerOut&quot;</span></code> overwrites it to output based on a timer, outputting with a period of the value in hours.
Here <code class="docutils literal notranslate"><span class="pre">0.0056</span></code> hours is about every 20 seconds.
This is an extremely small value that should never be used in practice.
Rather checkpointing should be used for long simulations that last for longer than a week in order to backup the simulation and offer a point for restarting it (so <code class="docutils literal notranslate"><span class="pre">&quot;checkpointTimerOut&quot;</span></code> should be comparable to <code class="docutils literal notranslate"><span class="pre">100</span></code>.)</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;checkpointOut&quot;</span></code> must be non-zero in the input script and then <code class="docutils literal notranslate"><span class="pre">&quot;checkpointTimerOut&quot;</span></code> must override its value.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="s2">&quot;avVelOut&quot;</span><span class="p">:</span>         <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;densSDOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;histSpeedOut&quot;</span><span class="p">:</span>     <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;histNOut&quot;</span><span class="p">:</span>         <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;velCorrOut&quot;</span><span class="p">:</span>       <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;densCorrOut&quot;</span><span class="p">:</span>      <span class="mi">100</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally the output is specified.
The default output is <code class="docutils literal notranslate"><span class="pre">0</span></code> (meaning that the quantity is not outputted) for all outputs, except <code class="docutils literal notranslate"><span class="pre">&quot;synopsisOut&quot;</span></code>, which should always be outputted.</p>
</section>
</section>
<section id="channel-flow">
<h2>Channel flow<a class="headerlink" href="#channel-flow" title="Permalink to this heading">#</a></h2>
<section id="channelflow">
<span id="id6"></span><h3>Channel Flow<a class="headerlink" href="#channelflow" title="Permalink to this heading">#</a></h3>
<p>This tutorial will show to generate a flow in a 2D channel with a pressure gradient driven by gravity. No-slip boundary conditions on the bottom and top walls, periodic boundary conditions on the ends.
This tutorial is based on the input file found in MPCD/SampleInputs/ChannelFlow/input.json</p>
</section>
<section id="id7">
<h3>Input File<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Rectangular geometry&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="s2">&quot;warmUp&quot;</span><span class="p">:</span>           <span class="mi">500</span><span class="p">,</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">500</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;collOp&quot;</span><span class="p">:</span>           <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Gravity-generated pressure gradient&quot;</span><span class="p">,</span>
    <span class="s2">&quot;grav&quot;</span><span class="p">:</span>             <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;species&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;debugOut&quot;</span><span class="p">:</span>         <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;pressureOut&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;avVelOut&quot;</span><span class="p">:</span>         <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;checkpointOut&quot;</span><span class="p">:</span>    <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;BCs are two periodic boundary conditions (PBC) and two impermeable, no-slip walls&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BC&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Left PBC&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">150</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Right PBC&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">150</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Bottom wall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Top wall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id8">
<h3>Understanding the Script<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Rectangular geometry&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="s2">&quot;warmUp&quot;</span><span class="p">:</span>           <span class="mi">500</span><span class="p">,</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">500</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;collOp&quot;</span><span class="p">:</span>           <span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>We define the system size (150 by 30 in MPCd simulations), and we define how long the system takes to initialize and for how long than the system will actually run and output.  We also define the collision operator for the MPCD fluid.In this case, we model an Isotropic fluid.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Gravity-generated pressure gradient&quot;</span><span class="p">,</span>
<span class="s2">&quot;grav&quot;</span><span class="p">:</span>             <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</pre></div>
</div>
<p>We say that every box experiences a constant force along the x direction, which mimics a body force like gravity. This indirectly induces a pressure gradient.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span>
      <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>We say that every MPCD box should be initialized with 20 MPC particles.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;debugOut&quot;</span><span class="p">:</span>         <span class="mi">3</span><span class="p">,</span>
<span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">20</span><span class="p">,</span>
<span class="s2">&quot;pressureOut&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
<span class="s2">&quot;avVelOut&quot;</span><span class="p">:</span>         <span class="mi">10</span><span class="p">,</span>
<span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
<span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;checkpointOut&quot;</span><span class="p">:</span>    <span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>We now define what things we want to write out during the simulation (see output for details). We use debugOut level 3. We write out the flow field every 20 timesteps, and the average velocity and energy of the system every 10 minutues.
We don’t write out the pressure, but that can be turned on. We also include a synopsis file, but don’t do checkpoint checks.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;BCs are two periodic boundary conditions (PBC) and two impermeable, no-slip walls&quot;</span><span class="p">,</span>
<span class="s2">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
</pre></div>
</div>
<p>Now we define BC. (See Boundary Conditions for more details) Remember, that this needs to be between []. We will define 4 different boundaries, corresponding to the four different borders of our simulation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Left PBC&quot;</span><span class="p">,</span>
    <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">150</span><span class="p">,</span>
    <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
<span class="p">},</span>
</pre></div>
</div>
<p>The first boundary on the left side. We have PBC, and hence we don’t have phantom particles. We need to define the surface parameters Q, aInv, P and R for this boundary (See boundary conditions for more details).
We define its position as intersecting at the [0,0,0] point and for a plane yz-plane, we define the normal aInv=[1, 0, 0]. In addition, to construct a plane, we set p=[1,1,1,1].
Lastly, because this is a plane, our radius is set to R=0.</p>
<p>Particles passing through this interface need to be displaced by 150 (the other side of the simulation box). Lastly, when touching the interface, the velocities should not be changed (MVN=MVT=1).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Right PBC&quot;</span><span class="p">,</span>
    <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">150</span><span class="p">,</span>
    <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
<span class="p">},</span>
</pre></div>
</div>
<p>Similar to the Left PBC, but we realize that the normal aINV is reversed, and the position is on the other side of the simulation box Q=[150, 0, 0].</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Bottom wall&quot;</span><span class="p">,</span>
    <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span>
<span class="p">},</span>
</pre></div>
</div>
<p>Now we define the bottom walls. We need to define ghost/phantom particles, as the fluid cell can intersect with the hard interface, reduing the effect cell population.
Position of this plain intersects with Q=[0, 0, 0], and its normal is aInv=[0,1,0]. The P and R are the same (as we again define a plane).
Now, when particles touch the wall they should not displace and DN is set to 0.
We want to have full slip, so the velocity components (normal and tangent) need to be reversed when particles touch the walls (MVN=MVT=-1).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Top wall&quot;</span><span class="p">,</span>
    <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Same as top wall, but the aInv is reversed and its position is placed differently.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">]</span>
</pre></div>
</div>
<p>We close the BC decleration.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>The end of the input file</p>
</section>
<section id="id9">
<h3>Running<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="n">ChannelFlow</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>In the corresponding avVel.dat, you should now see how the velocity in the x direction is steadily increasing, the y velocity fluctuates around zero, and the z velocity is actually zero.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">For</span> <span class="n">the</span> <span class="n">Polymer</span> <span class="n">Physics</span> <span class="n">Research</span> <span class="n">Group</span> <span class="o">***</span>
<span class="o">********</span> <span class="n">At</span> <span class="n">the</span> <span class="n">University</span> <span class="n">of</span> <span class="n">Ottawa</span> <span class="o">*********</span>

<span class="o">**********************************************</span>
<span class="o">************</span> <span class="n">Code</span> <span class="n">begun</span> <span class="n">Oct</span><span class="o">.</span> <span class="mi">2008</span> <span class="o">************</span>
<span class="o">**********************************************</span>

<span class="n">t</span>        <span class="n">VcmX</span>           <span class="n">VcmY</span>            <span class="n">VcmZ</span>            <span class="n">KBT</span>             <span class="n">dVXX</span>            <span class="n">dVXY</span>            <span class="n">dVXZ</span>            <span class="n">dVYX</span>            <span class="n">dVYY</span>            <span class="n">dVYZ</span>            <span class="n">dVZX</span>            <span class="n">dVZY</span>            <span class="n">dVZZ</span>
<span class="mf">0.00000e+00</span>     <span class="mf">3.45052e-01</span>     <span class="mf">6.58234e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.06250e+00</span>    <span class="o">-</span><span class="mf">1.36458e-03</span>    <span class="o">-</span><span class="mf">1.05097e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">2.08302e-04</span>    <span class="o">-</span><span class="mf">4.56426e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.00000e+00</span>     <span class="mf">3.50801e-01</span>     <span class="mf">6.23010e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.07224e+00</span>    <span class="o">-</span><span class="mf">2.09023e-03</span>    <span class="o">-</span><span class="mf">6.09935e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.00165e-04</span>    <span class="o">-</span><span class="mf">6.01067e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.00000e+00</span>     <span class="mf">3.58123e-01</span>     <span class="mf">7.84703e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.06892e+00</span>    <span class="o">-</span><span class="mf">9.59730e-04</span>    <span class="o">-</span><span class="mf">1.14724e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">4.05406e-04</span>    <span class="o">-</span><span class="mf">9.35703e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.00000e+00</span>     <span class="mf">3.61650e-01</span>     <span class="mf">5.74061e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.07228e+00</span>    <span class="o">-</span><span class="mf">1.77202e-03</span>    <span class="o">-</span><span class="mf">6.59328e-05</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">1.45274e-04</span>    <span class="o">-</span><span class="mf">4.18955e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.00000e+00</span>     <span class="mf">3.64406e-01</span>     <span class="mf">4.03414e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.07902e+00</span>    <span class="o">-</span><span class="mf">1.26291e-03</span>    <span class="o">-</span><span class="mf">9.22894e-05</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">4.18639e-04</span>    <span class="o">-</span><span class="mf">5.48575e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">5.00000e+00</span>     <span class="mf">3.69803e-01</span>     <span class="mf">2.79431e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.07395e+00</span>    <span class="o">-</span><span class="mf">1.42730e-03</span>    <span class="o">-</span><span class="mf">3.70481e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">7.55855e-04</span>     <span class="mf">2.63838e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">6.00000e+00</span>     <span class="mf">3.75238e-01</span>     <span class="mf">2.96236e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.08079e+00</span>    <span class="o">-</span><span class="mf">1.45695e-03</span>    <span class="o">-</span><span class="mf">1.83501e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">3.06386e-04</span>    <span class="o">-</span><span class="mf">2.01063e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">7.00000e+00</span>     <span class="mf">3.78821e-01</span>     <span class="mf">2.94415e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.08732e+00</span>    <span class="o">-</span><span class="mf">1.05142e-03</span>     <span class="mf">9.88574e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">2.51660e-04</span>    <span class="o">-</span><span class="mf">9.77584e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">8.00000e+00</span>     <span class="mf">3.84917e-01</span>     <span class="mf">9.50202e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.08471e+00</span>    <span class="o">-</span><span class="mf">1.54482e-03</span>     <span class="mf">3.56912e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.67420e-04</span>     <span class="mf">7.57103e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">9.00000e+00</span>     <span class="mf">3.89152e-01</span>     <span class="mf">2.32318e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.08486e+00</span>    <span class="o">-</span><span class="mf">8.95644e-04</span>    <span class="o">-</span><span class="mf">1.13704e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">5.50255e-05</span>    <span class="o">-</span><span class="mf">6.15770e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.00000e+01</span>     <span class="mf">3.93201e-01</span>     <span class="mf">2.29169e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.09030e+00</span>    <span class="o">-</span><span class="mf">6.43542e-04</span>    <span class="o">-</span><span class="mf">4.24444e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">9.03793e-05</span>     <span class="mf">3.57824e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.10000e+01</span>     <span class="mf">3.94978e-01</span>     <span class="mf">1.55992e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.09117e+00</span>    <span class="o">-</span><span class="mf">8.87784e-04</span>    <span class="o">-</span><span class="mf">1.78963e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">3.84145e-04</span>    <span class="o">-</span><span class="mf">3.38673e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.20000e+01</span>     <span class="mf">4.01249e-01</span>     <span class="mf">2.80295e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.08548e+00</span>    <span class="o">-</span><span class="mf">1.09625e-03</span>     <span class="mf">3.27938e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">4.54421e-04</span>     <span class="mf">4.87806e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.30000e+01</span>     <span class="mf">4.05286e-01</span>     <span class="mf">1.89601e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.09531e+00</span>    <span class="o">-</span><span class="mf">5.48964e-04</span>     <span class="mf">1.05430e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">6.45156e-04</span>     <span class="mf">3.93277e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.40000e+01</span>     <span class="mf">4.09654e-01</span>    <span class="o">-</span><span class="mf">7.50545e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.08849e+00</span>    <span class="o">-</span><span class="mf">1.11103e-03</span>    <span class="o">-</span><span class="mf">5.51446e-05</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">1.43860e-04</span>     <span class="mf">1.35607e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.50000e+01</span>     <span class="mf">4.17369e-01</span>     <span class="mf">3.10384e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.10007e+00</span>    <span class="o">-</span><span class="mf">1.29882e-03</span>    <span class="o">-</span><span class="mf">2.52358e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">7.78732e-05</span>    <span class="o">-</span><span class="mf">1.29354e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.60000e+01</span>     <span class="mf">4.20780e-01</span>     <span class="mf">4.13124e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.09703e+00</span>    <span class="o">-</span><span class="mf">1.30782e-03</span>    <span class="o">-</span><span class="mf">6.52589e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">2.80151e-04</span>    <span class="o">-</span><span class="mf">6.96605e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.70000e+01</span>     <span class="mf">4.27041e-01</span>     <span class="mf">4.26768e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.10565e+00</span>    <span class="o">-</span><span class="mf">1.21964e-03</span>    <span class="o">-</span><span class="mf">3.34156e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">4.56698e-04</span>     <span class="mf">9.94585e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.80000e+01</span>     <span class="mf">4.31088e-01</span>     <span class="mf">5.74989e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.10576e+00</span>    <span class="o">-</span><span class="mf">1.87260e-03</span>    <span class="o">-</span><span class="mf">5.52449e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">2.36001e-04</span>    <span class="o">-</span><span class="mf">7.48178e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.90000e+01</span>     <span class="mf">4.35738e-01</span>     <span class="mf">4.21765e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11031e+00</span>    <span class="o">-</span><span class="mf">1.78792e-03</span>     <span class="mf">2.14343e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">5.56329e-05</span>     <span class="mf">1.08383e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.00000e+01</span>     <span class="mf">4.41161e-01</span>     <span class="mf">1.74172e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11284e+00</span>    <span class="o">-</span><span class="mf">1.81910e-03</span>     <span class="mf">1.41829e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.26697e-04</span>     <span class="mf">7.40635e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.10000e+01</span>     <span class="mf">4.42280e-01</span>    <span class="o">-</span><span class="mf">2.21483e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11302e+00</span>    <span class="o">-</span><span class="mf">1.32765e-03</span>     <span class="mf">1.31480e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">6.37553e-04</span>    <span class="o">-</span><span class="mf">2.38006e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.20000e+01</span>     <span class="mf">4.49555e-01</span>    <span class="o">-</span><span class="mf">1.43127e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11267e+00</span>    <span class="o">-</span><span class="mf">1.65318e-03</span>     <span class="mf">1.10167e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">5.49391e-04</span>    <span class="o">-</span><span class="mf">1.41895e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.30000e+01</span>     <span class="mf">4.50628e-01</span>    <span class="o">-</span><span class="mf">2.74851e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11249e+00</span>    <span class="o">-</span><span class="mf">1.24766e-03</span>    <span class="o">-</span><span class="mf">3.92778e-05</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">9.47222e-06</span>    <span class="o">-</span><span class="mf">2.84050e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.40000e+01</span>     <span class="mf">4.53632e-01</span>    <span class="o">-</span><span class="mf">1.77157e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11439e+00</span>    <span class="o">-</span><span class="mf">1.63530e-03</span>     <span class="mf">1.59648e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">2.99482e-04</span>    <span class="o">-</span><span class="mf">4.95892e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.50000e+01</span>     <span class="mf">4.58302e-01</span>    <span class="o">-</span><span class="mf">5.70376e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11430e+00</span>    <span class="o">-</span><span class="mf">1.20376e-03</span>     <span class="mf">1.72172e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.87628e-04</span>     <span class="mf">7.19723e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.60000e+01</span>     <span class="mf">4.61396e-01</span>    <span class="o">-</span><span class="mf">4.98616e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.12231e+00</span>    <span class="o">-</span><span class="mf">1.16975e-03</span>    <span class="o">-</span><span class="mf">1.59873e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">2.64437e-04</span>    <span class="o">-</span><span class="mf">9.45790e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.70000e+01</span>     <span class="mf">4.64587e-01</span>    <span class="o">-</span><span class="mf">5.77189e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.12509e+00</span>    <span class="o">-</span><span class="mf">1.56520e-03</span>     <span class="mf">1.95114e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">5.59956e-04</span>    <span class="o">-</span><span class="mf">3.00970e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.80000e+01</span>     <span class="mf">4.69087e-01</span>    <span class="o">-</span><span class="mf">4.41537e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.13043e+00</span>    <span class="o">-</span><span class="mf">2.29317e-03</span>    <span class="o">-</span><span class="mf">2.00406e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.44941e-04</span>     <span class="mf">8.39970e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.90000e+01</span>     <span class="mf">4.74573e-01</span>    <span class="o">-</span><span class="mf">2.69217e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.12628e+00</span>    <span class="o">-</span><span class="mf">1.79209e-03</span>     <span class="mf">4.42318e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">1.18112e-04</span>     <span class="mf">3.04627e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.00000e+01</span>     <span class="mf">4.77925e-01</span>    <span class="o">-</span><span class="mf">4.23853e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.12965e+00</span>    <span class="o">-</span><span class="mf">1.45111e-03</span>     <span class="mf">9.28562e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.72270e-06</span>    <span class="o">-</span><span class="mf">6.38259e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.10000e+01</span>     <span class="mf">4.79560e-01</span>    <span class="o">-</span><span class="mf">3.47639e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.13145e+00</span>    <span class="o">-</span><span class="mf">1.37447e-03</span>     <span class="mf">9.14254e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">8.84702e-05</span>    <span class="o">-</span><span class="mf">4.45805e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.20000e+01</span>     <span class="mf">4.84372e-01</span>    <span class="o">-</span><span class="mf">5.47304e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.13747e+00</span>    <span class="o">-</span><span class="mf">1.96381e-03</span>     <span class="mf">7.72492e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">5.99433e-04</span>    <span class="o">-</span><span class="mf">3.39571e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.30000e+01</span>     <span class="mf">4.86674e-01</span>    <span class="o">-</span><span class="mf">3.49428e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.13735e+00</span>    <span class="o">-</span><span class="mf">1.75572e-03</span>     <span class="mf">1.45743e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">3.37711e-04</span>     <span class="mf">2.79032e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.40000e+01</span>     <span class="mf">4.89764e-01</span>    <span class="o">-</span><span class="mf">4.42566e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.13214e+00</span>    <span class="o">-</span><span class="mf">1.82282e-03</span>     <span class="mf">2.39112e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">4.84081e-04</span>    <span class="o">-</span><span class="mf">9.86585e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.50000e+01</span>     <span class="mf">4.93684e-01</span>    <span class="o">-</span><span class="mf">3.45316e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.13607e+00</span>    <span class="o">-</span><span class="mf">1.31257e-03</span>     <span class="mf">4.14919e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">3.79466e-04</span>    <span class="o">-</span><span class="mf">3.02127e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.60000e+01</span>     <span class="mf">4.98918e-01</span>    <span class="o">-</span><span class="mf">3.24449e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.14174e+00</span>    <span class="o">-</span><span class="mf">1.68669e-03</span>    <span class="o">-</span><span class="mf">6.06406e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">2.23057e-04</span>     <span class="mf">1.53655e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.70000e+01</span>     <span class="mf">5.03730e-01</span>    <span class="o">-</span><span class="mf">3.91437e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.14826e+00</span>    <span class="o">-</span><span class="mf">1.55978e-03</span>     <span class="mf">2.02801e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">4.54704e-04</span>     <span class="mf">7.77137e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.80000e+01</span>     <span class="mf">5.05736e-01</span>    <span class="o">-</span><span class="mf">1.28787e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.15212e+00</span>    <span class="o">-</span><span class="mf">1.00495e-03</span>    <span class="o">-</span><span class="mf">4.49476e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">6.18846e-05</span>     <span class="mf">2.28526e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.90000e+01</span>     <span class="mf">5.09232e-01</span>    <span class="o">-</span><span class="mf">1.25548e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.14257e+00</span>    <span class="o">-</span><span class="mf">2.55529e-03</span>     <span class="mf">1.39230e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.50541e-04</span>     <span class="mf">2.21952e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.00000e+01</span>     <span class="mf">5.13641e-01</span>    <span class="o">-</span><span class="mf">2.60856e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.14785e+00</span>    <span class="o">-</span><span class="mf">2.13809e-03</span>     <span class="mf">9.84253e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">4.82504e-04</span>    <span class="o">-</span><span class="mf">4.77825e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.10000e+01</span>     <span class="mf">5.16390e-01</span>    <span class="o">-</span><span class="mf">3.68310e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.14975e+00</span>    <span class="o">-</span><span class="mf">2.36575e-03</span>     <span class="mf">5.30616e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">5.78192e-04</span>     <span class="mf">3.34780e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.20000e+01</span>     <span class="mf">5.20077e-01</span>     <span class="mf">8.12596e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.15349e+00</span>    <span class="o">-</span><span class="mf">1.62682e-03</span>     <span class="mf">4.44550e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.29634e-04</span>    <span class="o">-</span><span class="mf">1.85622e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.30000e+01</span>     <span class="mf">5.22265e-01</span>     <span class="mf">7.69079e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.15929e+00</span>    <span class="o">-</span><span class="mf">2.23385e-03</span>     <span class="mf">2.27985e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">3.18873e-04</span>     <span class="mf">6.56014e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.40000e+01</span>     <span class="mf">5.23322e-01</span>    <span class="o">-</span><span class="mf">9.10584e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.15748e+00</span>    <span class="o">-</span><span class="mf">1.69311e-03</span>     <span class="mf">1.13959e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">5.14337e-04</span>     <span class="mf">3.15428e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.50000e+01</span>     <span class="mf">5.29615e-01</span>     <span class="mf">8.41938e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.16039e+00</span>    <span class="o">-</span><span class="mf">1.89173e-03</span>     <span class="mf">1.49322e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">3.85331e-04</span>    <span class="o">-</span><span class="mf">6.92088e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.60000e+01</span>     <span class="mf">5.31556e-01</span>     <span class="mf">2.75160e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.16471e+00</span>    <span class="o">-</span><span class="mf">1.43088e-03</span>    <span class="o">-</span><span class="mf">9.70971e-05</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">2.91346e-04</span>     <span class="mf">3.56101e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.70000e+01</span>     <span class="mf">5.34593e-01</span>     <span class="mf">2.12590e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.16822e+00</span>    <span class="o">-</span><span class="mf">1.23542e-03</span>    <span class="o">-</span><span class="mf">2.41419e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">3.24688e-04</span>    <span class="o">-</span><span class="mf">1.93997e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.80000e+01</span>     <span class="mf">5.38447e-01</span>    <span class="o">-</span><span class="mf">5.89117e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.16833e+00</span>    <span class="o">-</span><span class="mf">2.03582e-03</span>    <span class="o">-</span><span class="mf">2.16861e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">1.06117e-04</span>    <span class="o">-</span><span class="mf">9.34396e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.90000e+01</span>     <span class="mf">5.36628e-01</span>     <span class="mf">6.32695e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.17077e+00</span>    <span class="o">-</span><span class="mf">1.50439e-03</span>     <span class="mf">9.79270e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">5.25894e-04</span>    <span class="o">-</span><span class="mf">4.26488e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">5.00000e+01</span>     <span class="mf">5.39846e-01</span>     <span class="mf">1.96692e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.16781e+00</span>    <span class="o">-</span><span class="mf">1.13051e-03</span>     <span class="mf">2.57739e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.90012e-05</span>     <span class="mf">3.31045e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
</pre></div>
</div>
</section>
</section>
<section id="colloid">
<span id="id10"></span><h2>Colloid<a class="headerlink" href="#colloid" title="Permalink to this heading">#</a></h2>
<section id="diffusing-colloid">
<h3>Diffusing Colloid<a class="headerlink" href="#diffusing-colloid" title="Permalink to this heading">#</a></h3>
<p>This tutorial will demonstrate how to run a simple colloid in an isotropic fluid, in 2D geometries.
The simulation will be run in a small <span class="math notranslate nohighlight">\(20\times20\)</span> domain (for speed), with a colloid of radius <cite>3</cite>, all within periodic boundary conditions.
Colloids in MPCD are simulated through the use of a motile boundary.</p>
<p>This tutorial is based on the input file found in MPCD/SampleInputs/colloid/input.json</p>
</section>
<section id="id11">
<h3>Input File<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">50000</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;collOp&quot;</span><span class="p">:</span>           <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;species&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;The dens override will take the smaller volume fraction for the fluid into account&quot;</span><span class="p">,</span>
            <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;debugOut&quot;</span><span class="p">:</span>         <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">&quot;solidTrajOut&quot;</span><span class="p">:</span>     <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Periodic boundary conditions on the domain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domainWalls&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;BC&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;The spherical colloid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Colloid radius&quot;</span><span class="p">,</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;The colloid should be mobile, i.e. free to be displaced&quot;</span><span class="p">,</span>
            <span class="s2">&quot;dsplc&quot;</span><span class="p">:</span>        <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;mass&quot;</span><span class="p">:</span>         <span class="mi">565</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id12">
<h3>Understanding the Script<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">50000</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;collOp&quot;</span><span class="p">:</span>           <span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>We define a 2D system with a simulation domain of 20 by 20 MPCD units.
We further tell the simulation to run for 50000 timesteps, and use the isotropic Andersen collision operator.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;The dens override will take the smaller volume fraction for the fluid into account&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>We declare one species of fluid, and specify a <code class="docutils literal notranslate"><span class="pre">&quot;dens&quot;</span></code> override of 20.</p>
<p>If instead you wished to use the <code class="docutils literal notranslate"><span class="pre">&quot;pop&quot;</span></code> keyword, your population would need to take into account the volume of the colloid manually.
ie,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \mathrm{pop} &amp;= \rho V_\mathrm{domain}
    \\
    &amp;= \rho \times \left( \ell_x \times \ell_y - V_\mathrm {colloid} \right)
    \\
    &amp;= \rho \times \left( 20 \times 20 - \pi \times 3^2 \right)
\end{align*}\end{split}\]</div>
</div>
<p>However, the <code class="docutils literal notranslate"><span class="pre">&quot;dens&quot;</span></code> override will take this smaller volume fraction into account by using a Monte-Carlo integrator.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As the accessible volume is computed by a Monte-Carlo integrator, which is a stochastic method, the volume fraction will not exactly match the analytical <span class="math notranslate nohighlight">\(V_\mathrm{domain}\)</span>.
It will, however, be close enough for regular usage.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;debugOut&quot;</span><span class="p">:</span>         <span class="mi">3</span><span class="p">,</span>
<span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>           <span class="mi">1000</span><span class="p">,</span>
<span class="s2">&quot;solidTrajOut&quot;</span><span class="p">:</span>     <span class="mi">1000</span><span class="p">,</span>
<span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
<span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We then set outputs for the simulation.
Specifically, we set output of <code class="docutils literal notranslate"><span class="pre">&quot;flowOut&quot;</span></code> to every 1000 timesteps, to get flow field information, and <code class="docutils literal notranslate"><span class="pre">&quot;solidTrajOut&quot;</span></code> to get the trajectory information of our motile colloid every 1000 timesteps.
We further enable synopsis dumping, and set a logging level of 3 with <code class="docutils literal notranslate"><span class="pre">&quot;debugOut&quot;</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Periodic boundary conditions on the domain&quot;</span><span class="p">,</span>
<span class="s2">&quot;domainWalls&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;The spherical colloid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Colloid radius&quot;</span><span class="p">,</span>
        <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;The colloid should be mobile, i.e. free to be displaced&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dsplc&quot;</span><span class="p">:</span>        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;mass&quot;</span><span class="p">:</span>         <span class="mi">565</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Finally, we configure boundary conditions.
First, we set <code class="docutils literal notranslate"><span class="pre">&quot;domainWalls&quot;:</span> <span class="pre">1</span></code> to additively include periodic boundary conditions around our simulation domain.
As this includes periodic boundary conditions for us, we only need to add a single boundary condition element to our input script: Namely, the motile colloid object itself.</p>
<p>The implementation of boundaries in MPCD is discussed in detail in <strong>TODO: link to Louise’s section</strong>.
As we have a solid boundary, and the boundary is expected to be off-latice, we need to enabled phantom particles.
<strong>TODO: finish explaining this block</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>Finally, don’t forget to properly close the input file with closing braces</p>
</section>
<section id="id13">
<h3>Running<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h3>
<p><strong>TODO: COPIED FROM KRISTIAN’S EXAMPLE. NEED TO ADAPT TO THIS TUTORIAL.</strong>
This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="n">ChannelFlow</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>In the corresponding avVel.dat, you should now see how the velocity in the x direction is steadily increasing, the y velocity fluctuates around zero, and the z velocity is actually zero.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">For</span> <span class="n">the</span> <span class="n">Polymer</span> <span class="n">Physics</span> <span class="n">Research</span> <span class="n">Group</span> <span class="o">***</span>
<span class="o">********</span> <span class="n">At</span> <span class="n">the</span> <span class="n">University</span> <span class="n">of</span> <span class="n">Ottawa</span> <span class="o">*********</span>

<span class="o">**********************************************</span>
<span class="o">************</span> <span class="n">Code</span> <span class="n">begun</span> <span class="n">Oct</span><span class="o">.</span> <span class="mi">2008</span> <span class="o">************</span>
<span class="o">**********************************************</span>

<span class="n">t</span>        <span class="n">VcmX</span>           <span class="n">VcmY</span>            <span class="n">VcmZ</span>            <span class="n">KBT</span>             <span class="n">dVXX</span>            <span class="n">dVXY</span>            <span class="n">dVXZ</span>            <span class="n">dVYX</span>            <span class="n">dVYY</span>            <span class="n">dVYZ</span>            <span class="n">dVZX</span>            <span class="n">dVZY</span>            <span class="n">dVZZ</span>
<span class="mf">0.00000e+00</span>     <span class="mf">3.45052e-01</span>     <span class="mf">6.58234e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.06250e+00</span>    <span class="o">-</span><span class="mf">1.36458e-03</span>    <span class="o">-</span><span class="mf">1.05097e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">2.08302e-04</span>    <span class="o">-</span><span class="mf">4.56426e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.00000e+00</span>     <span class="mf">3.50801e-01</span>     <span class="mf">6.23010e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.07224e+00</span>    <span class="o">-</span><span class="mf">2.09023e-03</span>    <span class="o">-</span><span class="mf">6.09935e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.00165e-04</span>    <span class="o">-</span><span class="mf">6.01067e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.00000e+00</span>     <span class="mf">3.58123e-01</span>     <span class="mf">7.84703e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.06892e+00</span>    <span class="o">-</span><span class="mf">9.59730e-04</span>    <span class="o">-</span><span class="mf">1.14724e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">4.05406e-04</span>    <span class="o">-</span><span class="mf">9.35703e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.00000e+00</span>     <span class="mf">3.61650e-01</span>     <span class="mf">5.74061e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.07228e+00</span>    <span class="o">-</span><span class="mf">1.77202e-03</span>    <span class="o">-</span><span class="mf">6.59328e-05</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">1.45274e-04</span>    <span class="o">-</span><span class="mf">4.18955e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.00000e+00</span>     <span class="mf">3.64406e-01</span>     <span class="mf">4.03414e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.07902e+00</span>    <span class="o">-</span><span class="mf">1.26291e-03</span>    <span class="o">-</span><span class="mf">9.22894e-05</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">4.18639e-04</span>    <span class="o">-</span><span class="mf">5.48575e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">5.00000e+00</span>     <span class="mf">3.69803e-01</span>     <span class="mf">2.79431e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.07395e+00</span>    <span class="o">-</span><span class="mf">1.42730e-03</span>    <span class="o">-</span><span class="mf">3.70481e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">7.55855e-04</span>     <span class="mf">2.63838e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">6.00000e+00</span>     <span class="mf">3.75238e-01</span>     <span class="mf">2.96236e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.08079e+00</span>    <span class="o">-</span><span class="mf">1.45695e-03</span>    <span class="o">-</span><span class="mf">1.83501e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">3.06386e-04</span>    <span class="o">-</span><span class="mf">2.01063e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">7.00000e+00</span>     <span class="mf">3.78821e-01</span>     <span class="mf">2.94415e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.08732e+00</span>    <span class="o">-</span><span class="mf">1.05142e-03</span>     <span class="mf">9.88574e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">2.51660e-04</span>    <span class="o">-</span><span class="mf">9.77584e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">8.00000e+00</span>     <span class="mf">3.84917e-01</span>     <span class="mf">9.50202e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.08471e+00</span>    <span class="o">-</span><span class="mf">1.54482e-03</span>     <span class="mf">3.56912e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.67420e-04</span>     <span class="mf">7.57103e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">9.00000e+00</span>     <span class="mf">3.89152e-01</span>     <span class="mf">2.32318e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.08486e+00</span>    <span class="o">-</span><span class="mf">8.95644e-04</span>    <span class="o">-</span><span class="mf">1.13704e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">5.50255e-05</span>    <span class="o">-</span><span class="mf">6.15770e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.00000e+01</span>     <span class="mf">3.93201e-01</span>     <span class="mf">2.29169e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.09030e+00</span>    <span class="o">-</span><span class="mf">6.43542e-04</span>    <span class="o">-</span><span class="mf">4.24444e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">9.03793e-05</span>     <span class="mf">3.57824e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.10000e+01</span>     <span class="mf">3.94978e-01</span>     <span class="mf">1.55992e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.09117e+00</span>    <span class="o">-</span><span class="mf">8.87784e-04</span>    <span class="o">-</span><span class="mf">1.78963e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">3.84145e-04</span>    <span class="o">-</span><span class="mf">3.38673e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.20000e+01</span>     <span class="mf">4.01249e-01</span>     <span class="mf">2.80295e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.08548e+00</span>    <span class="o">-</span><span class="mf">1.09625e-03</span>     <span class="mf">3.27938e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">4.54421e-04</span>     <span class="mf">4.87806e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.30000e+01</span>     <span class="mf">4.05286e-01</span>     <span class="mf">1.89601e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.09531e+00</span>    <span class="o">-</span><span class="mf">5.48964e-04</span>     <span class="mf">1.05430e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">6.45156e-04</span>     <span class="mf">3.93277e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.40000e+01</span>     <span class="mf">4.09654e-01</span>    <span class="o">-</span><span class="mf">7.50545e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.08849e+00</span>    <span class="o">-</span><span class="mf">1.11103e-03</span>    <span class="o">-</span><span class="mf">5.51446e-05</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">1.43860e-04</span>     <span class="mf">1.35607e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.50000e+01</span>     <span class="mf">4.17369e-01</span>     <span class="mf">3.10384e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.10007e+00</span>    <span class="o">-</span><span class="mf">1.29882e-03</span>    <span class="o">-</span><span class="mf">2.52358e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">7.78732e-05</span>    <span class="o">-</span><span class="mf">1.29354e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.60000e+01</span>     <span class="mf">4.20780e-01</span>     <span class="mf">4.13124e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.09703e+00</span>    <span class="o">-</span><span class="mf">1.30782e-03</span>    <span class="o">-</span><span class="mf">6.52589e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">2.80151e-04</span>    <span class="o">-</span><span class="mf">6.96605e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.70000e+01</span>     <span class="mf">4.27041e-01</span>     <span class="mf">4.26768e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.10565e+00</span>    <span class="o">-</span><span class="mf">1.21964e-03</span>    <span class="o">-</span><span class="mf">3.34156e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">4.56698e-04</span>     <span class="mf">9.94585e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.80000e+01</span>     <span class="mf">4.31088e-01</span>     <span class="mf">5.74989e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.10576e+00</span>    <span class="o">-</span><span class="mf">1.87260e-03</span>    <span class="o">-</span><span class="mf">5.52449e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">2.36001e-04</span>    <span class="o">-</span><span class="mf">7.48178e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">1.90000e+01</span>     <span class="mf">4.35738e-01</span>     <span class="mf">4.21765e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11031e+00</span>    <span class="o">-</span><span class="mf">1.78792e-03</span>     <span class="mf">2.14343e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">5.56329e-05</span>     <span class="mf">1.08383e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.00000e+01</span>     <span class="mf">4.41161e-01</span>     <span class="mf">1.74172e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11284e+00</span>    <span class="o">-</span><span class="mf">1.81910e-03</span>     <span class="mf">1.41829e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.26697e-04</span>     <span class="mf">7.40635e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.10000e+01</span>     <span class="mf">4.42280e-01</span>    <span class="o">-</span><span class="mf">2.21483e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11302e+00</span>    <span class="o">-</span><span class="mf">1.32765e-03</span>     <span class="mf">1.31480e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">6.37553e-04</span>    <span class="o">-</span><span class="mf">2.38006e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.20000e+01</span>     <span class="mf">4.49555e-01</span>    <span class="o">-</span><span class="mf">1.43127e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11267e+00</span>    <span class="o">-</span><span class="mf">1.65318e-03</span>     <span class="mf">1.10167e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">5.49391e-04</span>    <span class="o">-</span><span class="mf">1.41895e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.30000e+01</span>     <span class="mf">4.50628e-01</span>    <span class="o">-</span><span class="mf">2.74851e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11249e+00</span>    <span class="o">-</span><span class="mf">1.24766e-03</span>    <span class="o">-</span><span class="mf">3.92778e-05</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">9.47222e-06</span>    <span class="o">-</span><span class="mf">2.84050e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.40000e+01</span>     <span class="mf">4.53632e-01</span>    <span class="o">-</span><span class="mf">1.77157e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11439e+00</span>    <span class="o">-</span><span class="mf">1.63530e-03</span>     <span class="mf">1.59648e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">2.99482e-04</span>    <span class="o">-</span><span class="mf">4.95892e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.50000e+01</span>     <span class="mf">4.58302e-01</span>    <span class="o">-</span><span class="mf">5.70376e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.11430e+00</span>    <span class="o">-</span><span class="mf">1.20376e-03</span>     <span class="mf">1.72172e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.87628e-04</span>     <span class="mf">7.19723e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.60000e+01</span>     <span class="mf">4.61396e-01</span>    <span class="o">-</span><span class="mf">4.98616e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.12231e+00</span>    <span class="o">-</span><span class="mf">1.16975e-03</span>    <span class="o">-</span><span class="mf">1.59873e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">2.64437e-04</span>    <span class="o">-</span><span class="mf">9.45790e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.70000e+01</span>     <span class="mf">4.64587e-01</span>    <span class="o">-</span><span class="mf">5.77189e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.12509e+00</span>    <span class="o">-</span><span class="mf">1.56520e-03</span>     <span class="mf">1.95114e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">5.59956e-04</span>    <span class="o">-</span><span class="mf">3.00970e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.80000e+01</span>     <span class="mf">4.69087e-01</span>    <span class="o">-</span><span class="mf">4.41537e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.13043e+00</span>    <span class="o">-</span><span class="mf">2.29317e-03</span>    <span class="o">-</span><span class="mf">2.00406e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.44941e-04</span>     <span class="mf">8.39970e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">2.90000e+01</span>     <span class="mf">4.74573e-01</span>    <span class="o">-</span><span class="mf">2.69217e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.12628e+00</span>    <span class="o">-</span><span class="mf">1.79209e-03</span>     <span class="mf">4.42318e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">1.18112e-04</span>     <span class="mf">3.04627e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.00000e+01</span>     <span class="mf">4.77925e-01</span>    <span class="o">-</span><span class="mf">4.23853e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.12965e+00</span>    <span class="o">-</span><span class="mf">1.45111e-03</span>     <span class="mf">9.28562e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.72270e-06</span>    <span class="o">-</span><span class="mf">6.38259e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.10000e+01</span>     <span class="mf">4.79560e-01</span>    <span class="o">-</span><span class="mf">3.47639e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.13145e+00</span>    <span class="o">-</span><span class="mf">1.37447e-03</span>     <span class="mf">9.14254e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">8.84702e-05</span>    <span class="o">-</span><span class="mf">4.45805e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.20000e+01</span>     <span class="mf">4.84372e-01</span>    <span class="o">-</span><span class="mf">5.47304e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.13747e+00</span>    <span class="o">-</span><span class="mf">1.96381e-03</span>     <span class="mf">7.72492e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">5.99433e-04</span>    <span class="o">-</span><span class="mf">3.39571e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.30000e+01</span>     <span class="mf">4.86674e-01</span>    <span class="o">-</span><span class="mf">3.49428e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.13735e+00</span>    <span class="o">-</span><span class="mf">1.75572e-03</span>     <span class="mf">1.45743e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">3.37711e-04</span>     <span class="mf">2.79032e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.40000e+01</span>     <span class="mf">4.89764e-01</span>    <span class="o">-</span><span class="mf">4.42566e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.13214e+00</span>    <span class="o">-</span><span class="mf">1.82282e-03</span>     <span class="mf">2.39112e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">4.84081e-04</span>    <span class="o">-</span><span class="mf">9.86585e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.50000e+01</span>     <span class="mf">4.93684e-01</span>    <span class="o">-</span><span class="mf">3.45316e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.13607e+00</span>    <span class="o">-</span><span class="mf">1.31257e-03</span>     <span class="mf">4.14919e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">3.79466e-04</span>    <span class="o">-</span><span class="mf">3.02127e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.60000e+01</span>     <span class="mf">4.98918e-01</span>    <span class="o">-</span><span class="mf">3.24449e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.14174e+00</span>    <span class="o">-</span><span class="mf">1.68669e-03</span>    <span class="o">-</span><span class="mf">6.06406e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">2.23057e-04</span>     <span class="mf">1.53655e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.70000e+01</span>     <span class="mf">5.03730e-01</span>    <span class="o">-</span><span class="mf">3.91437e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.14826e+00</span>    <span class="o">-</span><span class="mf">1.55978e-03</span>     <span class="mf">2.02801e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">4.54704e-04</span>     <span class="mf">7.77137e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.80000e+01</span>     <span class="mf">5.05736e-01</span>    <span class="o">-</span><span class="mf">1.28787e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.15212e+00</span>    <span class="o">-</span><span class="mf">1.00495e-03</span>    <span class="o">-</span><span class="mf">4.49476e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">6.18846e-05</span>     <span class="mf">2.28526e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">3.90000e+01</span>     <span class="mf">5.09232e-01</span>    <span class="o">-</span><span class="mf">1.25548e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.14257e+00</span>    <span class="o">-</span><span class="mf">2.55529e-03</span>     <span class="mf">1.39230e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.50541e-04</span>     <span class="mf">2.21952e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.00000e+01</span>     <span class="mf">5.13641e-01</span>    <span class="o">-</span><span class="mf">2.60856e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.14785e+00</span>    <span class="o">-</span><span class="mf">2.13809e-03</span>     <span class="mf">9.84253e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">4.82504e-04</span>    <span class="o">-</span><span class="mf">4.77825e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.10000e+01</span>     <span class="mf">5.16390e-01</span>    <span class="o">-</span><span class="mf">3.68310e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.14975e+00</span>    <span class="o">-</span><span class="mf">2.36575e-03</span>     <span class="mf">5.30616e-04</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">5.78192e-04</span>     <span class="mf">3.34780e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.20000e+01</span>     <span class="mf">5.20077e-01</span>     <span class="mf">8.12596e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.15349e+00</span>    <span class="o">-</span><span class="mf">1.62682e-03</span>     <span class="mf">4.44550e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.29634e-04</span>    <span class="o">-</span><span class="mf">1.85622e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.30000e+01</span>     <span class="mf">5.22265e-01</span>     <span class="mf">7.69079e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.15929e+00</span>    <span class="o">-</span><span class="mf">2.23385e-03</span>     <span class="mf">2.27985e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">3.18873e-04</span>     <span class="mf">6.56014e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.40000e+01</span>     <span class="mf">5.23322e-01</span>    <span class="o">-</span><span class="mf">9.10584e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.15748e+00</span>    <span class="o">-</span><span class="mf">1.69311e-03</span>     <span class="mf">1.13959e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">5.14337e-04</span>     <span class="mf">3.15428e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.50000e+01</span>     <span class="mf">5.29615e-01</span>     <span class="mf">8.41938e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.16039e+00</span>    <span class="o">-</span><span class="mf">1.89173e-03</span>     <span class="mf">1.49322e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">3.85331e-04</span>    <span class="o">-</span><span class="mf">6.92088e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.60000e+01</span>     <span class="mf">5.31556e-01</span>     <span class="mf">2.75160e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.16471e+00</span>    <span class="o">-</span><span class="mf">1.43088e-03</span>    <span class="o">-</span><span class="mf">9.70971e-05</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">2.91346e-04</span>     <span class="mf">3.56101e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.70000e+01</span>     <span class="mf">5.34593e-01</span>     <span class="mf">2.12590e-05</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.16822e+00</span>    <span class="o">-</span><span class="mf">1.23542e-03</span>    <span class="o">-</span><span class="mf">2.41419e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">3.24688e-04</span>    <span class="o">-</span><span class="mf">1.93997e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.80000e+01</span>     <span class="mf">5.38447e-01</span>    <span class="o">-</span><span class="mf">5.89117e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.16833e+00</span>    <span class="o">-</span><span class="mf">2.03582e-03</span>    <span class="o">-</span><span class="mf">2.16861e-03</span>     <span class="mf">0.00000e+00</span>    <span class="o">-</span><span class="mf">1.06117e-04</span>    <span class="o">-</span><span class="mf">9.34396e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">4.90000e+01</span>     <span class="mf">5.36628e-01</span>     <span class="mf">6.32695e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.17077e+00</span>    <span class="o">-</span><span class="mf">1.50439e-03</span>     <span class="mf">9.79270e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">5.25894e-04</span>    <span class="o">-</span><span class="mf">4.26488e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
<span class="mf">5.00000e+01</span>     <span class="mf">5.39846e-01</span>     <span class="mf">1.96692e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.16781e+00</span>    <span class="o">-</span><span class="mf">1.13051e-03</span>     <span class="mf">2.57739e-03</span>     <span class="mf">0.00000e+00</span>     <span class="mf">1.90012e-05</span>     <span class="mf">3.31045e-04</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>     <span class="mf">0.00000e+00</span>
</pre></div>
</div>
</section>
</section>
<section id="dumbbell-swimmers">
<h2>Dumbbell swimmers<a class="headerlink" href="#dumbbell-swimmers" title="Permalink to this heading">#</a></h2>
<section id="swimmers">
<h3>Swimmers<a class="headerlink" href="#swimmers" title="Permalink to this heading">#</a></h3>
<p>This tutorial shows how to generate a simple swimmer simulation in periodic boundary conditions.
This tutorial is based on the input file found in MPCD/SampleInputs/swimmer/input.json</p>
</section>
<section id="id14">
<h3>Input File<a class="headerlink" href="#id14" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;debugOut&quot;</span><span class="p">:</span>         <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">2000</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;collOp&quot;</span><span class="p">:</span>           <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;species&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Periodic boundary conditions on the domain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domainWalls&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Dumb-dumbell swimmer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;typeSwim&quot;</span><span class="p">:</span>         <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;One swimmer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nSwim&quot;</span><span class="p">:</span>            <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Swimmer monomers have same mass as one mpcd cell of fluid particles&quot;</span><span class="p">,</span>
    <span class="s2">&quot;headMSwim&quot;</span><span class="p">:</span>        <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;midMSwim&quot;</span><span class="p">:</span>         <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Swimmer propulsive force&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fsSwim&quot;</span><span class="p">:</span>           <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Dipole strength. dsSwim=1 --&gt; pusher; dsSwim=-2 --&gt; puller&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dsSwim&quot;</span><span class="p">:</span>           <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;kSwim&quot;</span><span class="p">:</span>            <span class="mi">30</span><span class="p">,</span>
    <span class="s2">&quot;roSwim&quot;</span><span class="p">:</span>           <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;sigSwim&quot;</span><span class="p">:</span>          <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;epsSwim&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Output options&quot;</span><span class="p">,</span>
    <span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;avVelOut&quot;</span><span class="p">:</span>         <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;swimQOut&quot;</span><span class="p">:</span>         <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;swimOOut&quot;</span><span class="p">:</span>         <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;swimROut&quot;</span><span class="p">:</span>         <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id15">
<h3>Understanding the Script<a class="headerlink" href="#id15" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;debugOut&quot;</span><span class="p">:</span>         <span class="mi">3</span><span class="p">,</span>
   <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
   <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">2000</span><span class="p">,</span>
   <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
   <span class="s2">&quot;collOp&quot;</span><span class="p">:</span>           <span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>We define how verbose we want the debugger to be (reasonably), we set the system size (30 by 30 in MPCD units),
and we define for how long than the system will run and output.  We also define the collision operator for the MPCD fluid.
In this case, we model an isotropic fluid, with the default collision operator: the <a class="reference internal" href="../Main/Usage.html#andersen"><span class="std std-ref">Andersen collision operator</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span>
      <span class="p">}</span>
<span class="p">],</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Periodic boundary conditions on the domain&quot;</span><span class="p">,</span>
<span class="s2">&quot;domainWalls&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We say that every MPCD box should be initialised with 20 MPC particles, and we define the boundary conditions to be periodic.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Dumb-dumbell swimmer&quot;</span><span class="p">,</span>
<span class="s2">&quot;typeSwim&quot;</span><span class="p">:</span>         <span class="mi">2</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;One swimmer&quot;</span><span class="p">,</span>
<span class="s2">&quot;nSwim&quot;</span><span class="p">:</span>            <span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Swimmer monomers have same mass as one mpcd cell of fluid particles&quot;</span><span class="p">,</span>
<span class="s2">&quot;headMSwim&quot;</span><span class="p">:</span>        <span class="mi">20</span><span class="p">,</span>
<span class="s2">&quot;midMSwim&quot;</span><span class="p">:</span>         <span class="mi">20</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Swimmer propulsive force&quot;</span><span class="p">,</span>
<span class="s2">&quot;fsSwim&quot;</span><span class="p">:</span>           <span class="mi">20</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Dipole strength. dsSwim=1 --&gt; pusher; dsSwim=-2 --&gt; puller&quot;</span><span class="p">,</span>
<span class="s2">&quot;dsSwim&quot;</span><span class="p">:</span>           <span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;kSwim&quot;</span><span class="p">:</span>            <span class="mi">30</span><span class="p">,</span>
<span class="s2">&quot;roSwim&quot;</span><span class="p">:</span>           <span class="mi">4</span><span class="p">,</span>
<span class="s2">&quot;sigSwim&quot;</span><span class="p">:</span>          <span class="mi">4</span><span class="p">,</span>
<span class="s2">&quot;epsSwim&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We describe the swimmer population: we want there to be 1 (nswim=1) dumbbell swimmer (typeSwim=2), with both body mass and head mass of
20 (midMSwim = headMSwim = 20). The swimmer will swim with a force of 20 MPCD units (fsSwim=20), and it will be a pusher (dsSwim=1).</p>
<p>These parameters can be changed to have more swimmers, heavier swimmers, or stronger swimmers. The sample input swimmerPairInLC gives an example
of two swimmers in a liquid crystal, and many other combinations are possible. Go wild!</p>
<p>The two parts of the dumbbell swimmer will be connected with a spring of 30 MPCD units (kSwim=30) and equilibrium length 4 (roSwim=4).
They will repulse each other with a WCA interaction of radius 4 (sigSwim=4) and relative strength 1 in MPCD energy unit. See the <a class="reference internal" href="../Main/ExtraOptions.html#id21"><span class="std std-ref">swimmer section</span></a>
for more details.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When changing those parameters, we recommend that the mass of the head and body of the swimmer be kept the same, and that the equilibrium length
of the FENE spring (roSwim) and the range of the WCA interaction (sigSwim) also be the same. If these two conditions are not respected,
the simulated objects will not be dumbbell swimmers as described in the  <a class="reference internal" href="../Main/ExtraOptions.html#id21"><span class="std std-ref">swimmer section</span></a>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Output options&quot;</span><span class="p">,</span>
<span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">50</span><span class="p">,</span>
<span class="s2">&quot;avVelOut&quot;</span><span class="p">:</span>         <span class="mi">0</span><span class="p">,</span>
<span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
<span class="s2">&quot;swimQOut&quot;</span><span class="p">:</span>         <span class="mi">50</span><span class="p">,</span>
<span class="s2">&quot;swimOOut&quot;</span><span class="p">:</span>         <span class="mi">0</span><span class="p">,</span>
<span class="s2">&quot;swimROut&quot;</span><span class="p">:</span>         <span class="mi">0</span><span class="p">,</span>
<span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span>
</pre></div>
</div>
<p>We now define what things we want to write out during the simulation (see the <a class="reference internal" href="../Outputs/Outputs.html#id1"><span class="std std-ref">output section</span></a> for details).
We write out the flow field every 50 timesteps, and never the average velocity and energy of the system - it can be turned on.
The position of the swimmers is printed every 50 timestep, but not the orientation or the run and tumble frequency.
We ask for a synopsis file, but don’t do checkpoint checks.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>The end of the input file.</p>
</section>
<section id="id16">
<h3>Running<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="n">swimmer</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>and its results can be visualised with swimmerTraj_fields2D.py or swimmerRefFrame_flow2D.py.</p>
</section>
</section>
<section id="d-passive-nematic">
<h2>2D Passive Nematic<a class="headerlink" href="#d-passive-nematic" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to simulate a 2D passive nematic liquid crystal starting in a disordered state (because of random initial orientations) under periodic boundary conditions. Because the simulation parameters lie within the nematic regime, the simulation will relax towards an ordered state via the anhilation of topological defects.</p>
<section id="id17">
<h3>Input file<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Square geometry&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">500</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;No warmup, in order to capture the relaxation towards the ordered state&quot;</span><span class="p">,</span>
    <span class="s2">&quot;warmUp&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>

    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Andersen MPCD preserving angular momentum&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rTech&quot;</span><span class="p">:</span>            <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Liquid crystal mode turned on&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lc&quot;</span><span class="p">:</span>               <span class="mi">1</span><span class="p">,</span>

    <span class="s2">&quot;species&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Random inital orientation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;oDist&quot;</span><span class="p">:</span>        <span class="mi">0</span>
        <span class="p">}</span>
    <span class="p">],</span>

    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Periodic Boundary Contions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domainWalls&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>


    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;We output the director and scalar order parameter fields&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dirSOut&quot;</span><span class="p">:</span>          <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;We output the position, orientation and charge of topological defects, if present&quot;</span><span class="p">,</span>
    <span class="s2">&quot;defectsOut&quot;</span><span class="p">:</span>       <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Outputting summary of the parameters used in the simulation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id18">
<h3>Understanding the Script<a class="headerlink" href="#id18" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Square geometry&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">500</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;No warmup, in order to capture the relaxation towards the ordered state&quot;</span><span class="p">,</span>
    <span class="s2">&quot;warmUp&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>We define the system size (50 by 50 in MPCD simulation units), and define how long the system will actually run and output. Because we are interested in capturing the relaxation towards the ordered state, we do not run any warmup.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Andersen MPCD preserving angular momentum&quot;</span><span class="p">,</span>
<span class="s2">&quot;rTech&quot;</span><span class="p">:</span>            <span class="mi">3</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Liquid crystal mode turned on&quot;</span><span class="p">,</span>
<span class="s2">&quot;lc&quot;</span><span class="p">:</span>               <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We also define the collision operator for the MPCD fluid (in this case, we model a nematic liquid crystal, so we need an angular momentum preserving collision operator) and turn on the liquid crystal mode.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since we did not input a specific value for the nematic <a class="reference internal" href="../Main/ExtraOptions.html#nematicsection"><span class="std std-ref">mean field potential</span></a> <span class="math notranslate nohighlight">\(U\)</span> (tag <code class="docutils literal notranslate"><span class="pre">mfpot</span></code>), the solver will use its default value <span class="math notranslate nohighlight">\(U=10\)</span>. For an average population of 20, this leaves the system within the ordered nematic state.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span><span class="p">,</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Random inital orientation&quot;</span><span class="p">,</span>
        <span class="s2">&quot;oDist&quot;</span><span class="p">:</span>        <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>We say that every MPCD box should be initialized with 20 MPC particles and specifying a random initial orientation for the MPC particles, which sets the system to be in an isotropic state.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>         <span class="s2">&quot;Periodic Boundary Contions&quot;</span><span class="p">,</span>
<span class="s2">&quot;domainWalls&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We say that the system has periodic boundary conditions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;We output the director and scalar order parameter fields&quot;</span><span class="p">,</span>
<span class="s2">&quot;dirSOut&quot;</span><span class="p">:</span>          <span class="mi">10</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;We output the position, orientation and charge of topological defects, if present&quot;</span><span class="p">,</span>
<span class="s2">&quot;defectsOut&quot;</span><span class="p">:</span>       <span class="mi">10</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Outputting summary of the parameters used in the simulation&quot;</span><span class="p">,</span>
<span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span>
</pre></div>
</div>
<p>We specify our outputs. Since we are interested in the liquid crystal aspect of the simulation, we output the director and scalar order parameter fields (every 10 time steps), the list of topological defects, with their position, polarization and charge (every 10 time steps) and turn on the sysnopsis file, which summarizes the parameters used in the simulation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>The end of the input file</p>
</section>
<section id="running-the-script">
<h3>Running the Script<a class="headerlink" href="#running-the-script" title="Permalink to this heading">#</a></h3>
</section>
<section id="id19">
<h3>Running<a class="headerlink" href="#id19" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="n">passiveNem2D</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this heading">#</a></h3>
<p>In the corresponding <code class="docutils literal notranslate"><span class="pre">defects.dat</span></code>, you should now see the number of topological defects at each time step, with a list of their positions, charge and angle.  As time increses, the number of topological defects goes down.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span>    <span class="n">numDefects</span>
<span class="n">QX</span>           <span class="n">QY</span>              <span class="n">charge</span>          <span class="n">angle</span>
<span class="mf">0.00</span>        <span class="mi">292</span>
<span class="mf">6.00000e+00</span>  <span class="mf">1.50000e+00</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">2.09440e+00</span>
<span class="mf">1.45000e+01</span>  <span class="mf">1.50000e+00</span>    <span class="mf">00.500</span>   <span class="mf">6.28319e+00</span>
<span class="mf">1.78077e+01</span>  <span class="mf">5.34615e+00</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">1.75606e-01</span>
<span class="mf">2.20000e+01</span>  <span class="mf">1.50000e+00</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">2.09440e+00</span>
<span class="mf">2.90000e+01</span>  <span class="mf">1.50000e+00</span>    <span class="mf">00.500</span>   <span class="mf">6.28319e+00</span>
<span class="mf">4.08333e+01</span>  <span class="mf">1.83333e+00</span>    <span class="mf">00.500</span>   <span class="mf">3.97138e-01</span>
<span class="mf">4.35000e+01</span>  <span class="mf">1.50000e+00</span>    <span class="mf">00.500</span>   <span class="mf">6.28319e+00</span>
<span class="mf">4.55000e+01</span>  <span class="mf">2.00000e+00</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">2.01015e+00</span>
<span class="mf">4.65000e+01</span>  <span class="mf">1.50000e+00</span>    <span class="mf">00.500</span>   <span class="mf">6.28319e+00</span>
<span class="mf">1.27308e+01</span>  <span class="mf">4.73077e+00</span>    <span class="mf">00.500</span>   <span class="mf">3.66033e+00</span>
<span class="mf">1.38333e+01</span>  <span class="mf">3.16667e+00</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">1.40946e+00</span>
<span class="mf">3.45000e+01</span>  <span class="mf">2.50000e+00</span>    <span class="mf">00.500</span>   <span class="mf">3.30748e+00</span>
<span class="mf">3.65000e+01</span>  <span class="mf">2.50000e+00</span>    <span class="mf">00.500</span>   <span class="mf">1.39846e+00</span>
<span class="mf">4.80000e+01</span>  <span class="mf">2.50000e+00</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">2.45724e-01</span>
<span class="mf">3.07143e+00</span>  <span class="mf">4.21429e+00</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">2.79461e-02</span>
<span class="mf">1.85000e+01</span>  <span class="mf">3.50000e+00</span>    <span class="mf">00.500</span>   <span class="mf">3.67896e+00</span>
<span class="mf">2.10000e+01</span>  <span class="mf">4.00000e+00</span>    <span class="mf">00.500</span>   <span class="mf">4.13180e+00</span>
<span class="mf">2.45000e+01</span>  <span class="mf">3.50000e+00</span>    <span class="mf">00.500</span>   <span class="mf">3.03671e+00</span>
<span class="mf">2.65000e+01</span>  <span class="mf">3.50000e+00</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">1.32055e-01</span>
</pre></div>
</div>
<p>The figure below shows relaxation of the nematic towards an ordered state</p>
<div class="table-wrapper docutils container">
<table class="docutils align-center">
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/passive.png"><img alt="../_images/passive.png" class="align-center" src="../_images/passive.png" style="width: 100%;" /></a>
</td>
</tr>
<tr class="row-even"><td><p>Time evolution of nematic liquid crystal. Initially the nematic is in a disordered state. Since this state is energetically costly, with a high number of +1/2 and -1/2 topological defects (depicted by red and blue symbols respectively), the nematic relaxes towards an ordered state. It does so b y anhilating pais of defects with opposite charge.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="d-active-nematic">
<h2>2D Active Nematic<a class="headerlink" href="#d-active-nematic" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to simulate a 2D active nematic liquid crystal starting in an ordered state under periodic boundary conditions. Because of the active stress, the nematic will go through a bending instability, leading to the unbinding of topological defects and transitioning into active turbulence.</p>
<section id="id20">
<h3>Input file<a class="headerlink" href="#id20" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Square geometry&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;No warmup, in order to see the trnaisition to active turbulence&quot;</span><span class="p">,</span>
    <span class="s2">&quot;warmUp&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>

    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Active collision operator with modulated activity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;collOp&quot;</span><span class="p">:</span>            <span class="mi">17</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Liquid crystal mode turned on&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lc&quot;</span><span class="p">:</span>               <span class="mi">1</span><span class="p">,</span>

    <span class="s2">&quot;species&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span><span class="p">,</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;Strength of activity&quot;</span>
            <span class="s2">&quot;act&quot;</span><span class="p">:</span>          <span class="mf">0.08</span>
        <span class="p">}</span>
    <span class="p">],</span>

    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Periodic Boundary Contions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domainWalls&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>

    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;To see the active spontaneous flows, we output the flow field&quot;</span><span class="p">,</span>
    <span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">250</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;We output the director and scalar order parameter fields&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dirSOut&quot;</span><span class="p">:</span>          <span class="mi">250</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;We output the position, orientation and charge of topological defects, if present&quot;</span><span class="p">,</span>
    <span class="s2">&quot;defectsOut&quot;</span><span class="p">:</span>       <span class="mi">250</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Outputting summary of the parameters used in the simulation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id21">
<h3>Understanding the Script<a class="headerlink" href="#id21" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Square geometry&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;No warmup, in order to capture the relaxation towards the ordered state&quot;</span><span class="c1">#,</span>
    <span class="s2">&quot;warmUp&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>We define the system size (50 by 50 in MPCD simulation units), and define how long the system will actually run and output.  Because we are interested in capturing the transition from an ordered state to active turbulence, we do not set up a warm up.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Active collision operator with modulated activity&quot;</span><span class="p">,</span>
<span class="s2">&quot;collOp&quot;</span><span class="p">:</span>            <span class="mi">17</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Liquid crystal mode turned on&quot;</span><span class="p">,</span>
<span class="s2">&quot;lc&quot;</span><span class="p">:</span>               <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We also define the collision operator for the MPCD fluid (in this case, we model an active nematic liquid crystal, so we need an active collision operator) and turn on the liquid crystal mode.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>We say that every MPCD box should be initialized with 20 MPC particles.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since we did not input a specific initial orientation, the solve will assume the default one, which sets all nematogens to be oriented along the <span class="math notranslate nohighlight">\(y\)</span>-axis.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>         <span class="s2">&quot;Periodic Boundary Contions&quot;</span><span class="p">,</span>
<span class="s2">&quot;domainWalls&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We say that the system has periodic boundary conditions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;To see the active spontaneous flows, we output the flow field&quot;</span><span class="p">,</span>
<span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">250</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;We output the director and scalar order parameter fields&quot;</span><span class="p">,</span>
<span class="s2">&quot;dirSOut&quot;</span><span class="p">:</span>          <span class="mi">10</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;We output the position, orientation and charge of topological defects, if present&quot;</span><span class="p">,</span>
<span class="s2">&quot;defectsOut&quot;</span><span class="p">:</span>       <span class="mi">10</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Outputting summary of the parameters used in the simulation&quot;</span><span class="p">,</span>
<span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span>
</pre></div>
</div>
<p>We specify our outputs. Since active systems present active spontaneous flows, we output the floe field of the system (every 250 time steps). In addition, since we are interested in the liquid crystal aspect of the simulation, we output the director and scalar order parameter fields (every 250 time steps), the list of topological defects, with their position, polarization and charge (every 250 time steps) and turn on the sysnopsis file, which summarizes the parameters used in the simulation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>The end of the input file</p>
</section>
<section id="id22">
<h3>Running the Script<a class="headerlink" href="#id22" title="Permalink to this heading">#</a></h3>
</section>
<section id="id23">
<h3>Running<a class="headerlink" href="#id23" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="n">activeNem2D</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="id24">
<h3>Output<a class="headerlink" href="#id24" title="Permalink to this heading">#</a></h3>
<p>In the corresponding <code class="docutils literal notranslate"><span class="pre">defects.dat</span></code>, you should now see the number of topological defects at each time step, with a list of their positions, charge and angle.  In the beginning there should be no defects, but the their numbers increase as the system enters into turbulence</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span>    <span class="n">numDefects</span>
<span class="n">QX</span>           <span class="n">QY</span>              <span class="n">charge</span>          <span class="n">angle</span>
<span class="mf">0.00</span>        <span class="mi">0</span>

<span class="mf">25.00</span>       <span class="mi">0</span>

<span class="mf">50.00</span>       <span class="mi">0</span>

<span class="mf">75.00</span>       <span class="mi">2</span>
<span class="mf">4.50000e+01</span>  <span class="mf">2.30000e+01</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">8.49837e-01</span>
<span class="mf">4.20000e+01</span>  <span class="mf">2.40000e+01</span>    <span class="mf">00.500</span>   <span class="mf">6.12024e+00</span>

<span class="mf">100.00</span>      <span class="mi">9</span>
<span class="mf">1.50000e+01</span>  <span class="mf">9.00000e+00</span>    <span class="mf">00.500</span>   <span class="mf">2.71453e+00</span>
<span class="mf">4.85000e+01</span>  <span class="mf">1.20000e+01</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">2.09440e+00</span>
<span class="mf">3.00000e+00</span>  <span class="mf">1.50000e+01</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">1.65045e+00</span>
<span class="mf">4.10000e+01</span>  <span class="mf">1.90000e+01</span>    <span class="mf">00.500</span>   <span class="mf">5.91872e+00</span>
<span class="mf">2.90000e+01</span>  <span class="mf">2.00000e+01</span>    <span class="mf">00.500</span>   <span class="mf">3.15935e-01</span>
<span class="mf">4.10000e+01</span>  <span class="mf">2.20000e+01</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">1.10006e-01</span>
<span class="mf">4.40000e+01</span>  <span class="mf">2.20000e+01</span>    <span class="mf">00.500</span>   <span class="mf">3.24418e+00</span>
<span class="mf">4.40000e+01</span>  <span class="mf">2.60000e+01</span>    <span class="o">-</span><span class="mf">0.500</span>   <span class="mf">1.29505e+00</span>
<span class="mf">1.30000e+01</span>  <span class="mf">4.10000e+01</span>    <span class="mf">00.500</span>   <span class="mf">5.30896e+00</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The defect tracker is unable to detect defects that lie nearby a periodic boundary.
As such, this can end up in the output file reporting an odd number of topological defects.</p>
</div>
<p>The figure below shows the defect unbinding process</p>
<div class="table-wrapper docutils container">
<table class="docutils align-center">
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/active.png"><img alt="../_images/active.png" class="align-center" src="../_images/active.png" style="width: 100%;" /></a>
</td>
</tr>
<tr class="row-even"><td><p>Time evolution of the oriented nematic. Initially the nematic is oriented along the     <span class="math notranslate nohighlight">\(y\)</span>-axis. Active flows then cause a bending instability that emerges first as sinusoidal waves and ends up in active turbulence, with unbinded +1/2 and -1/2 topological defects (depicted by red and blue symbols respectively). The odd number of topological defects arises because some defect lie to close to the boundary and are not detected by the tracker.</p></td>
</tr>
</tbody>
</table>
</div>
<p>We can also visualize the active flows driving this instability</p>
<div class="table-wrapper docutils container">
<table class="docutils align-center">
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/active_flow.png"><img alt="../_images/active_flow.png" class="align-center" src="../_images/active_flow.png" style="width: 100%;" /></a>
</td>
</tr>
<tr class="row-even"><td><p>Time evolution of the system’s flow. When the system is ordered, there are no cohesive active flows and all flows come from the thermostat (i.e., they are stochastic). As the nematic starts to bend, active forces start to emerge, driving cohesive flows that, in turn, favour the bending of the nematic. When defects unbind, the system enters into turbulence. (Notice that the scale of the color bar changes at each time frame).</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="d-cylinder">
<h2>3D cylinder<a class="headerlink" href="#d-cylinder" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to run a MPCD simulation confined within an impermeable cylinder. It is</p>
<ul class="simple">
<li><p>an isotropic fluid</p></li>
<li><p>in 3D</p></li>
<li><p>with no flow or external forces</p></li>
<li><p>and no solutes</p></li>
<li><dl class="simple">
<dt>contained within a cylinder along x direction with</dt><dd><ul>
<li><p>periodic boundary conditions at both ends</p></li>
<li><p>perfect slip at walls</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>This tutorial is based on the input file found in <code class="docutils literal notranslate"><span class="pre">MPCD/SampleInputs/3DCylinder/input.json</span></code>.</p>
<section id="id25">
<h3>Input File<a class="headerlink" href="#id25" title="Permalink to this heading">#</a></h3>
</section>
<section id="id26">
<h3>Understanding the Script<a class="headerlink" href="#id26" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;cuboid geometry&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;To have PBCs at walls of the cuboid geometry on top of a cylider within this geometry&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domainWalls&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">500</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;collOp&quot;</span><span class="p">:</span>           <span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>We first define the system size (<span class="math notranslate nohighlight">\(20 \times 10 \times 10\)</span> in MPCd units). The <cite>“domainWalls”: 1,</cite> is to add extra periodic boundary conditions on the domain walls, on top of the defined cylinder boundaries. Then it is specified how long the simulation will run and output data.  To have an Isotropic fluid the Andersen collision operator is used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span>     <span class="s2">&quot;The total number of particles in a cylider = \pi * r^2 * L * 20&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pop&quot;</span><span class="p">:</span>         <span class="mi">20106</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Here, we set the total number of particles inside the cylinder using the its volume and average number of particles in each MPCD cell. The radius of cylinder , <span class="math notranslate nohighlight">\(r = 4\)</span> (it is enetred later in <cite>BC</cite> part) and its length, <span class="math notranslate nohighlight">\(L = 20\)</span> (the length of the cuboid) <span class="math notranslate nohighlight">\(\text{pop} = \pi r^2L * 20 \approx 20106\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;debugOut&quot;</span><span class="p">:</span>         <span class="mi">3</span><span class="p">,</span>
<span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">20</span><span class="p">,</span>
<span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
<span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We now define what things we want to write out during the simulation (see output for details). We use debugOut level 3. We write out the flow field every 20 timesteps.
We don’t write out the energy in this example, but that can be turned on. We also include a synopsis file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;BC for a cylinder with two ends and impermeable perfect-slip walls&quot;</span><span class="p">,</span>
<span class="s2">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="o">..</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Now we define BC. (See Boundary Conditions for more details) Remember, that this needs to be between [].</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;E&quot;</span><span class="p">:</span>            <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>Since particles are transferring momentum to the walls.</p>
<p>Now lets see how a cylinder could be defined. Standard surfaces have the form,</p>
<div class="math-wrapper docutils container" id="shape">
<div class="math notranslate nohighlight" id="shape">
\[S^S(\vec{x})=[A_x\left(x-Q_x\right)]^{p_x} + [A_y\left(y-Q_y\right)]^{p_y} + [A_z\left(z-Q_z\right)]^{p_z} - R^{p_R} = 0\]</div>
</div>
<p>where the surface parameters represent the surface position’s <span class="math notranslate nohighlight">\(\vec{Q}=(Q_x,Q_y,Q_z)\)</span>,
surface coefficient’s <span class="math notranslate nohighlight">\(\vec{A}=(A_x,A_y,A_z)\)</span>, surface power’s <span class="math notranslate nohighlight">\((p_x,p_y,p_z,p_R)\)</span> and radius <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>For this example, the cylinder is along the x axis meaning its base circle is lying in the yz-plane, so  <span class="math notranslate nohighlight">\(\vec{Q}=(0,Q_y,Q_z)\)</span>, surface power’s <span class="math notranslate nohighlight">\((2,2,2,2)\)</span> , <span class="math notranslate nohighlight">\(\vec{A}=(0,1,1)\)</span> and  radius <span class="math notranslate nohighlight">\(R\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">4</span><span class="p">,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a thorough explanation about different surfaces please check <a class="reference internal" href="../Main/Usage.html#subsection-boundarysurfaces"><span class="std std-ref">Standard surfaces</span></a>.</p>
</div>
<p>The next part deals with how the velocity of particles changhes when they collide with the walls of the cylinder. In this case to creat the perfect slip boundary conditions just the normal component is reversed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;The normal component of velocity is reversed&quot;</span><span class="p">,</span>
<span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;The tangent component of velocity is kept what it was&quot;</span><span class="p">,</span>
<span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>And finally to have the particles inside this volume.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;inv&quot;</span><span class="p">:</span>          <span class="mi">1</span>
</pre></div>
</div>
<p>The end of the input file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id27">
<h3>Running<a class="headerlink" href="#id27" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="mi">3</span><span class="n">DCylinder</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="mi">3</span><span class="n">DCylinder</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="flow-past-a-square-obstacle">
<h2>Flow Past a ‘Square’ Obstacle<a class="headerlink" href="#flow-past-a-square-obstacle" title="Permalink to this heading">#</a></h2>
<section id="flow-past-square-obstacle">
<h3>Flow past ‘square’ obstacle<a class="headerlink" href="#flow-past-square-obstacle" title="Permalink to this heading">#</a></h3>
<p>This tutorial shows how to generate an isotropic simulation in periodic boundary conditions past a square-like object,
with gravity turned on in the x-direction. We cannot implement an actual square-shaped object, so instead we use a squircle, essentially a
higher order version of a sphere. See the <a class="reference internal" href="../Main/Usage.html#squircle"><span class="std std-ref">squircle section</span></a> for more details.
This tutorial is based on the input file found in MPCD/SampleInputs/flowPastSquareObstacle/input.json</p>
</section>
<section id="id28">
<h3>Input File<a class="headerlink" href="#id28" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="s2">&quot;warmUp&quot;</span><span class="p">:</span>           <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;collOp&quot;</span><span class="p">:</span>           <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;grav&quot;</span><span class="p">:</span>             <span class="p">[</span><span class="mf">0.002</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;mag&quot;</span><span class="p">:</span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;species&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;For the density to be 20, must subtract the volume of the obstacle&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pop&quot;</span><span class="p">:</span>         <span class="mi">398000</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;debugOut&quot;</span><span class="p">:</span>         <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;pressureOut&quot;</span><span class="p">:</span>      <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;avVelOut&quot;</span><span class="p">:</span>         <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;checkpointOut&quot;</span><span class="p">:</span>    <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Periodic boundary conditions on the domain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domainWalls&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;BC&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;A fixed squircle obstacle with impermeable, no-slip BCs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">10</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id29">
<h3>Understanding the Script<a class="headerlink" href="#id29" title="Permalink to this heading">#</a></h3>
<p>To understand most of the input script, see the tutorials above. In particular it is very similar to <a class="reference internal" href="#isoptropic"><span class="std std-ref">isotropic fluid input file</span></a>.
The important differences are below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;grav&quot;</span><span class="p">:</span>             <span class="p">[</span><span class="mf">0.002</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
</pre></div>
</div>
<p>This line turns on gravity in the x-direction, with an intensity of 0.002 force density in MPCD unit.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;For the density to be 20, must subtract the volume of the obstacle&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pop&quot;</span><span class="p">:</span>         <span class="mi">398000</span>
        <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Instead of using the density, we have to use the population jSON tag, calculating a density of 20 particles for the MPCD cells in the domain that
are not covered by the colloid object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;BC&quot;</span><span class="p">:</span>
   <span class="p">[</span>
       <span class="p">{</span>
           <span class="s2">&quot;comment&quot;</span><span class="p">:</span>      <span class="s2">&quot;A fixed squircle obstacle with impermeable, no-slip BCs&quot;</span><span class="p">,</span>
           <span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
           <span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
           <span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
           <span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
           <span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">10</span><span class="p">,</span>
           <span class="s2">&quot;DN&quot;</span><span class="p">:</span>           <span class="mi">0</span><span class="p">,</span>
           <span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
           <span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span>
       <span class="p">}</span>
   <span class="p">]</span>
</pre></div>
</div>
<p>The squircle: see the <a class="reference internal" href="../Main/Usage.html#squircle"><span class="std std-ref">squircle section</span></a> for more details. It is placed at position (100,50) within a 200 by 100 domain size (“Q”=[100,50,0]
with “domain”=[200,100]), with a minor radius of 10 (“R”=10). The boundary conditions are no-slip (“MVN”=”MVT”=-1) and non-periodic (“DN”=0).</p>
</section>
<section id="id30">
<h3>Running<a class="headerlink" href="#id30" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="n">flowPastSquareObstacle</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>and its results can be visualised with flowFieldAnimated.py.</p>
</section>
</section>
<section id="d-polymer">
<span id="dpolymer"></span><h2>2D polymer<a class="headerlink" href="#d-polymer" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to run a 2D nematic MPCD simulation in which a polymer is embedded. It is</p>
<ul class="simple">
<li><p>anisotropic nematic fluid</p></li>
<li><p>in 2D</p></li>
<li><p>one polymer</p></li>
<li><p>periodic boundary condition</p></li>
</ul>
<p>This tutorial is based on the input files found in <code class="docutils literal notranslate"><span class="pre">MPCD/SampleInputs/md2D/{input.json,md.inp}</span></code>.</p>
<section id="id31">
<h3>Input File<a class="headerlink" href="#id31" title="Permalink to this heading">#</a></h3>
</section>
<section id="understanding-the-scripts">
<h3>Understanding the Scripts<a class="headerlink" href="#understanding-the-scripts" title="Permalink to this heading">#</a></h3>
<section id="input-json">
<span id="dpolymer-json"></span><h4>input.json<a class="headerlink" href="#input-json" title="Permalink to this heading">#</a></h4>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">2000</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Nematic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;collOp&quot;</span><span class="p">:</span>           <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;lc&quot;</span><span class="p">:</span>               <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We first define the system size (<span class="math notranslate nohighlight">\(20 \times 20\)</span> in MPCd units). Then it is specified how long the simulation will run and output data. The Andersen collision operator is used to simulate the fluid and in order to have anisotropic fluid the <code class="docutils literal notranslate"><span class="pre">lc</span></code> is set to 1.</p>
<p>Now it is time to declare the path of the polymer input file that is the <code class="docutils literal notranslate"><span class="pre">md.inp</span></code>. For more details about how MD is coupled to MPCD please take a look at the <a class="reference internal" href="../Main/ExtraOptions.html#chapter11"><span class="std std-ref">MD</span></a> section. To briefly explain, Polymer monomers are included in the velocity collision operator and during the streaming time step of MPCD , a molecular dynamics algorithm is responsible to update position and velocity of monomers. To keep the MD simulation stable, during one MPCD streaming step <code class="docutils literal notranslate"><span class="pre">&quot;stepsMD&quot;</span></code> number of MD time steps are run.</p>
<div class="highlight-default notranslate" id="mdstep"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Location of the MD input file&quot;</span><span class="p">,</span>
<span class="s2">&quot;mdIn&quot;</span><span class="p">:</span>             <span class="s2">&quot;md.inp&quot;</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Number of MD steps per MPCD step&quot;</span><span class="p">,</span>
<span class="s2">&quot;stepsMD&quot;</span><span class="p">:</span>          <span class="mi">50</span><span class="p">,</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span>
      <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>We say that every MPCD box should be initialized with 20 MPCD particles.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;debugOut&quot;</span><span class="p">:</span>         <span class="mi">3</span><span class="p">,</span>
<span class="s2">&quot;dirSOut&quot;</span><span class="p">:</span>          <span class="mi">100</span><span class="p">,</span>
<span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span>
</pre></div>
</div>
<p>We now define what things we want to write out during the simulation (see output for details). We use debugOut level 3. We write out the director field every 100 timesteps. We also include a synopsis file.</p>
<p>The end of the input file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="md-inp">
<span id="dpolymer-inp"></span><h4>md.inp<a class="headerlink" href="#md-inp" title="Permalink to this heading">#</a></h4>
<p>Here is the breakdown of the important parts of the input script that you can modify (the parts that are not explained are set values that should not be changed unless you need fundamental changes)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:    warmupMD        = 0</span>
</pre></div>
</div>
<p>The MPCD simualtion can have a warm up time during which the algorithm runs but there is no output. If there is a warm up time for MPCD, it can be chosen whether to run the MD during that warm up time or not.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if MD runs during warmup time, it outputs data.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        unitCells               = (20,20,0)</span>
</pre></div>
</div>
<p>The system size for MD is <strong>always</strong> declared through a 3D array, in this case the zero third component means it is a 2D simulation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        dt                      = 0.002</span>
</pre></div>
</div>
<p>Here we define the MD time step in units of MPCD time step. As mentioned earlier in <a class="reference internal" href="#mdstep"><span class="std std-ref">here</span></a> each MPCD is divided into <code class="docutils literal notranslate"><span class="pre">&quot;stepsMD&quot;</span></code> number of MD time steps. And since <span class="math notranslate nohighlight">\(\delta t = 0.1\)</span>, <span class="math notranslate nohighlight">\(\text{d}t = \delta t / \text{stepsMD} = 0.1/50 = 0.002\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        bjerrum                 = 0</span>
<span class="c1"># parameter:        lambda_D                = 0</span>
<span class="c1"># parameter:        rCutCoul                = 0</span>
<span class="c1"># parameter:        condenseCriteria                = 0</span>
</pre></div>
</div>
<p>If the electrostatic forces are needed these prameters should be given a value. For more details please check <a class="reference internal" href="../Main/ExtraOptions.html#coulombic"><span class="std std-ref">Coulombic Potential</span></a> and <a class="reference internal" href="../Main/ExtraOptions.html#debye-huckel"><span class="std std-ref">Debye-Huckel</span></a> sections.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        kFene                   = 120.0</span>
<span class="c1"># parameter:        r0Fene                  = 1.5</span>
<span class="c1"># parameter:        kSqu                            = 0.0</span>
<span class="c1"># parameter:        kBend                           = 5.0</span>
<span class="c1"># parameter:        kNemMPC                 = 50.0</span>
</pre></div>
</div>
<p>Here we define <code class="docutils literal notranslate"><span class="pre">kFene</span></code> that is a spring constant representing the stiffness of the bonds in response to stretching and <code class="docutils literal notranslate"><span class="pre">r0Fene</span></code> that is the maximum length of the bonds connecting two monomers (for more details check <a class="reference internal" href="../Main/ExtraOptions.html#fene"><span class="std std-ref">Finitely Extensible Bonds</span></a>). <code class="docutils literal notranslate"><span class="pre">kSqu</span></code> is the spring constant for a radial squeezing force to force polymer into longitudinal configuartion, here we set it to zero. <code class="docutils literal notranslate"><span class="pre">kBend</span></code> is the parameter to modulate the bending stiffness of the polymer (it introduces a persistence lentgh to polymer, for more details check <a class="reference internal" href="../Main/ExtraOptions.html#bending-potential"><span class="std std-ref">Bond Bending Potential</span></a>). And finally <code class="docutils literal notranslate"><span class="pre">kNemMPC</span></code> which is the parameter to modulate the strength of the alignment torque that nemtaic orientation applies to the polymer backbone (<a class="reference internal" href="../Main/ExtraOptions.html#coupling-potential"><span class="std std-ref">Nematic Coupling Potential</span></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        atomMass                = (10,                  1,                              10)</span>
</pre></div>
</div>
<p>The third number specifies the mass of monomers in units of MPCD particle mass, so here each monomer is ten times heavier than MPCD particles.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">charge</span> <span class="pre">sets:</span></code> the parameters related to the charge o monomers for electrostatic forces are entered. Here, the next two lines define that there is no electrostatic force since there is no charge.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        qDensity                = (0.,                          0.,                     0.,                     0.)</span>
<span class="c1"># parameter:        qNumber                 = (0,                           0,                              0,                              0)</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">polymer</span> <span class="pre">sets:</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        polyLayout              = (LAYOUT_U)</span>
</pre></div>
</div>
<p>Sets the initial conformation of the polymer (for more options please check the <code class="docutils literal notranslate"><span class="pre">md/mdtypes.h</span></code> in MPCD directory). In this case we put a U shaped polymer in the center of the control volume.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        polyM                   = (1)</span>
<span class="c1"># parameter:        polyN                   = (10)</span>
</pre></div>
</div>
<p>These two parameters set the number of polymers and number of monomers per polymer respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        nStep                   = (0,   50000,                  5000000)</span>
</pre></div>
</div>
<p>What one should be very careful about in <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">simulation</span> <span class="pre">phases:</span></code>  is the last number for <code class="docutils literal notranslate"><span class="pre">nStep</span></code> becuase it is the maximum time step beyond which no data will be outputed from MD side and the number is in units of MD. for instance in this example, we have 2000 MPCD streaming step and each are 50 MD steps, so nStep should be at least <span class="math notranslate nohighlight">\(2000 \times 50\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        stepAvg                     = (0,       5000,                   5000)</span>
<span class="c1"># parameter:        stepHistCollect         = (0,   5000,                   5000)</span>
<span class="c1"># parameter:        stepHistPrint           = (0,   5000,                   5000)</span>
<span class="c1"># parameter:        stepSceneSlow           = (0,   5000,                   5000)</span>
<span class="c1"># parameter:        stepSceneFast           = (0,   5000,                   5000)</span>
</pre></div>
</div>
<p>Numbers in <code class="docutils literal notranslate"><span class="pre">step</span> <span class="pre">counters</span></code> section are the frequency of outputing the MD data. MD data is not very expensive, storagevise, in comparison with field outputs in MPCD. So you can output more frequently than MPCD or if you want the same number of outputs as MPCD , multiply the frequency of MPCD output by <code class="docutils literal notranslate"><span class="pre">stepsMD</span></code>. Here, it is <span class="math notranslate nohighlight">\(100 \times 50 = 5000\)</span>.</p>
</section>
</section>
<section id="id32">
<h3>Running<a class="headerlink" href="#id32" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="n">md2D</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="mi">3</span><span class="n">DCylinder</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="many-polymers">
<h2>Many polymers<a class="headerlink" href="#many-polymers" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to run a 2D nematic MPCD simulation in which several polymers are embedded. It is</p>
<ul class="simple">
<li><p>anisotropic nematic fluid</p></li>
<li><p>in 2D</p></li>
<li><p>several polymers</p></li>
<li><p>periodic boundary condition</p></li>
</ul>
<p>This tutorial is based on the input files found in <code class="docutils literal notranslate"><span class="pre">MPCD/SampleInputs/Manypolymers/{input.json,md.inp}</span></code>.</p>
<section id="id33">
<h3>Input File<a class="headerlink" href="#id33" title="Permalink to this heading">#</a></h3>
</section>
<section id="id34">
<h3>Understanding the Scripts<a class="headerlink" href="#id34" title="Permalink to this heading">#</a></h3>
<section id="id35">
<h4>input.json<a class="headerlink" href="#id35" title="Permalink to this heading">#</a></h4>
<p>Here we have used the same input.json that is used in <a class="reference internal" href="#dpolymer"><span class="std std-ref">2D polymer example</span></a>. To understand the json input file please read <a class="reference internal" href="#dpolymer-json"><span class="std std-ref">2D polymer json input</span></a>.</p>
</section>
<section id="id36">
<h4>md.inp<a class="headerlink" href="#id36" title="Permalink to this heading">#</a></h4>
<p>In order to have for instance four polymers in our system we can use the same md input file used in the <a class="reference internal" href="#dpolymer"><span class="std std-ref">2D polymer example</span></a> but the following parameters should be changed:</p>
<p>In <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">polymer</span> <span class="pre">sets:</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        polyLayout              = (LAYOUT_FLUID)</span>
</pre></div>
</div>
<p>Among the available initial conformation for polymer, only <code class="docutils literal notranslate"><span class="pre">LAYOUT_FLUID</span></code> can be used in the case of many polymers. It is becuase the other options including <code class="docutils literal notranslate"><span class="pre">LAYOUT_U</span></code>, <code class="docutils literal notranslate"><span class="pre">LAYOUT_RODX</span></code> and <code class="docutils literal notranslate"><span class="pre">LAYOUT_RODY</span></code> are positioned in the center of control volume.</p>
<p>The available initial conformations:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LAYOUT_FLUID</span></code> is a self avoiding random walk that is randomly located in the control volume.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LAYOUT_U</span></code> is a U shaped polymer in the center of the control volume.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LAYOUT_RODX</span></code> is a rod polymer along x direction in the center of the control volume.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LAYOUT_RODY</span></code> is a rod polymer along y direction in the center of the control volume.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        polyM                   = (4)</span>
<span class="c1"># parameter:        polyN                   = (5)</span>
</pre></div>
</div>
<p>These two parameters set the number of polymers and number of monomers per polymer respectively. So here, we have 4 polymers each of which has 5 monomers.</p>
<p>To understand the whole md input file please read <a class="reference internal" href="#dpolymer-inp"><span class="std std-ref">2D polymer md input</span></a>.</p>
</section>
</section>
<section id="id37">
<h3>Running<a class="headerlink" href="#id37" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="n">Manypolymers</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">Manypolymers</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="polymer-translocation">
<h2>Polymer translocation<a class="headerlink" href="#polymer-translocation" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to run a polymer translocation simulation . It is</p>
<ul class="simple">
<li><p>active nematic fluid</p></li>
<li><p>in 2D</p></li>
<li><p>one polymer</p></li>
<li><p>periodic boundary condition, with a wall in the middle on which there is a pore.</p></li>
</ul>
<p>This tutorial is based on the input files found in <code class="docutils literal notranslate"><span class="pre">MPCD/SampleInputs/polymerTranslocation/{input.json,md.inp}</span></code>.</p>
<section id="id38">
<h3>Input File<a class="headerlink" href="#id38" title="Permalink to this heading">#</a></h3>
</section>
<section id="id39">
<h3>Understanding the Scripts<a class="headerlink" href="#id39" title="Permalink to this heading">#</a></h3>
<section id="id40">
<h4>input.json<a class="headerlink" href="#id40" title="Permalink to this heading">#</a></h4>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span>           <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span>         <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Collision operator 21 is an active nematic collision operator&quot;</span><span class="p">,</span>
    <span class="s2">&quot;collOp&quot;</span><span class="p">:</span>           <span class="mi">21</span><span class="p">,</span>
    <span class="s2">&quot;lc&quot;</span><span class="p">:</span>               <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We first define the system size (<span class="math notranslate nohighlight">\(50 \times 50\)</span> in MPCd units). Then it is specified how long the simulation will run and output data. The sigmoidal sum active collision operator is uset to create active nematic fluid. For more details please check <a class="reference internal" href="../Main/ExtraOptions.html#activenematic"><span class="std std-ref">active nematic MPCD</span></a>. In order to have anisotropic fluid the <code class="docutils literal notranslate"><span class="pre">lc</span></code> is set to 1.</p>
<p>Now it is time to declare the path of the polymer input file that is the <code class="docutils literal notranslate"><span class="pre">md.inp</span></code>. For more details about how MD is coupled to MPCD please take a look at the <a class="reference internal" href="../Main/ExtraOptions.html#chapter11"><span class="std std-ref">MD</span></a> section. To keep the MD simulation stable, during one MPCD streaming step <code class="docutils literal notranslate"><span class="pre">&quot;stepsMD&quot;</span></code> number of MD time steps are run.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Location of the MD input file&quot;</span><span class="p">,</span>
<span class="s2">&quot;mdIn&quot;</span><span class="p">:</span>             <span class="s2">&quot;md.inp&quot;</span><span class="p">,</span>
<span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;Number of MD steps per MPCD step&quot;</span><span class="p">,</span>
<span class="s2">&quot;stepsMD&quot;</span><span class="p">:</span>          <span class="mi">50</span><span class="p">,</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span><span class="p">,</span>
        <span class="s2">&quot;qDist&quot;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;vDist&quot;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;oDist&quot;</span><span class="p">:</span>        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;act&quot;</span><span class="p">:</span>          <span class="mf">0.08</span><span class="p">,</span>
        <span class="s2">&quot;sigWidth&quot;</span><span class="p">:</span>     <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">&quot;sigPos&quot;</span><span class="p">:</span>       <span class="mf">0.5</span>
      <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>We say that every MPCD box should be initialized with 20 MPCD particles. Nematogens are placed randomly and freely within the control volume. Their velocities are drawn from a uniformly random distribution and all are along X axis. Activity is introduced as extensile force dipoles (positive value) with strength <code class="docutils literal notranslate"><span class="pre">0.08</span></code> (for more options please check <a class="reference internal" href="../Main/Usage.html#particleinitialization"><span class="std std-ref">Initialization</span></a>). Then the modultion parameters are set (for more options please check <a class="reference internal" href="../Main/Usage.html#modulators"><span class="std std-ref">Local activity modulators</span></a>) .</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;comment&quot;</span><span class="p">:</span>          <span class="s2">&quot;BC for a cylinder with two ends and impermeable perfect-slip walls&quot;</span><span class="p">,</span>
<span class="s2">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="o">..</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Now we define BC. (See Boundary Conditions for more details) Remember, that this needs to be between [].</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;phantom&quot;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>Now lets see how a wall with a pore in the middle of it can be created. For this purpose we can use a fixed rectangular super ellipse obstacle. The construction of a super ellipse has <span class="math notranslate nohighlight">\(p_x=p_y=p_z=p_R=n\)</span> and
<span class="math notranslate nohighlight">\(A_x=\frac{1}{a}, A_z=\frac{1}{b}, A_z=\frac{1}{c}\)</span> and radius <span class="math notranslate nohighlight">\(R\)</span>. Where the surface position’s <span class="math notranslate nohighlight">\(\vec{Q}=(Q_x,Q_y,Q_z)\)</span>.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[S(\vec{x})= \left(\frac{x-Q_x}{a}\right)^n + \left(\frac{y-Q_y}{b}\right)^n + \left(\frac{z-Q_z}{c}\right)^n  - 1 = 0\]</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A super ellipsoid provide an increasingly closer approximation to a cuboid for large positive <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>For a thorough explanation about different surfaces please check <a class="reference internal" href="../Main/Usage.html#subsection-boundarysurfaces"><span class="std std-ref">Standard surfaces</span></a>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Q&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="s2">&quot;aInv&quot;</span><span class="p">:</span>         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="s2">&quot;P&quot;</span><span class="p">:</span>            <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="s2">&quot;R&quot;</span><span class="p">:</span>            <span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>In the following we set the no-slip BCs and planar anchoring.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;MVN&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;MVT&quot;</span><span class="p">:</span>          <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;MUN&quot;</span><span class="p">:</span>          <span class="mi">0</span><span class="p">,</span>
<span class="s2">&quot;MUT&quot;</span><span class="p">:</span>          <span class="mi">1</span>
</pre></div>
</div>
<p>We now define what things we want to write out during the simulation (see output for details). We use debugOut level 3. We write out the velocity and the director field every 50 timesteps. We also include a synopsis file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;debugOut&quot;</span><span class="p">:</span>         <span class="mi">3</span><span class="p">,</span>
<span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">50</span><span class="p">,</span>
<span class="s2">&quot;dirSOut&quot;</span><span class="p">:</span>          <span class="mi">50</span><span class="p">,</span>
<span class="s2">&quot;synopsisOut&quot;</span><span class="p">:</span>      <span class="mi">1</span>
</pre></div>
</div>
<p>The end of the input file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id41">
<h4>md.inp<a class="headerlink" href="#id41" title="Permalink to this heading">#</a></h4>
<p>Here is the breakdown of the important parts of the input script that you can modify (the parts that are not explained are set values that should not be changed unless you need fundamental changes)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:    warmupMD        = 0</span>
</pre></div>
</div>
<p>The MPCD simualtion can have a warm up time during which the algorithm runs but there is no output. If there is a warm up time for MPCD, it can be chosen whether to run the MD during that warm up time or not.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if MD runs during warmup time, it outputs data.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        unitCells               = (50,50,0)</span>
</pre></div>
</div>
<p>The system size for MD is <strong>always</strong> declared through a 3D array, in this case the zero third component means it is a 2D simulation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        dt                      = 0.002</span>
</pre></div>
</div>
<p>Here we define the MD time step in units of MPCD time step. As mentioned earlier in <a class="reference internal" href="#mdstep"><span class="std std-ref">here</span></a> each MPCD is divided into <code class="docutils literal notranslate"><span class="pre">&quot;stepsMD&quot;</span></code> number of MD time steps. And since <span class="math notranslate nohighlight">\(\delta t = 0.1\)</span>, <span class="math notranslate nohighlight">\(\text{d}t = \delta t / \text{stepsMD} = 0.1/50 = 0.002\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        bjerrum                 = 0</span>
<span class="c1"># parameter:        lambda_D                = 0</span>
<span class="c1"># parameter:        rCutCoul                = 0</span>
<span class="c1"># parameter:        condenseCriteria                = 0</span>
</pre></div>
</div>
<p>If the electrostatic forces are needed these prameters should be given a value. For more details please check <a class="reference internal" href="../Main/ExtraOptions.html#coulombic"><span class="std std-ref">Coulombic Potential</span></a> and <a class="reference internal" href="../Main/ExtraOptions.html#debye-huckel"><span class="std std-ref">Debye-Huckel</span></a> sections.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        kFene                   = 120.0</span>
<span class="c1"># parameter:        r0Fene                  = 1.5</span>
<span class="c1"># parameter:        kSqu                            = 0.0</span>
<span class="c1"># parameter:        kBend                           = 0.0</span>
<span class="c1"># parameter:        kNemMPC                 = 0.0</span>
</pre></div>
</div>
<p>Here we define <code class="docutils literal notranslate"><span class="pre">kFene</span></code> that is a spring constant representing the stiffness of the bonds in response to stretching and <code class="docutils literal notranslate"><span class="pre">r0Fene</span></code> that is the maximum length of the bonds connecting two monomers (for more details check <a class="reference internal" href="../Main/ExtraOptions.html#fene"><span class="std std-ref">Finitely Extensible Bonds</span></a>). <code class="docutils literal notranslate"><span class="pre">kSqu</span></code> is the spring constant for a radial squeezing force to force polymer into longitudinal configuartion, here we set it to zero. <code class="docutils literal notranslate"><span class="pre">kBend</span></code> is the parameter to modulate the bending stiffness of the polymer (it introduces a persistence lentgh to polymer, for more details check <a class="reference internal" href="../Main/ExtraOptions.html#bending-potential"><span class="std std-ref">Bond Bending Potential</span></a>). In this case the polymer is flexible. And finally <code class="docutils literal notranslate"><span class="pre">kNemMPC</span></code> which is the parameter to modulate the strength of the alignment torque that nemtaic orientation applies to the polymer backbone (<a class="reference internal" href="../Main/ExtraOptions.html#coupling-potential"><span class="std std-ref">Nematic Coupling Potential</span></a>). Here there is no coupling to the director field , hence polymer is just coupled to the velocity field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        atomMass                = (10,                  1,                              10)</span>
</pre></div>
</div>
<p>The third number specifies the mass of monomers in units of MPCD particle mass, so here each monomer is ten times heavier than MPCD particles.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">charge</span> <span class="pre">sets:</span></code> the parameters related to the charge o monomers for electrostatic forces are entered. Here, the next two lines define that there is no electrostatic force since there is no charge.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        qDensity                = (0.,                          0.,                     0.,                     0.)</span>
<span class="c1"># parameter:        qNumber                 = (0,                           0,                              0,                              0)</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">polymer</span> <span class="pre">sets:</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        polyLayout              = (LAYOUT_RODX)</span>
</pre></div>
</div>
<p>Sets the initial conformation of the polymer (for more options please check the <code class="docutils literal notranslate"><span class="pre">md/mdtypes.h</span></code> in MPCD directory). In this case we put a rod polymer along x axis in the center of the control volume.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        polyM                   = (1)</span>
<span class="c1"># parameter:        polyN                   = (35)</span>
</pre></div>
</div>
<p>These two parameters set the number of polymers and number of monomers per polymer respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        nStep                   = (0,   50000,                  5000000)</span>
</pre></div>
</div>
<p>What one should be very careful about in <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">simulation</span> <span class="pre">phases:</span></code>  is the last number for <code class="docutils literal notranslate"><span class="pre">nStep</span></code> becuase it is the maximum time step beyond which no data will be outputed from MD side and the number is in units of MD. for instance in this example, we have 2000 MPCD streaming step and each are 50 MD steps, so nStep should be at least <span class="math notranslate nohighlight">\(1000 \times 50\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        stepAvg                     = (0,       2500,                   2500)</span>
<span class="c1"># parameter:        stepHistCollect         = (0,   2500,                   2500)</span>
<span class="c1"># parameter:        stepHistPrint           = (0,   2500,                   2500)</span>
<span class="c1"># parameter:        stepSceneSlow           = (0,   2500,                   2500)</span>
<span class="c1"># parameter:        stepSceneFast           = (0,   2500,                   2500)</span>
</pre></div>
</div>
<p>Numbers in <code class="docutils literal notranslate"><span class="pre">step</span> <span class="pre">counters</span></code> section are the frequency of outputing the MD data. MD data is not very expensive, storagevise, in comparison with field outputs in MPCD. So you can output more frequently than MPCD or if you want the same number of outputs as MPCD , multiply the frequency of MPCD output by <code class="docutils literal notranslate"><span class="pre">stepsMD</span></code>. Here, it is <span class="math notranslate nohighlight">\(50 \times 50 = 2500\)</span>.</p>
</section>
</section>
<section id="id42">
<h3>Running<a class="headerlink" href="#id42" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="n">polymerTranslocation</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">&lt;</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">polymerTranslocation</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="wavy-walls">
<span id="wavywalls"></span><h2>Wavy Walls<a class="headerlink" href="#wavy-walls" title="Permalink to this heading">#</a></h2>
<p>This tutorial demonstrates simulates a complex geometry confining a 2D active nematic fluid within a channel with periodic boundaries in the x-direction.
The confining channel walls are wavy sinusoids.
Additionally there are fixed circular obstacles between each maximum/minimum pair of the wavy walls.</p>
<p>This tutorial is based on the input file found in <code class="docutils literal notranslate"><span class="pre">MPCD/SampleInputs/wavyWalls/input.json</span></code>.</p>
<section id="id43">
<h3>Input File<a class="headerlink" href="#id43" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:[</span><span class="mi">100</span><span class="p">,</span><span class="mi">25</span><span class="p">],</span>
    <span class="s2">&quot;simSteps&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
    <span class="s2">&quot;warmUp&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;rFrame&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Active nematic fluid&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lc&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;mfpot&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;collOp&quot;</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span>
    <span class="s2">&quot;species&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;mass&quot;</span><span class="p">:</span>         <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span><span class="p">,</span>
            <span class="s2">&quot;qDist&quot;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;vDist&quot;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;oDist&quot;</span><span class="p">:</span>        <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;interMatr&quot;</span><span class="p">:</span>    <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;rfc&quot;</span><span class="p">:</span>          <span class="mf">0.01</span><span class="p">,</span>
            <span class="s2">&quot;len&quot;</span><span class="p">:</span>          <span class="mf">0.007</span><span class="p">,</span>
            <span class="s2">&quot;tumble&quot;</span><span class="p">:</span>       <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;shearSusc&quot;</span><span class="p">:</span>    <span class="mf">0.5</span><span class="p">,</span>
            <span class="s2">&quot;magnSusc&quot;</span><span class="p">:</span>     <span class="mf">0.001</span><span class="p">,</span>
            <span class="s2">&quot;act&quot;</span><span class="p">:</span>          <span class="mf">0.05</span><span class="p">,</span>
            <span class="s2">&quot;damp&quot;</span><span class="p">:</span>         <span class="mi">0</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;BC&quot;</span><span class="p">:</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Bottom wall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Top wall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Wavy bottom wall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;wavy&quot;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.31415</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Wavy top wall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;wavy&quot;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.31415</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;First fixed circular pillar&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mf">12.5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;mass&quot;</span><span class="p">:</span><span class="mf">3534.3</span><span class="p">,</span>
            <span class="s2">&quot;dsplc&quot;</span><span class="p">:</span><span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Second fixed circular pillar&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">20</span><span class="p">,</span><span class="mf">12.5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;mass&quot;</span><span class="p">:</span><span class="mf">3534.3</span><span class="p">,</span>
            <span class="s2">&quot;dsplc&quot;</span><span class="p">:</span><span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Third fixed circular pillar&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">40</span><span class="p">,</span><span class="mf">12.5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;mass&quot;</span><span class="p">:</span><span class="mf">3534.3</span><span class="p">,</span>
            <span class="s2">&quot;dsplc&quot;</span><span class="p">:</span><span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Fourth fixed circular pillar&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">60</span><span class="p">,</span><span class="mf">12.5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;mass&quot;</span><span class="p">:</span><span class="mf">3534.3</span><span class="p">,</span>
            <span class="s2">&quot;dsplc&quot;</span><span class="p">:</span><span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Fifth fixed circular pillar&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">80</span><span class="p">,</span><span class="mf">12.5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;mass&quot;</span><span class="p">:</span><span class="mf">3534.3</span><span class="p">,</span>
            <span class="s2">&quot;dsplc&quot;</span><span class="p">:</span><span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Left periodic boundary condition&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Right periodic boundary condition&quot;</span><span class="p">,</span>
            <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span>
            <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
            <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;flowOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;dirSOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;coarseOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;debugOut&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;histVortOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;histVelOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;vortCorrOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;velCorrOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;topoFieldOut&quot;</span><span class="p">:</span><span class="mi">10</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id44">
<h3>Running<a class="headerlink" href="#id44" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/&lt;</span><span class="n">code</span><span class="o">-</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">-</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="mi">02</span><span class="n">_cleanerFirstSimulation</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">&lt;</span><span class="n">output</span><span class="o">-</span><span class="n">directory</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/&lt;</span><span class="n">OUTPUT</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="id45">
<h3>Understanding the Script<a class="headerlink" href="#id45" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;domain&quot;</span><span class="p">:[</span><span class="mi">100</span><span class="p">,</span><span class="mi">25</span><span class="p">],</span>
<span class="s2">&quot;simSteps&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
<span class="s2">&quot;warmUp&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>A rectangular domain that is four times as long in the x-direction as the y-direction is used.
The simulation runs for :math`10^{5}` iterations without a warmup phase.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;lc&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;mfpot&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
<span class="s2">&quot;collOp&quot;</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span>
</pre></div>
</div>
<p>An active nematic fluid is simulated (see the tutorial on <span class="xref std std-ref">2D Active Nematics</span>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;mass&quot;</span><span class="p">:</span>         <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;dens&quot;</span><span class="p">:</span>         <span class="mi">20</span><span class="p">,</span>
        <span class="s2">&quot;qDist&quot;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;vDist&quot;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;oDist&quot;</span><span class="p">:</span>        <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;interMatr&quot;</span><span class="p">:</span>    <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;rfc&quot;</span><span class="p">:</span>          <span class="mf">0.01</span><span class="p">,</span>
        <span class="s2">&quot;len&quot;</span><span class="p">:</span>          <span class="mf">0.007</span><span class="p">,</span>
        <span class="s2">&quot;tumble&quot;</span><span class="p">:</span>       <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;shearSusc&quot;</span><span class="p">:</span>    <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;magnSusc&quot;</span><span class="p">:</span>     <span class="mf">0.001</span><span class="p">,</span>
        <span class="s2">&quot;act&quot;</span><span class="p">:</span>          <span class="mf">0.05</span><span class="p">,</span>
        <span class="s2">&quot;damp&quot;</span><span class="p">:</span>         <span class="mi">0</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Typical particle properies are used, with an activity of <code class="docutils literal notranslate"><span class="pre">&quot;act&quot;:</span> <span class="pre">0.05</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Bottom wall&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Top wall&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span>
        <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span>
    <span class="p">},</span>
</pre></div>
</div>
<p>This simulation puts a two impermeable/no-slip walls above and below the wavy walls (these are extraneous and unneeded).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Wavy bottom wall&quot;</span><span class="p">,</span>
    <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;wavy&quot;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.31415</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="p">},</span>
<span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Wavy top wall&quot;</span><span class="p">,</span>
    <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;wavy&quot;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.31415</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="p">},</span>
</pre></div>
</div>
<p>Two wavy channel walls are set.
The first is set near the bottom of the domain at <code class="docutils literal notranslate"><span class="pre">&quot;Q&quot;:[0,5,0]</span></code> (pointing up <code class="docutils literal notranslate"><span class="pre">&quot;aInv&quot;:[0,1,0],</span></code>) and the second at the top <code class="docutils literal notranslate"><span class="pre">&quot;Q&quot;:[0,20,0]</span></code> (pointing down <code class="docutils literal notranslate"><span class="pre">&quot;aInv&quot;:[0,-1,0],</span></code>).
These each have have an amplitude of 5 and a wavelength of 10 as seen from <code class="docutils literal notranslate"><span class="pre">&quot;wavy&quot;:[5,0.31415,0]</span></code> (see <strong>XXX</strong>).</p>
<div class="admonition error">
<p class="admonition-title">Error</p>
<p>Tyler CHECK THIS!!! and cite Wavy surfaces section once can add tag without screwing up others.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;First fixed circular pillar&quot;</span><span class="p">,</span>
    <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
    <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
    <span class="s2">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mf">12.5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span>
    <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;mass&quot;</span><span class="p">:</span><span class="mf">3534.3</span><span class="p">,</span>
    <span class="s2">&quot;dsplc&quot;</span><span class="p">:</span><span class="mi">0</span>
<span class="p">},</span>
<span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Second fixed circular pillar&quot;</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">},</span>
<span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Third fixed circular pillar&quot;</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">},</span>
<span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Fourth fixed circular pillar&quot;</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">},</span>
<span class="p">{</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Fifth fixed circular pillar&quot;</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">},</span>
</pre></div>
</div>
<p>Five impermeable/no-slip circular obstacles are placed in the wavy channel.
All five are identical except their location.
Their radius is <code class="docutils literal notranslate"><span class="pre">&quot;R&quot;:6</span></code> and they are fixed in place <code class="docutils literal notranslate"><span class="pre">&quot;dsplc&quot;:0</span></code>.
The nematic anchoring to their surfaces is free (<code class="docutils literal notranslate"><span class="pre">&quot;MUN&quot;:1</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;MUT&quot;:1</span></code>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">{</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Left periodic boundary condition&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
        <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Right periodic boundary condition&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;aInv&quot;</span><span class="p">:[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;R&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span>
        <span class="s2">&quot;DN&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
        <span class="s2">&quot;MVN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MVT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Finally, periodic boundary conditions (PBC) must be placed at the end of the channel in the x-direciton.
<code class="docutils literal notranslate"><span class="pre">&quot;DN&quot;:100</span></code> matches the domain size in the x-direction and the velocity and nematic-orientation of particles are not changed when they pass through the PBC.
The right-hand PBC sets <code class="docutils literal notranslate"><span class="pre">&quot;R&quot;:-100</span></code>, rather than <code class="docutils literal notranslate"><span class="pre">&quot;Q&quot;:[100,0,0]</span></code>, which would have been equivalent.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="s2">&quot;flowOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;dirSOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;coarseOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;debugOut&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;histVortOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;histVelOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;vortCorrOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;velCorrOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;topoFieldOut&quot;</span><span class="p">:</span><span class="mi">10</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Lastly, the desired resulting data is outputted and the curly bracket is closed.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../Analysis/Analysis.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Analysis</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../HardCoded/HardCoded.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Hard-coded options</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Shendruk Lab
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Tutorials</a><ul>
<li><a class="reference internal" href="#first-simulation">First simulation</a><ul>
<li><a class="reference internal" href="#input-file">Input File</a></li>
<li><a class="reference internal" href="#running">Running</a></li>
<li><a class="reference internal" href="#understanding-the-script">Understanding the Script</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overrides">Overrides</a><ul>
<li><a class="reference internal" href="#id3">Input File</a></li>
<li><a class="reference internal" href="#id4">Running</a></li>
<li><a class="reference internal" href="#id5">Understanding the Script</a></li>
</ul>
</li>
<li><a class="reference internal" href="#channel-flow">Channel flow</a><ul>
<li><a class="reference internal" href="#channelflow">Channel Flow</a></li>
<li><a class="reference internal" href="#id7">Input File</a></li>
<li><a class="reference internal" href="#id8">Understanding the Script</a></li>
<li><a class="reference internal" href="#id9">Running</a></li>
</ul>
</li>
<li><a class="reference internal" href="#colloid">Colloid</a><ul>
<li><a class="reference internal" href="#diffusing-colloid">Diffusing Colloid</a></li>
<li><a class="reference internal" href="#id11">Input File</a></li>
<li><a class="reference internal" href="#id12">Understanding the Script</a></li>
<li><a class="reference internal" href="#id13">Running</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dumbbell-swimmers">Dumbbell swimmers</a><ul>
<li><a class="reference internal" href="#swimmers">Swimmers</a></li>
<li><a class="reference internal" href="#id14">Input File</a></li>
<li><a class="reference internal" href="#id15">Understanding the Script</a></li>
<li><a class="reference internal" href="#id16">Running</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d-passive-nematic">2D Passive Nematic</a><ul>
<li><a class="reference internal" href="#id17">Input file</a></li>
<li><a class="reference internal" href="#id18">Understanding the Script</a></li>
<li><a class="reference internal" href="#running-the-script">Running the Script</a></li>
<li><a class="reference internal" href="#id19">Running</a></li>
<li><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d-active-nematic">2D Active Nematic</a><ul>
<li><a class="reference internal" href="#id20">Input file</a></li>
<li><a class="reference internal" href="#id21">Understanding the Script</a></li>
<li><a class="reference internal" href="#id22">Running the Script</a></li>
<li><a class="reference internal" href="#id23">Running</a></li>
<li><a class="reference internal" href="#id24">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d-cylinder">3D cylinder</a><ul>
<li><a class="reference internal" href="#id25">Input File</a></li>
<li><a class="reference internal" href="#id26">Understanding the Script</a></li>
<li><a class="reference internal" href="#id27">Running</a></li>
</ul>
</li>
<li><a class="reference internal" href="#flow-past-a-square-obstacle">Flow Past a ‘Square’ Obstacle</a><ul>
<li><a class="reference internal" href="#flow-past-square-obstacle">Flow past ‘square’ obstacle</a></li>
<li><a class="reference internal" href="#id28">Input File</a></li>
<li><a class="reference internal" href="#id29">Understanding the Script</a></li>
<li><a class="reference internal" href="#id30">Running</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d-polymer">2D polymer</a><ul>
<li><a class="reference internal" href="#id31">Input File</a></li>
<li><a class="reference internal" href="#understanding-the-scripts">Understanding the Scripts</a><ul>
<li><a class="reference internal" href="#input-json">input.json</a></li>
<li><a class="reference internal" href="#md-inp">md.inp</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id32">Running</a></li>
</ul>
</li>
<li><a class="reference internal" href="#many-polymers">Many polymers</a><ul>
<li><a class="reference internal" href="#id33">Input File</a></li>
<li><a class="reference internal" href="#id34">Understanding the Scripts</a><ul>
<li><a class="reference internal" href="#id35">input.json</a></li>
<li><a class="reference internal" href="#id36">md.inp</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id37">Running</a></li>
</ul>
</li>
<li><a class="reference internal" href="#polymer-translocation">Polymer translocation</a><ul>
<li><a class="reference internal" href="#id38">Input File</a></li>
<li><a class="reference internal" href="#id39">Understanding the Scripts</a><ul>
<li><a class="reference internal" href="#id40">input.json</a></li>
<li><a class="reference internal" href="#id41">md.inp</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id42">Running</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wavy-walls">Wavy Walls</a><ul>
<li><a class="reference internal" href="#id43">Input File</a></li>
<li><a class="reference internal" href="#id44">Running</a></li>
<li><a class="reference internal" href="#id45">Understanding the Script</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>