Colloids
--------

MPCD Colloids are implemented as boundaries that are able to translate and rotate in response to interactions with the fluid.
Mobile boundaries have temporally-dependent surface parameters :math:`\vec{Q}(t)` and :math:`\vec{A}(t)`.
Translational and rotational motion are supported through upating :math:`\vec{Q}(t)` and :math:`\vec{A}(t)` using the boundary's velocity and angular velocity properties :math:`\vec{v}_{b}(t)` and :math:`\vec{\omega}_{b}(t)`.

The boundary velocity and angular velocity each have three contributions

.. math::
    :name: eq:colloidvelangvel

    \vec{v}_{b}(t) = \sum_i^{N_{c*}} \left( \Delta \vec{v}_{b,i}^{\mathrm{vel}} + \Delta \vec{v}_{b,i}^\mathrm{ori} \right) + \sum_j^{N_{col*}} \Delta \vec{v}_{b,j}^{\mathrm{col}} \\
    \vec{\omega}_{b}(t) = \sum_i^{N_{c*}} \left( \Delta \vec{\omega}_{b,i}^{\mathrm{vel}} + \Delta \vec{\omega}_{b,i}^\mathrm{ori} \right) + \sum_j^{N_{col*}} \Delta \vec{\omega}_{b,j}^{\mathrm{col}}

coming from increments in the boundaries' velocity due to to conserving impulse and angular impulse between each of :math:`N_{c*}\leq N` individual particles that have had applied velocity (:math:`\mathrm{vel}`) and orientation (:math:`\mathrm{ori}`) boundary conditions.
In addition, boundaries may move into other boundaries. For each of the :math:`N_{col*}` overlapping boundaries, denoted by index :math:`j`, additional boundary rules must be applied to simulate boundary-boundary interactions.
Like particles, these also enter as corrections to the boundaries :math:`\vec{v}_{b}(t)` and :math:`\vec{\omega}_{b}(t)`, through increments denoted by (:math:`\mathrm{col}`).

.. warning::
    The current version only support mobile spherical colloids where :math:`\vec{A}(t) = \vec{A}(0)`.

Motion from velocity rules
^^^^^^^^^^^^^^^^^^^^^^^^^^

In section LINKSECTION when a particle interacts with a boundary, the velocity can be updated through the velocity shift :math:`D_{v,\hat{\nu}}` and multiplier operators :math:`M_{v,\hat{\nu}}` in the directions specified by :math:`\hat{\nu}` --- corresponding to a change in the particle's momentum (if any :math:`M_{v,\hat{\nu}}\neq 1` or :math:`D_{v,\hat{\nu}}\neq 0`).
The change of momentum of the particle over the time-step interval :math:`\delta t` can be written in terms of the particle impulse :math:`\vec{J}_i`

.. math::
    :name: eq:impulse

    \vec{p}_i(t+\delta t) - \vec{p}_i(t) = \vec{J}_i.

If the boundary is static, then the impulse is absorbed by the boundary. However,
if the boundary is mobile, then we assume impulse conservation between the particle and boundary.

HOW DOES THE IMPULSE GET CONSERVED, AND WRITE IN TERMS OF THE COEFFICIENT OF RESTITUTION
SAY SOMETHING ABOUT PARTICLES THEMSELVES NOT HAVING ANGULAR VELOCITY

NEED A PART AT THE END THAT SHOWS HOW THIS FINDS THE INCREMENT TO DELTA V^VEL AND DELTA L^VEL

Motion from orientation rules
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

The particle-boundary interactions can update the particle orientation through the multiplier operations :math:`M_{u,\hat{\nu}}` in the directions specified by :math:`\hat{\nu}`.
The reorientation of particle :math:`i` corresponds to a rotational impulse :math:`\vec{\mathcal{T}}_i` due to a change in angular momentum over time interval :math:`\delta t`.

.. math::
    :name: eq:impulse

    \vec{\omega}_i(t+\delta t) - \vec{\omega}_i(t) = \vec{\mathcal{T}}_i.

The equation has a pivot point defined at the particle position at the point on the boundary.

Similar to the velocity rules, if the boundary is static, then the rotational impulse is absorbed by the boundary.
However, if the boundary is mobile, then we assume rotational impulse conservation between the particle and boundary.
It is the rotational impulse that needs to be converted into boundary increments :math:`\Delta \vec{v}_{b,i}^\mathrm{ori}` and :math:`\Delta \vec{\omega}_{b,i}^\mathrm{ori}`.

For our mobile colloid, EQUATION can be recast into a discretised torque balance, through :math:`\mathcal{T}_i=\Gamma_i \delta t`,

.. math::
    :name: eq:impulse

    \vec{\Gamma}_i + \vec{\Gamma}_{b,i}



Motion from boundary-boundary interactions
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
