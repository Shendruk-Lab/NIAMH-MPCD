<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="MPCD usage" href="../Usage/Usage.html" /><link rel="prev" title="Input guide" href="../Input/inputFiles.html" />

    <link rel="shortcut icon" href="../_static/niamh-favicon.png"/><!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>Tutorials - NIAMH-MPCD documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">NIAMH-MPCD  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/niamh-logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">NIAMH-MPCD  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Summary/Summary.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Algorithm/Algorithm.html">Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Install/Install.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Install/Run.html">Run guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Input/inputFiles.html">Input guide</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Usage/Usage.html">MPCD usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HardCoded/HardCoded.html">Hard-coded options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Inclusions/Inclusions.html">Inclusions and solutes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ExtraTheory/ExtraTheory.html">Additional theoretical background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Outputs/Outputs.html">Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Analysis/Analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DeveloperGuide/DeveloperGuide.html">Developer’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../References/References.html">Bibliography</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="tutorials">
<span id="id1"></span><h1><a class="toc-backref" href="#id73" role="doc-backlink">Tutorials</a><a class="headerlink" href="#tutorials" title="Permalink to this heading">#</a></h1>
<p>This section contains a series of tutorials that demonstrate how to use NIAMH-MPCD for various simulations. Each tutorial includes a brief description, the input file used, and the expected output from the included <a class="reference internal" href="../Analysis/Analysis.html#analysis"><span class="std std-ref">analysis scripts</span></a>.</p>
<p>Full details of the parameters implemented in the input files can be found in the <a class="reference internal" href="../Usage/Usage.html#usagechapter"><span class="std std-ref">MPCD usage</span></a>, and the output files are described in the <a class="reference internal" href="../Outputs/Outputs.html#id1"><span class="std std-ref">Outputs</span></a> section.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The tutorials are designed are intended for educational and refence purposes only. Real simulations should be run for much longer times to obtain meaningful results and in much larger system sizes.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Here, <code class="docutils literal notranslate"><span class="pre">&lt;naimh&gt;</span></code> represents the path to the NAIMH-MPCD <code class="docutils literal notranslate"><span class="pre">mpcd.out</span></code> executable, <code class="docutils literal notranslate"><span class="pre">&lt;in-dir&gt;</span></code> represents the path to the <code class="docutils literal notranslate"><span class="pre">sampleInputs/</span></code> directory  and <code class="docutils literal notranslate"><span class="pre">&lt;out-dir&gt;</span></code> represents the path to the directory where the output files will be written. You should replace these with the actual paths on your system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The output data should not be saved in the code (or <code class="docutils literal notranslate"><span class="pre">sampleInputs/</span></code>) directory.</p>
</div>
</div>
<nav class="contents this-will-duplicate-information-and-it-is-still-useful-here" id="id2">
<p class="topic-title">Tutorials</p>
<ul class="simple">
<li><p><a class="reference internal" href="#tutorials" id="id73">Tutorials</a></p>
<ul>
<li><p><a class="reference internal" href="#first-simulation" id="id74">First simulation</a></p></li>
<li><p><a class="reference internal" href="#overrides" id="id75">Overrides</a></p></li>
<li><p><a class="reference internal" href="#channel-flow" id="id76">Channel flow</a></p></li>
<li><p><a class="reference internal" href="#rarefied-gas-and-tracer-particles" id="id77">Rarefied gas and tracer particles</a></p></li>
<li><p><a class="reference internal" href="#colloid" id="id78">Colloid</a></p></li>
<li><p><a class="reference internal" href="#tadpole-swimmers" id="id79">TADPole swimmers</a></p></li>
<li><p><a class="reference internal" href="#d-passive-nematic" id="id80">2D Passive Nematic</a></p></li>
<li><p><a class="reference internal" href="#d-active-nematic" id="id81">2D Active Nematic</a></p></li>
<li><p><a class="reference internal" href="#d-pipe-flow" id="id82">3D pipe flow</a></p></li>
<li><p><a class="reference internal" href="#flow-past-a-square-obstacle" id="id83">Flow past a ‘square’ obstacle</a></p></li>
<li><p><a class="reference internal" href="#d-polymer" id="id84">2D polymer</a></p></li>
<li><p><a class="reference internal" href="#many-polymers" id="id85">Many polymers</a></p></li>
<li><p><a class="reference internal" href="#polymer-translocation" id="id86">Polymer translocation</a></p></li>
<li><p><a class="reference internal" href="#wavy-walls" id="id87">Wavy Walls</a></p></li>
<li><p><a class="reference internal" href="#extra-tutorials" id="id88">Extra Tutorials</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="first-simulation">
<span id="isoptropic"></span><h2><a class="toc-backref" href="#id74" role="doc-backlink">First simulation</a><a class="headerlink" href="#first-simulation" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to run the most basic MPCD simulation conceivable:</p>
<ul class="simple">
<li><p>an isotropic fluid</p></li>
<li><p>in 2D</p></li>
<li><p>with no flow or external forces</p></li>
<li><p>and no solutes</p></li>
<li><p>contained within periodic boundary conditions.</p></li>
</ul>
<p>This is simply a thermalized fluid to introduce how the input files works for first time users.</p>
<section id="input-file">
<h3>Input File<a class="headerlink" href="#input-file" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input file found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/01_FirstSimulation_PassiveIsotropic2D/input.json">MPCD/SampleInputs/01_FirstSimulation_PassiveIsotropic2D/input.json</a>.</p>
</section>
<section id="running">
<h3>Running<a class="headerlink" href="#running" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="mi">01</span><span class="n">_FirstSimulation_PassiveIsotropic2D</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="understanding-the-script">
<h3>Understanding the script<a class="headerlink" href="#understanding-the-script" title="Permalink to this heading">#</a></h3>
<p>In this first script, many options are being included for the purpose of introducing them — in future tutorials and when users create their own scripts, often default values will be used and so the arguments can be left out.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This tutorial goes through this basic input script line-by-line to explain each argument.</p>
</div>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;SIMULATION-SCALE INPUTS&quot;</span><span class="p">,</span>
</pre></div>
</div>
<p>The input arguments must all be contained between curly brackets <code class="docutils literal notranslate"><span class="pre">{}</span></code> — The first line is the opening bracket.
Arguments are given in quotation marks <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>, followed by a colon <code class="docutils literal notranslate"><span class="pre">:</span></code> then the argument and concluded with a comma <code class="docutils literal notranslate"><span class="pre">,</span></code> to indicate that an subsequent argument will follow.
<code class="docutils literal notranslate"><span class="pre">&quot;comment&quot;</span></code> is an example tag, which allows users to comment their input scripts, for their own reference.
If a given argument does not exist then the simulation will exit and give the warning</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">JSON</span> <span class="n">Read</span> <span class="ne">Warning</span><span class="p">:</span> <span class="n">Found</span> <span class="n">unrecognised</span> <span class="n">json</span> <span class="n">tag</span><span class="p">:</span> <span class="n">commental</span><span class="o">.</span> <span class="n">Tag</span> <span class="n">will</span> <span class="n">be</span> <span class="n">ignored</span><span class="o">.</span>
<span class="n">JSON</span> <span class="n">Read</span> <span class="n">Error</span><span class="p">:</span> <span class="n">Errors</span> <span class="n">found</span><span class="o">.</span>
</pre></div>
</div>
<p>Comments can be left using the tags <code class="docutils literal notranslate"><span class="pre">&quot;comment&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;c&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;//&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;#&quot;</span></code>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">],</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../Usage/Usage.html#systemdomain"><span class="std std-ref">domain</span></a> is set to <span class="math notranslate nohighlight">\(50\times50\)</span>.
The dimensionality is determined to be 2D from the length of the domain array.
A 3D simulation of a <span class="math notranslate nohighlight">\(30\times30\times30\)</span> domain would instead set</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">],</span>
</pre></div>
</div>
<p>A 2D rectangular system of <span class="math notranslate nohighlight">\(30\times120\)</span> domain would instead set</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">120</span><span class="p">],</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting the domain for the simulation <strong>does not</strong> set the boundary conditions.
Boundary conditions must be set independently, later in the <code class="docutils literal notranslate"><span class="pre">.json</span></code> file.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">1000</span><span class="p">,</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../Usage/Usage.html#simsteps"><span class="std std-ref">number of simulations steps</span></a> tells the simulation how many iterations to loop over.
This value should be an integer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;simSteps&quot;</span></code> is in iterations/steps, <strong>not the time in MPCD units</strong> τ (see <a class="reference internal" href="../Algorithm/Algorithm.html#derivedunits"><span class="std std-ref">Derived units</span></a>).</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;warmUp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>The code can also run for <a class="reference internal" href="../Usage/Usage.html#warmup"><span class="std std-ref">warmup phase</span></a> (for a number of iterations <code class="docutils literal notranslate"><span class="pre">&quot;warmUp&quot;</span></code>) prior to the productions phase (of <code class="docutils literal notranslate"><span class="pre">&quot;simSteps&quot;</span></code> <a class="reference internal" href="../Usage/Usage.html#simsteps"><span class="std std-ref">iterations</span></a>).
In the warmup phase, the simulation runs but results are not outputted, allowing the simulation to achieve equilibrium or steady state prior to writing data.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;dt&quot;</span><span class="p">:</span><span class="w">               </span><span class="mf">0.1</span><span class="p">,</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../Usage/Usage.html#timestep"><span class="std std-ref">streaming time step</span></a> <code class="docutils literal notranslate"><span class="pre">&quot;dt&quot;</span></code> in MPCD units (see <a class="reference internal" href="../Algorithm/Algorithm.html#derivedunits"><span class="std std-ref">Derived units</span></a>).
Varying the streaming time, will modify the (see <a class="reference internal" href="../ExtraTheory/ExtraTheory.html#chaptervisc"><span class="std std-ref">transport coefficients</span></a>).</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;collOp&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>To set the <a class="reference internal" href="../Usage/Usage.html#chaptercollop"><span class="std std-ref">MPCD collision operator</span></a> one uses the tag <code class="docutils literal notranslate"><span class="pre">&quot;collOp&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;rTech&quot;</span></code> (which are aliases).
By choosing <code class="docutils literal notranslate"><span class="pre">2</span></code> here, the collision operator is being set to the basic <a class="reference internal" href="../Usage/Usage.html#andersen"><span class="std std-ref">Andersen-thermostatted MPCD operator</span></a>.
Many other options are available, including <a class="reference internal" href="../Usage/Usage.html#srd"><span class="std std-ref">SRD</span></a> (<code class="docutils literal notranslate"><span class="pre">&quot;collOp&quot;:</span> <span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>), <a class="reference internal" href="../Usage/Usage.html#andersen"><span class="std std-ref">angular-conserving Andersen thermostatted MPCD</span></a> (<code class="docutils literal notranslate"><span class="pre">&quot;collOp&quot;:</span> <span class="pre">3</span></code>) and <a class="reference internal" href="../Usage/Usage.html#chaptercollop"><span class="std std-ref">others</span></a>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;seed&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>The simulation requires a <a class="reference internal" href="../Usage/Usage.html#seed"><span class="std std-ref">seed</span></a> since the collision operators stochastically exchange properties between particles within the same cell, which means MPCD relies heavily on generating random numbers.
Setting <code class="docutils literal notranslate"><span class="pre">&quot;seed&quot;:</span> <span class="pre">0</span></code> generates a ‘random’ random seed by combing microseconds from the clock and the process id.
If one wishes to repeat a simulation exactly, they can set random seed by hand.
The seed used by a simulation is written to <code class="docutils literal notranslate"><span class="pre">synopsis.dat</span></code> (see <a class="reference internal" href="../Outputs/Outputs.html#id1"><span class="std std-ref">Outputs</span></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="o">&lt;</span><span class="n">arguments</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>To set the <a class="reference internal" href="../Usage/Usage.html#chapterparticles"><span class="std std-ref">particle properties</span></a>, the particles are divided into species.
For multiphase flows (see <a class="reference internal" href="../Usage/Usage.html#chapterparticles"><span class="std std-ref">Multiphase</span></a>), the simulation can include multiple species, but typically only a single fluid species is required.
Within <code class="docutils literal notranslate"><span class="pre">&quot;species&quot;</span></code>, the particle properties and initializations are specified.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;pop&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">50000</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&quot;pop&quot;</span></code> sets the <a class="reference internal" href="../Usage/Usage.html#population"><span class="std std-ref">total number of particles of this species type</span></a> in the simulation.
Since the simulation volume is <span class="math notranslate nohighlight">\(50\times50\)</span>, this produces a density of <code class="docutils literal notranslate"><span class="pre">20</span></code> particles per cell.
A density of <code class="docutils literal notranslate"><span class="pre">20</span></code> particles per MPCD cell is a standard choice (earlier studies would previously use <code class="docutils literal notranslate"><span class="pre">5</span></code>). <code class="docutils literal notranslate"><span class="pre">&quot;dens&quot;</span></code> is an alternative to <code class="docutils literal notranslate"><span class="pre">&quot;pop&quot;</span></code> for setting the average cell density (see <a class="reference internal" href="#overrides"><span class="std std-ref">Overrides</span></a>).</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;mass&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../Usage/Usage.html#mass"><span class="std std-ref">mass</span></a> of individual MPCD particles is set by <code class="docutils literal notranslate"><span class="pre">&quot;mass&quot;</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The MPCD particle mass is a <strong>fundamental unit</strong> (see <a class="reference internal" href="../Algorithm/Algorithm.html#set-values"><span class="std std-ref">Fundamental units</span></a>).
Like thermal energy <span class="math notranslate nohighlight">\(k_\text{B}T\)</span> and cell size <span class="math notranslate nohighlight">\(a\)</span>, mass should <em>always</em> be set to unity.
However, to allow <a class="reference internal" href="../Usage/Usage.html#chapterparticles"><span class="std std-ref">multiphase fluids</span></a> to have different material properties it is technically allowed to vary.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;vDist&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">0</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>In addition to setting the properties of the species, the initializations are also set here.
MPCD quickly thermalizes and so the choice for the initial velocity distribution should have little consequence.
Here, the <a class="reference internal" href="../Usage/Usage.html#velocity"><span class="std std-ref">initial velocity distribution</span></a> is given the typical choice of <code class="docutils literal notranslate"><span class="pre">&quot;vDist&quot;:</span> <span class="pre">0</span></code> for isotropically random. The choice <code class="docutils literal notranslate"><span class="pre">4</span></code> for Gaussian distributions of the components is also common.
Because this is the last argument within this <cite>“species”</cite>, there is no comma at the end of this line.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All of the species arguments given above are the <strong>DEFAULT</strong>; therefore, they are all extraneous and could have been completely left out.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="o">&lt;</span><span class="n">arguments</span> <span class="k">for</span> <span class="n">first</span> <span class="n">BC</span><span class="o">&gt;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="o">&lt;</span><span class="n">arguments</span> <span class="k">for</span> <span class="mi">2</span><span class="n">nd</span> <span class="n">BC</span><span class="o">&gt;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="o">&lt;</span><span class="n">arguments</span> <span class="k">for</span> <span class="mi">3</span><span class="n">rd</span> <span class="n">BC</span><span class="o">&gt;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="o">&lt;</span><span class="n">arguments</span> <span class="k">for</span> <span class="mi">4</span><span class="n">th</span> <span class="n">BC</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>In this example, there are four boundary conditions (BC), each given as an element of the array set by the argument <code class="docutils literal notranslate"><span class="pre">&quot;BC&quot;</span></code>.
Boundary coditions must always be set to contain the domain (though overrides exist for convienence, see <a class="reference internal" href="#overrides"><span class="std std-ref">Overrides</span></a>).
In this case, four periodic boundary conditions (PBC) are set at the edges of the domain.
The first BC is the left-hand PBC.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Q&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;aInv&quot;</span><span class="p">:</span><span class="w">         </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;P&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
</pre></div>
</div>
<p>As described in <a class="reference internal" href="../Usage/Usage.html#chapterbc"><span class="std std-ref">Boundary conditions</span></a>, boundaries are composed of (i) <a class="reference internal" href="../Usage/Usage.html#subsection-boundarysurfaces"><span class="std std-ref">surfaces</span></a> and (ii) <a class="reference internal" href="../Usage/Usage.html#subsection-boundaryrules"><span class="std std-ref">rules</span></a>.
The arguments above set the <a class="reference internal" href="../Usage/Usage.html#subsection-boundarysurfaces"><span class="std std-ref">boundary surface</span></a> for a planar surface:</p>
<ul class="simple">
<li><p>No <a class="reference internal" href="../Usage/Usage.html#ghosts"><span class="std std-ref">phantom particles</span></a> are required for PBCs.</p></li>
<li><p><a class="reference internal" href="../Usage/Usage.html#standardsurfaces"><span class="std std-ref">Position vector</span></a> <code class="docutils literal notranslate"><span class="pre">&quot;Q&quot;</span></code>. Here, the left-hand PBC passes through the origin.</p></li>
<li><p><a class="reference internal" href="../Usage/Usage.html#standardsurfaces"><span class="std std-ref">Inverse of the surface normal</span></a> <code class="docutils literal notranslate"><span class="pre">&quot;aInv&quot;</span></code>. The inverse is used because it is more convienent for ellipses and similar surfaces, while equivalent to the normal itself for planes and spheres. Here, the left-hand BC has a surface normal pointing in the +x direction. The sign matters since particles on the positive side of a surface are in accessible space, while particles on the negative side will trigger the <a class="reference internal" href="../Usage/Usage.html#subsection-boundaryrules"><span class="std std-ref">boundary rules</span></a>.</p></li>
<li><p><a class="reference internal" href="../Usage/Usage.html#standardsurfaces"><span class="std std-ref">Power on the terms in the surface equation</span></a> <code class="docutils literal notranslate"><span class="pre">&quot;P&quot;</span></code> for the x-, y- and z-components and the constant term. Powers of <code class="docutils literal notranslate"><span class="pre">1</span></code> correspond to a plane, <code class="docutils literal notranslate"><span class="pre">2</span></code> to a sphere or ellipsoid, etc… Here, the planar PBC has powers of <code class="docutils literal notranslate"><span class="pre">1</span></code> on all terms.</p></li>
<li><p>The constant term <code class="docutils literal notranslate"><span class="pre">&quot;R&quot;</span></code>, typically employed for the <a class="reference internal" href="../Usage/Usage.html#standardsurfaces"><span class="std std-ref">radius of spheres</span></a>. Here, it is zero.</p></li>
</ul>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">50</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span>
<span class="w">    </span><span class="p">},</span>
</pre></div>
</div>
<p>As described in <a class="reference internal" href="../Usage/Usage.html#subsection-boundaryrules"><span class="std std-ref">Boundary rules</span></a>, when a particle impinges on a boundary surface, a set of rules will be applied to the particle.</p>
<ul class="simple">
<li><p>For PBCs, particle position is shifted in the normal direction as set by <code class="docutils literal notranslate"><span class="pre">&quot;DN&quot;</span></code>. The value should match the system size in the normal direction, which in this case is <code class="docutils literal notranslate"><span class="pre">50</span></code>.</p></li>
<li><p>For PBCs, particle position is <em>not</em> shifted in the tangential direction and so <code class="docutils literal notranslate"><span class="pre">&quot;DT&quot;:</span> <span class="pre">0</span></code>.</p></li>
<li><dl class="simple">
<dt>Similarly, PBCs do not modify particle velocity; therefore, the multiplicative factors on the velocity are set to unity:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;MVN&quot;</span></code> is the multiplicative factor in normal direction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;MVT&quot;</span></code> is the multiplicative factor in tangential direction.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;c&quot;</span><span class="p">:</span><span class="w">            </span><span class="s2">&quot;Right PBC&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Q&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;aInv&quot;</span><span class="p">:</span><span class="w">         </span><span class="p">[</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;P&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">50</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;c&quot;</span><span class="p">:</span><span class="w">            </span><span class="s2">&quot;Bottom wall&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Q&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;aInv&quot;</span><span class="p">:</span><span class="w">         </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;P&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">50</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;c&quot;</span><span class="p">:</span><span class="w">            </span><span class="s2">&quot;Top wall&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Q&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;aInv&quot;</span><span class="p">:</span><span class="w">         </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;P&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">50</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>The other three BCs are the same but must pass through appropriate points by setting <code class="docutils literal notranslate"><span class="pre">&quot;Q&quot;</span></code> and have surface normals that point in the correct (signed) directions by setting <code class="docutils literal notranslate"><span class="pre">&quot;aInv&quot;</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There exists an <a class="reference internal" href="#overrides"><span class="std std-ref">override</span></a> to conveniently set:</p>
<ul class="simple">
<li><dl class="simple">
<dt>PBCs</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;domainWalls&quot;:1</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>impermeable, no-slip planar walls</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;domainWalls&quot;:0</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>which match the simulation domain size <code class="docutils literal notranslate"><span class="pre">&quot;domain&quot;</span></code>.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;synopsisOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.json</span></code> input file also sets the outputs.
There are many optional outputs things that can be outputted but one should never output all possible outputs.
However, one option that should always be outputted is the <a class="reference internal" href="../Outputs/Outputs.html#synposisout"><span class="std std-ref">synopsis file</span></a>.
This little text file reports all the inputs the code has used, as well as summary information about the simulation.
The <code class="docutils literal notranslate"><span class="pre">synopsis.dat</span></code> file allows users to directly check if the simulation is really what was intended.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;debugOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">3</span><span class="p">,</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&quot;debugOut&quot;</span></code> specifies the <a class="reference internal" href="../Usage/Usage.html#debugout"><span class="std std-ref">verbosity with which information is writen to the terminal</span></a>.
When running small local simulations, one might want a little (such as the current time step; <code class="docutils literal notranslate"><span class="pre">''debugOut&quot;:</span> <span class="pre">3</span></code>) but when generating data for long simulations or running on a cluster, one might not want any (<code class="docutils literal notranslate"><span class="pre">''debugOut&quot;:</span> <span class="pre">0</span></code>)</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;checkpointTimerOut&quot;</span><span class="p">:</span><span class="w">    </span><span class="mf">0.0056</span><span class="p">,</span>
</pre></div>
</div>
<p>All outputting up to this point, use flags, while all other outputs are <strong>not</strong> outputted if zero and outputted at a frequency determined by their value numerical value.
For example, the simulation is <a class="reference internal" href="../Outputs/Outputs.html#checkpointing"><span class="std std-ref">checkpointTimerOut</span></a> every 0.0056 hours.
These are given in iterations, not in MPCD time units.</p>
<p>Checkpointing dumps <em>all</em> simulation information so that the simulation can be restarted from a fail point.
Checkpointing should be used sparingly since writing this data takes computational time and the resulting checkpoint files are large.
This is only recommended for simulations that will take substantially longer than a week.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;avVelOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">10</span><span class="p">,</span>
<span class="nt">&quot;energyOut&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">10</span><span class="p">,</span>
<span class="nt">&quot;densSDOut&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">10</span><span class="p">,</span>
</pre></div>
</div>
<p>These three arguments output <a class="reference internal" href="../Outputs/Outputs.html#avout"><span class="std std-ref">system averages</span></a>, including the average velocity <code class="docutils literal notranslate"><span class="pre">&quot;avVelOut&quot;</span></code>, contributions to energy <code class="docutils literal notranslate"><span class="pre">&quot;energyOut&quot;</span></code> and Standard deviation of density <code class="docutils literal notranslate"><span class="pre">&quot;densSDOut&quot;</span></code> every 10 iterations”.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;velOut&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">50</span><span class="p">,</span>
<span class="nt">&quot;pressureOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>These two arguments output two <a class="reference internal" href="../Outputs/Outputs.html#fieldsout"><span class="std std-ref">instantaneous fields</span></a>: the instantaneous velocity field <code class="docutils literal notranslate"><span class="pre">&quot;velOut&quot;</span></code> and the pressure field <code class="docutils literal notranslate"><span class="pre">&quot;pressureOut&quot;</span></code>. Since <code class="docutils literal notranslate"><span class="pre">&quot;pressureOut&quot;</span></code> is set to zero, it is not outputted (this line is redundant since zero is the default).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Fields are much larger data files than global values and so one should choose the output rate appropriately.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;histSpeedOut&quot;</span><span class="p">:</span><span class="w">     </span><span class="mi">100</span><span class="p">,</span>
<span class="nt">&quot;histNOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">100</span><span class="p">,</span>
</pre></div>
</div>
<p><a class="reference internal" href="../Outputs/Outputs.html#histout"><span class="std std-ref">Histograms</span></a> can be outputted as well.
Here, the speed <code class="docutils literal notranslate"><span class="pre">&quot;histSpeedOut&quot;</span></code> and density <code class="docutils literal notranslate"><span class="pre">&quot;histNOut&quot;</span></code> are output every 100 time steps.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The distribution of instantaneous values for the 100th step are outputted (non-cumulative).
Therefore, the instantaneous range will vary slightly between output times and the ranges must be merged to produce a time averaged distribution.
One example of doing this for scalar values is available in <code class="docutils literal notranslate"><span class="pre">/analysisScripts/probDistScalar.py</span></code> and for vector values in <code class="docutils literal notranslate"><span class="pre">/analysisScripts/probDistVector.py</span></code></p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;velCorrOut&quot;</span><span class="p">:</span><span class="w">       </span><span class="mi">100</span><span class="p">,</span>
<span class="nt">&quot;densCorrOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">100</span>
</pre></div>
</div>
<p>A variety of <strong>spatial</strong> <a class="reference internal" href="../Outputs/Outputs.html#corrout"><span class="std std-ref">autocorrelation functions</span></a> can be out putted. Here, the velocity-velocity and density-densioty spatial autocorrelation functions are output every 100 time steps.
Autocorrelation functions are relatively costly to calculate so beware of outputting these overly frequently.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Spatial correlation functions are build into the code but temporal correlation functions are not, because the code does not preserve past states.
Users must calculate temporal correlation functions from outputted data using their own analysis routines.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>Finally, the closing bracket for the arguments must end the file.
Also note there should be no comma after the final argument (in this example <code class="docutils literal notranslate"><span class="pre">&quot;densCorrOut&quot;:</span> <span class="pre">100</span></code>)</p>
</section>
<section id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this heading">#</a></h3>
<p>How to use the provided analysis scripts is described in <a class="reference internal" href="../Analysis/Analysis.html#analysis"><span class="std std-ref">Analysis</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Analysis scripts are provided primarily to quickly verify simulation output for first time users, and to give an example of how to parse MPCD’s output files.
Users are expected to develop their own analysis scripts appropriate for their own purposes.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">shendrukGroupFormat.py</span></code> script is not included in the repository, but is available on the <a class="reference external" href="https://github.com/Shendruk-Lab/shendruk-group-style">Shendruk-Lab GitHub page</a>. It requires a matplotlib style sheet to be installed. Follow the <a class="reference external" href="https://github.com/Shendruk-Lab/shendruk-group-style/blob/main/README.md">readme instructions</a> to install it.</p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Paths are <strong>not</strong> given in the terminal commands. You must give the path to the <code class="docutils literal notranslate"><span class="pre">/analysisScripts</span></code> directory and the path to where the outputted data was written.</p>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/flowFieldAnimator.py velfield.dat input.json 0 99999 z -a auto</span>
<span class="go">python3 analysisScripts/densityAnimator.py coarsegrain.dat input.json 0 99999 z 0 -a auto</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/velSnapshot.png"><img alt="../_images/velSnapshot.png" src="../_images/velSnapshot.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/densitySnapshot.png"><img alt="../_images/densitySnapshot.png" src="../_images/densitySnapshot.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/probDistScalar.py distDens.dat density 0 9999999 -m 1 -a 1</span>
<span class="go">python3 analysisScripts/probDistScalar.py distSpeed.dat &#39;Speed, $|v|$&#39; 0 9999999 -a 1</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/distDens_av.png"><img alt="../_images/distDens_av.png" src="../_images/distDens_av.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/distSpeed_av.png"><img alt="../_images/distSpeed_av.png" src="../_images/distSpeed_av.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/autocorrPlotter.py corrDensDens.dat &#39;Density, $\rho$&#39; 0 9999999 -a 1 -m 1</span>
<span class="go">python3 analysisScripts/autocorrPlotter.py corrVelVel.dat &#39;Velocity, $\vec{v}$&#39; 0 9999999 -a 1 -m 1</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/corrDensDens_av.png"><img alt="../_images/corrDensDens_av.png" src="../_images/corrDensDens_av.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/corrVelVel_av.png"><img alt="../_images/corrVelVel_av.png" src="../_images/corrVelVel_av.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/ensAvPlotter.py energy.dat &#39;Energy, $E$&#39; -c 5</span>
<span class="go">python3 analysisScripts/ensAvPlotter.py avVel.dat &#39;Velocity, $\vec{v}$&#39; -c 1 2 3</span>
<span class="go">python3 analysisScripts/ensAvPlotter.py densSTD.dat &#39;St.Dev. Density, $\sigma_\rho$&#39; -c 1</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 33.3%" />
<col style="width: 33.3%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/energy_av.png"><img alt="../_images/energy_av.png" src="../_images/energy_av.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/avVel_av.png"><img alt="../_images/avVel_av.png" src="../_images/avVel_av.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/densSTD_av.png"><img alt="../_images/densSTD_av.png" src="../_images/densSTD_av.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="overrides">
<span id="id3"></span><h2><a class="toc-backref" href="#id75" role="doc-backlink">Overrides</a><a class="headerlink" href="#overrides" title="Permalink to this heading">#</a></h2>
<p>This tutorial repeats the same simulation as <a class="reference internal" href="#isoptropic"><span class="std std-ref">First simulation</span></a> <strong>but</strong> uses a much cleaner input file, that utilizes <em>defaults</em> and <em>overrides</em> for clarity.
Users’ actual input files are expected to more frequently look like the file used here.</p>
<section id="id4">
<h3>Input File<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input file found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/02_cleanerFirstSimulation/input.json">MPCD/SampleInputs/02_cleanerFirstSimulation/input.json</a>.</p>
</section>
<section id="id5">
<h3>Running<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="mi">02</span><span class="n">_cleanerFirstSimulation</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id6">
<h3>Understanding the script<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">2000</span><span class="p">,</span>
</pre></div>
</div>
<p>The input arguments are contained between curly brackets <code class="docutils literal notranslate"><span class="pre">{}</span></code> — The first line is the opening bracket.
The system wide inputs set here are <code class="docutils literal notranslate"><span class="pre">&quot;domain&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;simSteps&quot;</span></code>.
All other arguments take their default values (an isotropic fluid using the :ref:<code class="docutils literal notranslate"><span class="pre">basic</span> <span class="pre">Andersen-thermostatted</span> <span class="pre">collision</span> <span class="pre">operator</span> <span class="pre">&lt;Andersen&gt;</span></code>).
In fact, even the <code class="docutils literal notranslate"><span class="pre">&quot;domain&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;simSteps&quot;</span></code> are set to their default values but users are always expected to run larger and longer simulations when doing research.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;&#39;&#39;dens&#39;&#39; overides the &#39;&#39;pop&#39;&#39; argument to set the desired number density&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;dens&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">20</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Next are the fluid particle properties.
This is a single species with all default values.
Except the <code class="docutils literal notranslate"><span class="pre">&quot;dens&quot;</span></code> <strong>override</strong> argument is used to set the average number of MPCD particles per accessible MPCD cell rather than the total population.
Here the number density is set to <code class="docutils literal notranslate"><span class="pre">20</span></code>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="nt">&quot;domainWalls&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Next the boundary conditions are set.
In this example, simple periodic boundary conditions are required and therefore an override can be employed.
<code class="docutils literal notranslate"><span class="pre">&quot;domainWalls&quot;:</span> <span class="pre">1</span></code> creates four periodic boundaries around the domain in 2D and six in 3D.
If one wishes to run a simulation inside impermeable/no-slip walls, then <code class="docutils literal notranslate"><span class="pre">&quot;domainWalls&quot;:</span> <span class="pre">0</span></code> can override the boundaries.
All other boundaries/geometries must be created boundary-surface-by-boundary-surface.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Additional boundaries can be added <strong>after</strong> the <code class="docutils literal notranslate"><span class="pre">&quot;domainWalls&quot;</span></code> override.
In this way, solid obstacles or mobile colloids can be suspended within the domain with PBCs or impermeable/no-slip BCs.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;checkpointOut&quot;</span><span class="p">:</span>    <span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;checkpointTimerOut&quot;</span><span class="p">:</span>    <span class="mf">0.0056</span><span class="p">,</span>
</pre></div>
</div>
<p>Rather than setting the checkpointing to a number of iterations (here set to every time step), <code class="docutils literal notranslate"><span class="pre">&quot;checkpointTimerOut&quot;</span></code> overwrites it to output based on a timer, outputting with a period of the value in hours.
Here <code class="docutils literal notranslate"><span class="pre">0.0056</span></code> hours is about every 20 seconds.
This is an extremely small value that should never be used in practice.
Rather checkpointing should be used for long simulations that last for longer than a week in order to backup the simulation and offer a point for restarting it (so <code class="docutils literal notranslate"><span class="pre">&quot;checkpointTimerOut&quot;</span></code> should be comparable to <code class="docutils literal notranslate"><span class="pre">100</span></code>.)</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;checkpointOut&quot;</span></code> must be non-zero in the input script and then <code class="docutils literal notranslate"><span class="pre">&quot;checkpointTimerOut&quot;</span></code> must override its value.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="s2">&quot;avVelOut&quot;</span><span class="p">:</span>         <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;energyOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;densSDOut&quot;</span><span class="p">:</span>        <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;flowOut&quot;</span><span class="p">:</span>          <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;histSpeedOut&quot;</span><span class="p">:</span>     <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;histNOut&quot;</span><span class="p">:</span>         <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;velCorrOut&quot;</span><span class="p">:</span>       <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;densCorrOut&quot;</span><span class="p">:</span>      <span class="mi">100</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally the output is specified.
The default output is <code class="docutils literal notranslate"><span class="pre">0</span></code> (meaning that the quantity is not outputted) for all outputs, except <code class="docutils literal notranslate"><span class="pre">&quot;synopsisOut&quot;</span></code>, which should always be outputted.</p>
</section>
<section id="id7">
<h3>Output<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<p>The output is the same as <a class="reference internal" href="#isoptropic"><span class="std std-ref">First simulation</span></a>.</p>
</section>
</section>
<section id="channel-flow">
<h2><a class="toc-backref" href="#id76" role="doc-backlink">Channel flow</a><a class="headerlink" href="#channel-flow" title="Permalink to this heading">#</a></h2>
<section id="channelflow">
<span id="id8"></span><h3>Channel Flow<a class="headerlink" href="#channelflow" title="Permalink to this heading">#</a></h3>
<p>This tutorial will show to generate a flow in a 2D channel with a pressure gradient driven by gravity. No-slip boundary conditions on the bottom and top walls, periodic boundary conditions on the ends.</p>
</section>
<section id="id9">
<h3>Input File<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input file found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/channelFlow/input.json">MPCD/SampleInputs/ChannelFlow/input.json</a>.</p>
</section>
<section id="id10">
<h3>Running<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="n">ChannelFlow</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id11">
<h3>Understanding the script<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Rectangular geometry&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">90</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;warmUp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">100</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">5000</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;collOp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>We define the system size (90 by 30 in MPCd simulations), and we define how long the system takes to initialize and for how long than the system will actually run and output (at least 3000). We will see from the output that the warmup time should be much longer. We also define the collision operator for the MPCD fluid.In this case, we model an Isotropic fluid.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Gravity-generated pressure gradient&quot;</span><span class="p">,</span>
<span class="nt">&quot;grav&quot;</span><span class="p">:</span><span class="w">             </span><span class="p">[</span><span class="mf">0.003</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
</pre></div>
</div>
<p>We say that every box experiences a constant force along the x direction, which mimics a body force like gravity. This indirectly induces a pressure gradient.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;dens&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">20</span>
<span class="w">      </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>We say that every MPCD box should be initialized with 20 MPC particles.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;debugOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">3</span><span class="p">,</span>
<span class="nt">&quot;flowOut&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">100</span><span class="p">,</span>
<span class="nt">&quot;pressureOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">0</span><span class="p">,</span>
<span class="nt">&quot;avVelOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">10</span><span class="p">,</span>
<span class="nt">&quot;energyOut&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">10</span><span class="p">,</span>
<span class="nt">&quot;synopsisOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
<span class="nt">&quot;checkpointOut&quot;</span><span class="p">:</span><span class="w">    </span><span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>We now define what things we want to write out during the simulation (see output for details). We use debugOut level 3. We write out the flow field every 20 timesteps, and the average velocity and energy of the system every 10 minutues.
We don’t write out the pressure, but that can be turned on. We also include a synopsis file, but don’t do checkpoint checks.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;BCs are two periodic boundary conditions (PBC) and two impermeable, no-slip walls&quot;</span><span class="p">,</span>
<span class="nt">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
</pre></div>
</div>
<p>Now we define BC. (See Boundary Conditions for more details) Remember, that this needs to be between []. We will define 4 different boundaries, corresponding to the four different borders of our simulation.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;Left PBC&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Q&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;aInv&quot;</span><span class="p">:</span><span class="w">         </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;P&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">90</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span>
<span class="p">},</span>
</pre></div>
</div>
<p>The first boundary on the left side. We have PBC, and hence we don’t have phantom particles. We need to define the surface parameters Q, aInv, P and R for this boundary (See boundary conditions for more details).
We define its position as intersecting at the [0,0,0] point and for a plane yz-plane, we define the normal aInv=[1, 0, 0]. In addition, to construct a plane, we set p=[1,1,1,1].
Lastly, because this is a plane, our radius is set to R=0.</p>
<p>Particles passing through this interface need to be displaced by 90 (the other side of the simulation box). Lastly, when touching the interface, the velocities should not be changed (MVN=MVT=1).</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;Right PBC&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Q&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">90</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;aInv&quot;</span><span class="p">:</span><span class="w">         </span><span class="p">[</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;P&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">90</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span>
<span class="p">},</span>
</pre></div>
</div>
<p>Similar to the Left PBC, but we realize that the normal aINV is reversed, and the position is on the other side of the simulation box Q=[90, 0, 0].</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;Bottom wall&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Q&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;aInv&quot;</span><span class="p">:</span><span class="w">         </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;P&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">-1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">-1</span>
<span class="p">},</span>
</pre></div>
</div>
<p>Now we define the bottom walls. We need to define ghost/phantom particles, as the fluid cell can intersect with the hard interface, reduing the effect cell population.
Position of this plain intersects with Q=[0, 0, 0], and its normal is aInv=[0,1,0]. The P and R are the same (as we again define a plane).
Now, when particles touch the wall they should not displace and DN is set to 0.
We want to have full slip, so the velocity components (normal and tangent) need to be reversed when particles touch the walls (MVN=MVT=-1).</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;Top wall&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Q&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;aInv&quot;</span><span class="p">:</span><span class="w">         </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;P&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">-1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">-1</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Same as top wall, but the aInv is reversed and its position is placed differently.
.. code-block:: json</p>
<blockquote>
<div><p>]</p>
</div></blockquote>
<p>We close the BC decleration.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>The end of the input file</p>
</section>
<section id="id12">
<h3>Output<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/flowFieldAnimator.py flowfield.dat input.json 0 99999 z -a equal</span>
<span class="go">python3 analysisScripts/ensAvPlotter.py avVel.dat &#39;Velocity, $\vec{v}$&#39; -c 1 2 3</span>
<span class="go">python3 analysisScripts/ensAvPlotter.py energy.dat &#39;Energy, $E$&#39; -c 5</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 100.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/velocity_av_contour_z.png"><img alt="../_images/velocity_av_contour_z.png" src="../_images/velocity_av_contour_z.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/avVel_av1.png"><img alt="../_images/avVel_av1.png" src="../_images/avVel_av1.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/energy_av1.png"><img alt="../_images/energy_av1.png" src="../_images/energy_av1.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="rarefied-gas-and-tracer-particles">
<span id="tracer"></span><h2><a class="toc-backref" href="#id77" role="doc-backlink">Rarefied gas and tracer particles</a><a class="headerlink" href="#rarefied-gas-and-tracer-particles" title="Permalink to this heading">#</a></h2>
<p>This tutorial demonstrates how to track the trajectory of individual particles. It will first simulate a rarefied gas to highlight <a class="reference internal" href="../Algorithm/Algorithm.html#streaming"><span class="std std-ref">streaming</span></a> and <a class="reference internal" href="../Algorithm/Algorithm.html#collision"><span class="std std-ref">collision</span></a> steps. The tutorial will then consider a subset of tracer particles suspended in a background fluid, which exhibit thermal diffusion. Outputting a species of MPCD-fluid particles with a small population may be useful for tracer particles.</p>
<p>In both cases, the system uses periodic boundary conditions.</p>
<section id="rarefied-gas">
<h3>Rarefied gas<a class="headerlink" href="#rarefied-gas" title="Permalink to this heading">#</a></h3>
<section id="id13">
<h4>Input File<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h4>
<p>This tutorial is based on the input file found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/rarefiedAndTracers/inputRarefied.json">MPCD/SampleInputs/wavyWalls/input.json</a>.</p>
</section>
<section id="id14">
<h4>Running<a class="headerlink" href="#id14" title="Permalink to this heading">#</a></h4>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="n">rarefiedAndTracers</span><span class="o">/</span><span class="n">inputRarefied</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id15">
<h4>Understanding the script<a class="headerlink" href="#id15" title="Permalink to this heading">#</a></h4>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">],</span>
<span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">500</span><span class="p">,</span>
<span class="nt">&quot;dt&quot;</span><span class="p">:</span><span class="w">               </span><span class="mf">0.2</span><span class="p">,</span>
<span class="nt">&quot;collOp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">3</span><span class="p">,</span>
</pre></div>
</div>
<p>A tiny, square domain is used.
The simulation runs for only <span class="math notranslate nohighlight">\(500\)</span> iterations, with a time step of <span class="math notranslate nohighlight">\(\delta t=0.2\)</span> using <a class="reference internal" href="../Usage/Usage.html#andersen"><span class="std std-ref">angular momentum conserving Andersen-thermostatted MPCD</span></a> without a warmup phase.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;pop&quot;</span><span class="p">:</span><span class="w">     </span><span class="mi">2</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;pop&quot;</span><span class="p">:</span><span class="w">     </span><span class="mi">2</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;pop&quot;</span><span class="p">:</span><span class="w">     </span><span class="mi">2</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Three separate species are simulated, each with only a population of 2 MPCD particles. Three species are simulated as an example and in order to colour them differently in later visualisations.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;domainWalls&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>This simulation uses periodic boundary conditions.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;energyOut&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">1</span><span class="p">,</span>
<span class="nt">&quot;trajSpecOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">3</span><span class="p">,</span>
<span class="nt">&quot;trajOut&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span>
</pre></div>
</div>
<p>The energy is outputted (<code class="docutils literal notranslate"><span class="pre">&quot;energyOut&quot;</span></code>), and the trajectories for the <strong>first</strong> three species (<code class="docutils literal notranslate"><span class="pre">&quot;trajSpecOut&quot;</span></code>). For those three species, every particle’s position is outputted every <code class="docutils literal notranslate"><span class="pre">&quot;trajOut&quot;</span></code> timesteps.</p>
</section>
<section id="id16">
<h4>Output<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 ~/Documents/research/code/mpcd/analysisScripts/ensAvPlotter.py energy.dat &#39;Temperature, $k_\mathrm{B}T$&#39; -c 6</span>
<span class="go">python3 ~/Documents/research/code/mpcd/analysisScripts/fluidParticleTrajectoriesAnimator.py -i ../inputRarefied.json  -P detailedSP0.dat detailedSP1.dat detailedSP2.dat</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/rarefied000198.png"><img alt="../_images/rarefied000198.png" src="../_images/rarefied000198.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/rarefied000201.png"><img alt="../_images/rarefied000201.png" src="../_images/rarefied000201.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/rarefied000204.png"><img alt="../_images/rarefied000204.png" src="../_images/rarefied000204.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/rarefied000207.png"><img alt="../_images/rarefied000207.png" src="../_images/rarefied000207.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/rarefied000210.png"><img alt="../_images/rarefied000210.png" src="../_images/rarefied000210.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(t=39.6\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=40.2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=40.8\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=41.4\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=42.0\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>The particles move ballistically with scattering events.</p>
</section>
</section>
<section id="tracer-particles">
<h3>Tracer particles<a class="headerlink" href="#tracer-particles" title="Permalink to this heading">#</a></h3>
<section id="id17">
<h4>Input File<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h4>
<p>Now we repeat the same simulation but with the 6 particles embedded in a fluid of more MPCD particles (4500). This tutorial is based on the input file found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/rarefiedAndTracers/inputTracers.json">MPCD/SampleInputs/wavyWalls/input.json</a>.</p>
</section>
<section id="id19">
<h4>Running<a class="headerlink" href="#id19" title="Permalink to this heading">#</a></h4>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="n">SampleInputs</span><span class="o">/</span><span class="n">rarefiedAndTracers</span><span class="o">/</span><span class="n">inputTracers</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">output</span><span class="o">-</span><span class="n">directory</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id20">
<h4>Understanding the script<a class="headerlink" href="#id20" title="Permalink to this heading">#</a></h4>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">],</span>
<span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">500</span><span class="p">,</span>
<span class="nt">&quot;dt&quot;</span><span class="p">:</span><span class="w">               </span><span class="mf">0.2</span><span class="p">,</span>
<span class="nt">&quot;collOp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">3</span><span class="p">,</span>
</pre></div>
</div>
<p>A tiny, square domain is used.
The simulation runs for only <span class="math notranslate nohighlight">\(500\)</span> iterations, with a time step of <span class="math notranslate nohighlight">\(\delta t=0.2\)</span> using <a class="reference internal" href="../Usage/Usage.html#andersen"><span class="std std-ref">angular momentum conserving Andersen-thermostatted MPCD</span></a> without a warmup phase.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;pop&quot;</span><span class="p">:</span><span class="w">     </span><span class="mi">2</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;pop&quot;</span><span class="p">:</span><span class="w">     </span><span class="mi">2</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;pop&quot;</span><span class="p">:</span><span class="w">     </span><span class="mi">2</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Three separate species are simulated, each with only a population of 2 MPCD particles. Three species are simulated as an example and in order to colour them differently in later visualisations.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;domainWalls&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>This simulation uses periodic boundary conditions.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;energyOut&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">1</span><span class="p">,</span>
<span class="nt">&quot;trajSpecOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">3</span><span class="p">,</span>
<span class="nt">&quot;trajOut&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span>
</pre></div>
</div>
<p>The energy is outputted (<code class="docutils literal notranslate"><span class="pre">&quot;energyOut&quot;</span></code>), and the trajectories for the <strong>first</strong> three species (<code class="docutils literal notranslate"><span class="pre">&quot;trajSpecOut&quot;</span></code>). For those three species, every particle’s position is outputted every <code class="docutils literal notranslate"><span class="pre">&quot;trajOut&quot;</span></code> timesteps.</p>
</section>
<section id="id21">
<h4>Output<a class="headerlink" href="#id21" title="Permalink to this heading">#</a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 ~/Documents/research/code/mpcd/analysisScripts/ensAvPlotter.py energy.dat &#39;Temperature, $k_\mathrm{B}T$&#39; -c 6</span>
<span class="go">python3 ~/Documents/research/code/mpcd/analysisScripts/fluidParticleTrajectoriesAnimator.py -i ../inputRarefied.json  -P detailedSP0.dat detailedSP1.dat detailedSP2.dat</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/tracers000198.png"><img alt="../_images/tracers000198.png" src="../_images/tracers000198.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/tracers000201.png"><img alt="../_images/tracers000201.png" src="../_images/tracers000201.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/tracers000204.png"><img alt="../_images/tracers000204.png" src="../_images/tracers000204.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/tracers000207.png"><img alt="../_images/tracers000207.png" src="../_images/tracers000207.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/tracers000210.png"><img alt="../_images/tracers000210.png" src="../_images/tracers000210.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(t=39.6\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=40.2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=40.8\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=41.4\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=42.0\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>The particles move diffusively.</p>
</section>
</section>
</section>
<section id="colloid">
<span id="id22"></span><h2><a class="toc-backref" href="#id78" role="doc-backlink">Colloid</a><a class="headerlink" href="#colloid" title="Permalink to this heading">#</a></h2>
<section id="diffusing-colloid">
<h3>Diffusing Colloid<a class="headerlink" href="#diffusing-colloid" title="Permalink to this heading">#</a></h3>
<p>This tutorial will demonstrate how to run a simple colloid in an isotropic fluid, in 2D geometries.
The simulation will be run in a small <span class="math notranslate nohighlight">\(20\times20\)</span> domain (for speed), with a colloid of radius <cite>3</cite>, all within periodic boundary conditions.
Colloids in MPCD are simulated through the use of a motile boundary.</p>
</section>
<section id="id23">
<h3>Input File<a class="headerlink" href="#id23" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input file found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/colloid/input.json">MPCD/SampleInputs/colloid/input.json</a>.</p>
</section>
<section id="id24">
<h3>Running<a class="headerlink" href="#id24" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="n">colloid</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id25">
<h3>Understanding the script<a class="headerlink" href="#id25" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">50000</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;collOp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>We define a 2D system with a simulation domain of 20 by 20 MPCD units.
We further tell the simulation to run for 50000 timesteps, and use the isotropic Andersen collision operator.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;The dens override will take the smaller volume fraction for the fluid into account&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;dens&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">20</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>We declare one species of fluid, and specify a <code class="docutils literal notranslate"><span class="pre">&quot;dens&quot;</span></code> override of 20.</p>
<p>If instead you wished to use the <code class="docutils literal notranslate"><span class="pre">&quot;pop&quot;</span></code> keyword, your population would need to take into account the volume of the colloid manually.
ie,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
    \mathrm{pop} &amp;= \rho V_\mathrm{domain}
    \\
    &amp;= \rho \times \left( \ell_x \times \ell_y - V_\mathrm {colloid} \right)
    \\
    &amp;= \rho \times \left( 20 \times 20 - \pi \times 3^2 \right)
\end{align*}\end{split}\]</div>
</div>
<p>However, the <code class="docutils literal notranslate"><span class="pre">&quot;dens&quot;</span></code> override will take this smaller volume fraction into account by using a Monte-Carlo integrator.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As the accessible volume is computed by a Monte-Carlo integrator, which is a stochastic method, the volume fraction will not exactly match the analytical <span class="math notranslate nohighlight">\(V_\mathrm{domain}\)</span>.
It will, however, be close enough for regular usage.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;debugOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">3</span><span class="p">,</span>
<span class="nt">&quot;flowOut&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">1000</span><span class="p">,</span>
<span class="nt">&quot;solidTrajOut&quot;</span><span class="p">:</span><span class="w">     </span><span class="mi">1000</span><span class="p">,</span>
<span class="nt">&quot;energyOut&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">0</span><span class="p">,</span>
<span class="nt">&quot;synopsisOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We then set outputs for the simulation.
Specifically, we set output of <code class="docutils literal notranslate"><span class="pre">&quot;flowOut&quot;</span></code> to every 1000 timesteps, to get flow field information, and <code class="docutils literal notranslate"><span class="pre">&quot;solidTrajOut&quot;</span></code> to get the trajectory information of our motile colloid every 1000 timesteps.
We further enable synopsis dumping, and set a logging level of 3 with <code class="docutils literal notranslate"><span class="pre">&quot;debugOut&quot;</span></code>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Periodic boundary conditions on the domain&quot;</span><span class="p">,</span>
<span class="nt">&quot;domainWalls&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
<span class="nt">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;The spherical colloid&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Q&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;aInv&quot;</span><span class="p">:</span><span class="w">         </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;P&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;Colloid radius&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">3</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">-1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">-1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;The colloid should be mobile, i.e. free to be displaced&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;dsplc&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;mass&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">565</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Finally, we configure boundary conditions.
First, we set <code class="docutils literal notranslate"><span class="pre">&quot;domainWalls&quot;:</span> <span class="pre">1</span></code> to additively include periodic boundary conditions around our simulation domain.
As this includes periodic boundary conditions for us, we only need to add a single boundary condition element to our input script: Namely, the motile colloid object itself.</p>
<p>The implementation of boundaries in MPCD is discussed in detail in <strong>TODO: link to Louise’s section</strong>.
As we have a solid boundary, and the boundary is expected to be off-latice, we need to enabled phantom particles.
<strong>TODO: finish explaining this block</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>Finally, don’t forget to properly close the input file with closing braces</p>
</section>
<section id="id26">
<h3>Output<a class="headerlink" href="#id26" title="Permalink to this heading">#</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/flowFieldAnimator.py flowfield.dat input.json 0 99999 z</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 100.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/frame0020.png"><img alt="../_images/frame0020.png" src="../_images/frame0020.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="tadpole-swimmers">
<h2><a class="toc-backref" href="#id79" role="doc-backlink">TADPole swimmers</a><a class="headerlink" href="#tadpole-swimmers" title="Permalink to this heading">#</a></h2>
<p>This tutorial shows how to generate a simple swimmer simulation in periodic boundary conditions.</p>
<section id="id27">
<h3>Input File<a class="headerlink" href="#id27" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input file found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/swimmer/input.json">MPCD/SampleInputs/swimmer/input.json</a>.</p>
</section>
<section id="id28">
<h3>Running<a class="headerlink" href="#id28" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="n">swimmer</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id29">
<h3>Understanding the script<a class="headerlink" href="#id29" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;debugOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">3</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">],</span>
<span class="w">   </span><span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">20000</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;collOp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>We define how verbose we want the debugger to be (reasonably), we set the system size (50 by 50 in MPCD units),
and we define for how long than the system will run and output.  We also define the collision operator for the MPCD fluid.
In this case, we model an isotropic fluid, with the default collision operator: the <a class="reference internal" href="../Usage/Usage.html#andersen"><span class="std std-ref">Andersen collision operator</span></a>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;dens&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">20</span>
<span class="w">      </span><span class="p">}</span>
<span class="p">],</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Periodic boundary conditions on the domain&quot;</span><span class="p">,</span>
<span class="nt">&quot;domainWalls&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We say that every MPCD box should be initialised with 20 MPC particles, and we define the boundary conditions to be periodic.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;TADPole swimmer&quot;</span><span class="p">,</span>
<span class="nt">&quot;typeSwim&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">2</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;One swimmer&quot;</span><span class="p">,</span>
<span class="nt">&quot;nSwim&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">1</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Swimmer monomers have same mass as one mpcd cell of fluid particles&quot;</span><span class="p">,</span>
<span class="nt">&quot;headMSwim&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">20</span><span class="p">,</span>
<span class="nt">&quot;midMSwim&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">20</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Swimmer propulsive force&quot;</span><span class="p">,</span>
<span class="nt">&quot;fsSwim&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">20</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Dipole strength. dsSwim=1 --&gt; pusher; dsSwim=-2 --&gt; puller&quot;</span><span class="p">,</span>
<span class="nt">&quot;dsSwim&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">1</span><span class="p">,</span>
<span class="nt">&quot;kSwim&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">30</span><span class="p">,</span>
<span class="nt">&quot;roSwim&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">4</span><span class="p">,</span>
<span class="nt">&quot;sigSwim&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">4</span><span class="p">,</span>
<span class="nt">&quot;epsSwim&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We describe the swimmer population: we want there to be 1 (nswim=1) dumbbell swimmer (typeSwim=2), with both body mass and head mass of
20 (midMSwim = headMSwim = 20). The swimmer will swim with a force of 20 MPCD units (fsSwim=20), and it will be a pusher (dsSwim=1).</p>
<p>These parameters can be changed to have more swimmers, heavier swimmers, or stronger swimmers. The sample input swimmerPairInLC gives an example
of two swimmers in a liquid crystal, and many other combinations are possible. Go wild!</p>
<p>The two parts of the dumbbell swimmer will be connected with a spring of 30 MPCD units (kSwim=30) and equilibrium length 4 (roSwim=4).
They will repulse each other with a WCA interaction of radius 4 (sigSwim=4) and relative strength 1 in MPCD energy unit. See the <a class="reference internal" href="../Inclusions/Inclusions.html#swimmers"><span class="std std-ref">swimmer section</span></a>
for more details.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When changing those parameters, we recommend that the mass of the head and body of the swimmer be kept the same, and that the equilibrium length
of the FENE spring (roSwim) and the range of the WCA interaction (sigSwim) also be the same. If these two conditions are not respected,
the simulated objects will not be dumbbell swimmers as described in the  <a class="reference internal" href="../Inclusions/Inclusions.html#swimmers"><span class="std std-ref">swimmer section</span></a>.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Output options&quot;</span><span class="p">,</span>
<span class="nt">&quot;flowOut&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">50</span><span class="p">,</span>
<span class="nt">&quot;avVelOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">0</span><span class="p">,</span>
<span class="nt">&quot;energyOut&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">0</span><span class="p">,</span>
<span class="nt">&quot;swimQOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">50</span><span class="p">,</span>
<span class="nt">&quot;swimOOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">0</span><span class="p">,</span>
<span class="nt">&quot;swimROut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">0</span><span class="p">,</span>
<span class="nt">&quot;synopsisOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span>
</pre></div>
</div>
<p>We now define what things we want to write out during the simulation (see the <a class="reference internal" href="../Outputs/Outputs.html#id1"><span class="std std-ref">output section</span></a> for details).
We write out the flow field every 50 timesteps, and never the average velocity and energy of the system - it can be turned on.
The position of the swimmers is printed every 50 timestep, but not the orientation or the run and tumble frequency.
We ask for a synopsis file, but don’t do checkpoint checks.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>The end of the input file.</p>
</section>
<section id="id30">
<h3>Output<a class="headerlink" href="#id30" title="Permalink to this heading">#</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/swimmerTraj_fieldsAnimator.py ./ input.json 0 99999 z vel</span>
<span class="go">python3 analysisScripts/swimmerTraj_fieldsAnimator.py ./ input.json 0 99999 z vor</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/velocity.png"><img alt="../_images/velocity.png" src="../_images/velocity.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/vorticity.png"><img alt="../_images/vorticity.png" src="../_images/vorticity.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="d-passive-nematic">
<h2><a class="toc-backref" href="#id80" role="doc-backlink">2D Passive Nematic</a><a class="headerlink" href="#d-passive-nematic" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to simulate a 2D passive nematic liquid crystal starting in a disordered state (because of random initial orientations) under periodic boundary conditions. Because the simulation parameters lie within the nematic regime, the simulation will relax towards an ordered state via the anhilation of topological defects.</p>
<section id="id31">
<h3>Input file<a class="headerlink" href="#id31" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input file found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/passiveNem2D/input.json">MPCD/sampleInputs/passiveNem2D/input.json</a>.</p>
</section>
<section id="id32">
<h3>Running<a class="headerlink" href="#id32" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="n">MPCD</span><span class="o">/</span><span class="n">SampleInputs</span><span class="o">/</span><span class="n">passiveNem2D</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id33">
<h3>Understanding the Script<a class="headerlink" href="#id33" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Square geometry&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">500</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;No warmup, in order to capture the relaxation towards the ordered state&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;warmUp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>We define the system size (50 by 50 in MPCD simulation units), and define how long the system will actually run and output. Because we are interested in capturing the relaxation towards the ordered state, we do not run any warmup.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Andersen MPCD preserving angular momentum&quot;</span><span class="p">,</span>
<span class="nt">&quot;rTech&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">3</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Liquid crystal mode turned on&quot;</span><span class="p">,</span>
<span class="nt">&quot;lc&quot;</span><span class="p">:</span><span class="w">               </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We also define the collision operator for the MPCD fluid (in this case, we model a nematic liquid crystal, so we need an angular momentum preserving collision operator) and turn on the liquid crystal mode.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since we did not input a specific value for the nematic <a class="reference internal" href="../Usage/Usage.html#meanfieldpotential"><span class="std std-ref">mean field potential</span></a> <span class="math notranslate nohighlight">\(U\)</span> (tag <code class="docutils literal notranslate"><span class="pre">mfpot</span></code>), the solver will use its default value <span class="math notranslate nohighlight">\(U=10\)</span>. For an average population of 20, this leaves the system within the ordered nematic state.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;dens&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">20</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;Random inital orientation&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;oDist&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">0</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>We say that every MPCD box should be initialized with 20 MPC particles and specifying a random initial orientation for the MPC particles, which sets the system to be in an isotropic state.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">         </span><span class="s2">&quot;Periodic Boundary Contions&quot;</span><span class="p">,</span>
<span class="nt">&quot;domainWalls&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We say that the system has periodic boundary conditions.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;We output the director and scalar order parameter fields&quot;</span><span class="p">,</span>
<span class="nt">&quot;dirSOut&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">10</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;We output the position, orientation and charge of topological defects, if present&quot;</span><span class="p">,</span>
<span class="nt">&quot;defectsOut&quot;</span><span class="p">:</span><span class="w">       </span><span class="mi">10</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Outputting summary of the parameters used in the simulation&quot;</span><span class="p">,</span>
<span class="nt">&quot;synopsisOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span>
</pre></div>
</div>
<p>We specify our outputs. Since we are interested in the liquid crystal aspect of the simulation, we output the director and scalar order parameter fields (every 10 time steps), the list of topological defects, with their position, polarization and charge (every 10 time steps) and turn on the sysnopsis file, which summarizes the parameters used in the simulation.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>The end of the input file</p>
</section>
<section id="id34">
<h3>Output<a class="headerlink" href="#id34" title="Permalink to this heading">#</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/orientationFieldAnimator.py directorfield.dat input.json 0 99999 z -a auto --qx 1 --qy 1 -c 0.75 -d defects.dat</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 25.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/frame0000.png"><img alt="../_images/frame0000.png" src="../_images/frame0000.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/frame0001.png"><img alt="../_images/frame0001.png" src="../_images/frame0001.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/frame0010.png"><img alt="../_images/frame0010.png" src="../_images/frame0010.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/frame0049.png"><img alt="../_images/frame0049.png" src="../_images/frame0049.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(t=0.0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=10\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=49\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Time evolution of nematic liquid crystal. Initially the nematic is in a disordered state. Since this state is energetically costly, with a high number of +1/2 and -1/2 topological defects (depicted by red and blue symbols respectively), the nematic relaxes towards an ordered state. It does so b y anhilating pais of defects with opposite charge.</p>
</section>
</section>
<section id="d-active-nematic">
<span id="actnemtutorial"></span><h2><a class="toc-backref" href="#id81" role="doc-backlink">2D Active Nematic</a><a class="headerlink" href="#d-active-nematic" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to simulate a 2D active nematic liquid crystal starting in an ordered state under periodic boundary conditions. Because of the active stress, the nematic will go through a bending instability, leading to the unbinding of topological defects and transitioning into active turbulence.</p>
<section id="id35">
<h3>Input file<a class="headerlink" href="#id35" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input file found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/tree/master/sampleInputs/activeNem2D">MPCD/SampleInputs/activeNem2D/input.json</a>.</p>
</section>
<section id="id36">
<h3>Running<a class="headerlink" href="#id36" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="n">activeNem2D</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id37">
<h3>Understanding the script<a class="headerlink" href="#id37" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Square geometry&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">5000</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;No warmup, in order to capture the relaxation towards the ordered state&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;warmUp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>We define the system size (50 by 50 in MPCD simulation units), and define how long the system will actually run and output.  Because we are interested in capturing the transition from an ordered state to active turbulence, we do not set up a warm up.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Active collision operator with modulated activity&quot;</span><span class="p">,</span>
<span class="nt">&quot;collOp&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">21</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Liquid crystal mode turned on&quot;</span><span class="p">,</span>
<span class="nt">&quot;lc&quot;</span><span class="p">:</span><span class="w">               </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We also define the collision operator for the MPCD fluid (in this case, we model an active nematic liquid crystal, so we need an active collision operator) and turn on the liquid crystal mode.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;dens&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">20</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>We say that every MPCD box should be initialized with 20 MPC particles.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since we did not input a specific initial orientation, the solve will assume the default one, which sets all nematogens to be oriented along the <span class="math notranslate nohighlight">\(y\)</span>-axis.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">         </span><span class="s2">&quot;Periodic Boundary Contions&quot;</span><span class="p">,</span>
<span class="nt">&quot;domainWalls&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We say that the system has periodic boundary conditions.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;To see the active spontaneous flows, we output the flow field&quot;</span><span class="p">,</span>
<span class="nt">&quot;flowOut&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">20</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;We output the director and scalar order parameter fields&quot;</span><span class="p">,</span>
<span class="nt">&quot;dirSOut&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">20</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;We output the position, orientation and charge of topological defects, if present&quot;</span><span class="p">,</span>
<span class="nt">&quot;defectsOut&quot;</span><span class="p">:</span><span class="w">       </span><span class="mi">20</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Outputting summary of the parameters used in the simulation&quot;</span><span class="p">,</span>
<span class="nt">&quot;synopsisOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span>
</pre></div>
</div>
<p>We specify our outputs. Since active systems present active spontaneous flows, we output the floe field of the system (every 20 time steps). In addition, since we are interested in the liquid crystal aspect of the simulation, we output the director and scalar order parameter fields (every 20 time steps), the list of topological defects, with their position, polarization and charge (every 20 time steps) and turn on the sysnopsis file, which summarizes the parameters used in the simulation.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
<p>The end of the input file.</p>
</section>
<section id="id38">
<h3>Output<a class="headerlink" href="#id38" title="Permalink to this heading">#</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/orientationFieldAnimator.py directorfield.dat input.json 0 99999 z -a auto --qx 2 --qy 2 -c 0.5 -d defects.dat</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 25.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/director0000.png"><img alt="../_images/director0000.png" src="../_images/director0000.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/director0030.png"><img alt="../_images/director0030.png" src="../_images/director0030.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/director0074.png"><img alt="../_images/director0074.png" src="../_images/director0074.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/director0114.png"><img alt="../_images/director0114.png" src="../_images/director0114.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(t=0.0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=60\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=148\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=228\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Time evolution of the oriented nematic. Initially the nematic is oriented along the <span class="math notranslate nohighlight">\(y\)</span>-axis. Active flows then cause a bending instability that emerges first and ends up in active turbulence, with unbinded +1/2 and -1/2 topological defects (depicted by red and blue symbols respectively). In the beginning there should be no defects, but the their numbers increase as the system enters into active turbulence.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/flowFieldAnimator.py flowfield.dat input.json 0 99999 z -a auto -d defects.dat</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 25.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/velocity0000.png"><img alt="../_images/velocity0000.png" src="../_images/velocity0000.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/velocity0030.png"><img alt="../_images/velocity0030.png" src="../_images/velocity0030.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/velocity0074.png"><img alt="../_images/velocity0074.png" src="../_images/velocity0074.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/velocity0114.png"><img alt="../_images/velocity0114.png" src="../_images/velocity0114.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(t=0.0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=60\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=148\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(t=228\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Time evolution of the system’s flow. When the system is ordered, there are no cohesive active flows and all flows come from the thermostat (i.e., they are stochastic). As the nematic starts to bend, active forces start to emerge, driving cohesive flows that, in turn, favour the bending of the nematic. When defects unbind, the system enters into active turbulence. The scale of the color bar changes at each time frame.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The defect tracker is unable to detect defects that lie nearby a periodic boundary.
As such, this can end up in the output file reporting an odd number of topological defects.</p>
</div>
</section>
</section>
<section id="d-pipe-flow">
<h2><a class="toc-backref" href="#id82" role="doc-backlink">3D pipe flow</a><a class="headerlink" href="#d-pipe-flow" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to run a MPCD simulation confined within an impermeable cylinder. It is</p>
<ul class="simple">
<li><p>an isotropic fluid</p></li>
<li><p>in 3D</p></li>
<li><p>with an external force</p></li>
<li><p>and no solutes</p></li>
<li><dl class="simple">
<dt>contained within a cylinder along x direction with</dt><dd><ul>
<li><p>periodic boundary conditions at both ends</p></li>
<li><p>perfect slip at walls</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<section id="id39">
<h3>Input File<a class="headerlink" href="#id39" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input file found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/pipeFlow/input.json">MPCD/SampleInputs/pipeFlow/input.json</a>.</p>
</section>
<section id="id40">
<h3>Running<a class="headerlink" href="#id40" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="n">pipeFlow</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id41">
<h3>Understanding the script<a class="headerlink" href="#id41" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Make a rectangular domain&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;To have PBCs at walls of the cuboid geometry on top of a cylider within this geometry&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;domainWalls&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Warmup to develop the flow&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;warmUp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">500</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">500</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Isotropic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;collOp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>We first define the system size (<span class="math notranslate nohighlight">\(20 \times 10 \times 10\)</span> in MPCd units). The <cite>“domainWalls”: 1,</cite> is to add extra periodic boundary conditions on the domain walls, on top of the defined cylinder boundaries. Then it is specified how long the simulation will run and output data (a warmup phase is included to allow the flow to reach its steady state).  To have an isotropic fluid the Andersen collision operator is used.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Gravity-generated pressure gradient&quot;</span><span class="p">,</span>
<span class="nt">&quot;grav&quot;</span><span class="p">:</span><span class="w">             </span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
</pre></div>
</div>
<p>To drive the flow, gravity is include to generate a pressure gradient since <span class="math notranslate nohighlight">\(\rho \vec{g} \to \vec{\nabla} P_g\)</span>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;Fluid density of 20 within cylindrical volume can be calculated as 20 * pi * R^2 * L = 772078 or just use dens&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;dens&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">20</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Here, we set the total number of particles inside the cylinder using the its volume and average number of particles in each MPCD cell.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;debugOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">3</span><span class="p">,</span>
<span class="nt">&quot;flowOut&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">20</span><span class="p">,</span>
<span class="nt">&quot;pressureOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">0</span><span class="p">,</span>
<span class="nt">&quot;avVelOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">5</span><span class="p">,</span>
<span class="nt">&quot;energyOut&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">5</span><span class="p">,</span>
<span class="nt">&quot;synopsisOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
<span class="nt">&quot;checkpointOut&quot;</span><span class="p">:</span><span class="w">    </span><span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>We now define what things we want to write out during the simulation (see output for details). We use debugOut level 3. We write out the flow field every 20 timesteps and the average velocity and energy every 5 steps.
We don’t write out the energy in this example, but that can be turned on. We also include a synopsis file.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;BC for a cylinder with two ends and impermeable perfect-slip walls&quot;</span><span class="p">,</span>
<span class="nt">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>

<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Now we define BC. (See Boundary Conditions for more details) Remember, that this needs to be between [].</p>
<p>Now lets see how a cylinder could be defined. Standard surfaces have the form,</p>
<div class="math-wrapper docutils container" id="shape">
<div class="math notranslate nohighlight" id="shape">
\[S^S(\vec{x})=[A_x\left(x-Q_x\right)]^{p_x} + [A_y\left(y-Q_y\right)]^{p_y} + [A_z\left(z-Q_z\right)]^{p_z} - R^{p_R} = 0\]</div>
</div>
<p>where the surface parameters represent the surface position’s <span class="math notranslate nohighlight">\(\vec{Q}=(Q_x,Q_y,Q_z)\)</span>,
surface coefficient’s <span class="math notranslate nohighlight">\(\vec{A}=(A_x,A_y,A_z)\)</span>, surface power’s <span class="math notranslate nohighlight">\((p_x,p_y,p_z,p_R)\)</span> and radius <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>For this example, the cylinder is along the x axis meaning its base circle is lying in the yz-plane, so  <span class="math notranslate nohighlight">\(\vec{Q}=(0,Q_y,Q_z)\)</span>, surface power’s <span class="math notranslate nohighlight">\((2,2,2,2)\)</span> , <span class="math notranslate nohighlight">\(\vec{A}=(0,1,1)\)</span> and  radius <span class="math notranslate nohighlight">\(R\)</span>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;Q&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">],</span>
<span class="nt">&quot;aInv&quot;</span><span class="p">:</span><span class="w">         </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span>
<span class="nt">&quot;P&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span>
<span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">7</span><span class="p">,</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a thorough explanation about different surfaces please check <a class="reference internal" href="../Usage/Usage.html#subsection-boundarysurfaces"><span class="std std-ref">Standard surfaces</span></a>.</p>
</div>
<p>The next part deals with how the velocity of particles changes when they collide with the walls of the cylinder. To create no-slip boundary conditions both the normal and tangent components are reversed. Since the walls are no-slip, phantom particles must be included.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;Since the walls are no-slip, include phantom particles&quot;</span><span class="p">,</span>
<span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;The normal component of velocity is reversed to make impermeable&quot;</span><span class="p">,</span>
<span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">-1</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;The tangent component of velocity is reversed to make no-slip&quot;</span><span class="p">,</span>
<span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">-1</span><span class="p">,</span>
</pre></div>
</div>
<p>And finally to have the particles inside this volume.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;To have the particles inside the cylinder&quot;</span><span class="p">,</span>
<span class="nt">&quot;inv&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span>
</pre></div>
</div>
<p>The end of the input file.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id42">
<h3>Output<a class="headerlink" href="#id42" title="Permalink to this heading">#</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/flowFieldAnimator.py flowfield.dat input.json 0 99999 x -a auto</span>
<span class="go">python3 analysisScripts/ensAvPlotter.py energy.dat &#39;Energy, $E$&#39; -c 5</span>
<span class="go">python3 analysisScripts/ensAvPlotter.py avVel.dat &#39;Velocity, $\vec{v}$&#39; -c 1 2 3</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 100.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/velocity_av_contour_x.png"><img alt="../_images/velocity_av_contour_x.png" src="../_images/velocity_av_contour_x.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/avVel_av2.png"><img alt="../_images/avVel_av2.png" src="../_images/avVel_av2.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/energy_av2.png"><img alt="../_images/energy_av2.png" src="../_images/energy_av2.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="flow-past-a-square-obstacle">
<h2><a class="toc-backref" href="#id83" role="doc-backlink">Flow past a ‘square’ obstacle</a><a class="headerlink" href="#flow-past-a-square-obstacle" title="Permalink to this heading">#</a></h2>
<p>This tutorial shows how to generate an isotropic simulation in periodic boundary conditions past a square-like object,
with gravity turned on in the x-direction. We cannot implement an actual square-shaped object, so instead we use a squircle, essentially a
higher order version of a sphere. See the <a class="reference internal" href="../Usage/Usage.html#squircle"><span class="std std-ref">squircle section</span></a> for more details.</p>
<section id="id43">
<h3>Input File<a class="headerlink" href="#id43" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input file found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/flowPastSquareObstacle/input.json">MPCD/SampleInputs/flowPastSquareObstacle/input.json</a>.</p>
</section>
<section id="id44">
<h3>Running<a class="headerlink" href="#id44" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="n">flowPastSquareObstacle</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id45">
<h3>Understanding the script<a class="headerlink" href="#id45" title="Permalink to this heading">#</a></h3>
<p>To understand most of the input script, see the tutorials above. In particular it is very similar to <a class="reference internal" href="#isoptropic"><span class="std std-ref">isotropic fluid input file</span></a>.
The important differences are below.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;grav&quot;</span><span class="p">:</span><span class="w">             </span><span class="p">[</span><span class="mf">0.002</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
</pre></div>
</div>
<p>This line turns on gravity in the x-direction, with an intensity of 0.002 force density in MPCD unit.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;For the density to be 20, must subtract the volume of the obstacle (398000) or just use `dens`&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;dens&quot;</span><span class="p">:</span><span class="w">     </span><span class="mi">20</span>
<span class="w">        </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Instead of specifying the jSON tag, the density is used to numerically set the population by determining the area that is not covered by the obstacle via Monte Carlo integration.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;BC&quot;</span><span class="p">:</span>
<span class="w">   </span><span class="p">[</span>
<span class="w">       </span><span class="p">{</span>
<span class="w">           </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">      </span><span class="s2">&quot;A fixed squircle obstacle with impermeable, no-slip BCs&quot;</span><span class="p">,</span>
<span class="w">           </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
<span class="w">           </span><span class="nt">&quot;Q&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">           </span><span class="nt">&quot;aInv&quot;</span><span class="p">:</span><span class="w">         </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="w">           </span><span class="nt">&quot;P&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">],</span>
<span class="w">           </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">10</span><span class="p">,</span>
<span class="w">           </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">0</span><span class="p">,</span>
<span class="w">           </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">-1</span><span class="p">,</span>
<span class="w">           </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">-1</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">   </span><span class="p">]</span>
</pre></div>
</div>
<p>The squircle: see the <a class="reference internal" href="../Usage/Usage.html#squircle"><span class="std std-ref">squircle section</span></a> for more details. It is placed at position (100,50) within a 200 by 100 domain size (“Q”=[100,50,0]
with “domain”=[200,100]), with a minor radius of 10 (“R”=10). The boundary conditions are no-slip (“MVN”=”MVT”=-1) and non-periodic (“DN”=0).</p>
</section>
<section id="id46">
<h3>Output<a class="headerlink" href="#id46" title="Permalink to this heading">#</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/flowFieldAnimator.py flowfield.dat input.json 0 99999 x -a auto</span>
<span class="go">python3 analysisScripts/ensAvPlotter.py energy.dat &#39;Energy, $E$&#39; -c 5</span>
<span class="go">python3 analysisScripts/ensAvPlotter.py avVel.dat &#39;Velocity, $\vec{v}$&#39; -c 1 2 3</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 100.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/velocity_av_z.png"><img alt="../_images/velocity_av_z.png" src="../_images/velocity_av_z.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/avVel_av3.png"><img alt="../_images/avVel_av3.png" src="../_images/avVel_av3.png" style="width: 95%;" /></a>
</figure>
</td>
<td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/energy_av3.png"><img alt="../_images/energy_av3.png" src="../_images/energy_av3.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
<p>The results make it clear that this simulation needs a longer warmup time.</p>
</section>
</section>
<section id="d-polymer">
<span id="dpolymer"></span><h2><a class="toc-backref" href="#id84" role="doc-backlink">2D polymer</a><a class="headerlink" href="#d-polymer" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to run a 2D nematic MPCD simulation in which a polymer is embedded. It is</p>
<ul class="simple">
<li><p>anisotropic nematic fluid</p></li>
<li><p>in 2D</p></li>
<li><p>one polymer</p></li>
<li><p>periodic boundary condition</p></li>
</ul>
<section id="input-files">
<h3>Input Files<a class="headerlink" href="#input-files" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input files found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/tree/master/sampleInputs/md2D">MPCD/SampleInputs/md2D/{input.json,md.inp}</a>.</p>
<section id="input-json">
<h4>input.json<a class="headerlink" href="#input-json" title="Permalink to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">.json</span></code> input file for the MPCD side of the simulation is found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/md2D/input.json">MPCD/SampleInputs/md2D/input.json</a>.</p>
</section>
<section id="md-inp">
<h4>md.inp<a class="headerlink" href="#md-inp" title="Permalink to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">.inp</span></code> input file for the MD side of the simulation is found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/md2D/md.inp">MPCD/SampleInputs/md2D/</a>.</p>
</section>
</section>
<section id="id47">
<h3>Running<a class="headerlink" href="#id47" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="n">md2D</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="understanding-the-scripts">
<h3>Understanding the Scripts<a class="headerlink" href="#understanding-the-scripts" title="Permalink to this heading">#</a></h3>
<section id="dpolymer-json">
<span id="id48"></span><h4>input.json<a class="headerlink" href="#dpolymer-json" title="Permalink to this heading">#</a></h4>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;dt&quot;</span><span class="p">:</span><span class="w">               </span><span class="mf">0.1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">2000</span><span class="p">,</span>
</pre></div>
</div>
<p>We first define the system size (<span class="math notranslate nohighlight">\(10 \times 10\)</span> in MPCd units). Then it is specified that the time step is <span class="math notranslate nohighlight">\(\delta t=0.1\)</span> and how long the simulation will run.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;rFrame&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>By turning on <code class="docutils literal notranslate"><span class="pre">rframe</span></code>, the simulation zeroes the net momentum after initization before starting the simulation.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Nematic fluid using Andersen MPCD&quot;</span><span class="p">,</span>
<span class="nt">&quot;collOp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">3</span><span class="p">,</span>
<span class="nt">&quot;lc&quot;</span><span class="p">:</span><span class="w">               </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>The Andersen collision operator is used to simulate the fluid and in order to have anisotropic fluid the <code class="docutils literal notranslate"><span class="pre">lc</span></code> is set to 1.</p>
<div class="highlight-json notranslate" id="mdstep"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Location of the MD input file&quot;</span><span class="p">,</span>
<span class="nt">&quot;mdIn&quot;</span><span class="p">:</span><span class="w">             </span><span class="s2">&quot;md.inp&quot;</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Number of MD steps per MPCD step&quot;</span><span class="p">,</span>
<span class="nt">&quot;stepsMD&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">50</span><span class="p">,</span>
</pre></div>
</div>
<p>This snippet declares the path of the polymer input file is <code class="docutils literal notranslate"><span class="pre">md.inp</span></code>. For more details about how MD is coupled to MPCD please see the <a class="reference internal" href="../Inclusions/Inclusions.html#chapter11"><span class="std std-ref">MD</span></a> section. To briefly explain, polymer monomers are included in the velocity collision operator and during the streaming time step of MPCD , a molecular dynamics algorithm is responsible to update position and velocity of monomers. To keep the MD simulation stable, during one MPCD streaming step <code class="docutils literal notranslate"><span class="pre">&quot;stepsMD&quot;</span></code> number of MD time steps are run.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;dens&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">20</span>
<span class="w">      </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Every MPCD box should be initialized with 20 MPCD particles.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;debugOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">3</span><span class="p">,</span>
<span class="nt">&quot;dirSOut&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">100</span><span class="p">,</span>
<span class="nt">&quot;synopsisOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span>
</pre></div>
</div>
<p>This snippet defines what will be written during the simulation (see <a class="reference internal" href="../Outputs/Outputs.html#id1"><span class="std std-ref">output</span></a> for details). We use <code class="docutils literal notranslate"><span class="pre">debugOut</span></code> level 3 to see each timestep in the terminal. The director field is output every 100 timesteps and a synopsis file is included.</p>
<p>The end of the input file.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="dpolymer-inp">
<span id="id49"></span><h4>md.inp<a class="headerlink" href="#dpolymer-inp" title="Permalink to this heading">#</a></h4>
<p>Here is the breakdown of the important parts of the input script that you can modify (the parts that are not explained are set values that should not be changed unless you need fundamental changes)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        warmupMD                = FREE_WARMUP</span>
</pre></div>
</div>
<p>The MPCD simualtion can have a warm up time during which the algorithm runs but there is no output. If there is a warm up time for MPCD, it can be chosen whether to run the MD during that warm up time or not.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if MD runs during warmup time, it outputs data.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        unitCells               = (10,10,0)</span>
</pre></div>
</div>
<p>The system size for MD is <strong>always</strong> declared through a 3D array, in this case the zero third component means it is a 2D simulation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        dt                      = 0.002</span>
</pre></div>
</div>
<p>Here we define the MD time step in units of MPCD time step. As mentioned earlier in <a class="reference internal" href="#mdstep"><span class="std std-ref">here</span></a> each MPCD is divided into <code class="docutils literal notranslate"><span class="pre">&quot;stepsMD&quot;</span></code> number of MD time steps. And since <span class="math notranslate nohighlight">\(\delta t = 0.1\)</span>, <span class="math notranslate nohighlight">\(\text{d}t = \delta t / \text{stepsMD} = 0.1/50 = 0.002\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        bjerrum                 = 0</span>
<span class="c1"># parameter:        lambda_D                = 0</span>
<span class="c1"># parameter:        rCutCoul                = 0</span>
<span class="c1"># parameter:        condenseCriteria                = 0</span>
</pre></div>
</div>
<p>If the electrostatic forces are needed these prameters should be given a value. For more details please check <a class="reference internal" href="../Inclusions/Inclusions.html#coulombic"><span class="std std-ref">Coulombic Potential</span></a> and <a class="reference internal" href="../Inclusions/Inclusions.html#debye-huckel"><span class="std std-ref">Debye-Huckel</span></a> sections.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        kFene                   = 120.0</span>
<span class="c1"># parameter:        r0Fene                  = 1.5</span>
<span class="c1"># parameter:        kSqu                    = 0.0</span>
<span class="c1"># parameter:        kBend                   = 5.0</span>
<span class="c1"># parameter:        theta0Bend              = 0.0</span>
<span class="c1"># parameter:        kNemMPC                 = 50.0</span>
<span class="c1"># parameter:        kDihedral               = 0.0</span>
<span class="c1"># parameter:        phi0Dihedral    = 0.0</span>
</pre></div>
</div>
<p>Here we define <code class="docutils literal notranslate"><span class="pre">kFene</span></code> that is a spring constant representing the stiffness of the bonds in response to stretching and <code class="docutils literal notranslate"><span class="pre">r0Fene</span></code> that is the maximum length of the bonds connecting two monomers (for more details check <a class="reference internal" href="../Inclusions/Inclusions.html#fene"><span class="std std-ref">Finitely Extensible Bonds</span></a>). <code class="docutils literal notranslate"><span class="pre">kSqu</span></code> is the spring constant for a radial squeezing force to force polymer into longitudinal configuartion, here we set it to zero. <code class="docutils literal notranslate"><span class="pre">kBend</span></code> is the parameter to modulate the bending stiffness of the polymer (it introduces a persistence lentgh to polymer, for more details check <a class="reference internal" href="../Inclusions/Inclusions.html#bending-potential"><span class="std std-ref">Bond Bending Potential</span></a>). And finally <code class="docutils literal notranslate"><span class="pre">kNemMPC</span></code> which is the parameter to modulate the strength of the alignment torque that nemtaic orientation applies to the polymer backbone (<a class="reference internal" href="../Inclusions/Inclusions.html#coupling-potential"><span class="std std-ref">Nematic Coupling Potential</span></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        atomMass                = (10,                  1,                              10)</span>
</pre></div>
</div>
<p>The third number specifies the mass of monomers in units of MPCD particle mass, so here each monomer is ten times heavier than MPCD particles.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">charge</span> <span class="pre">sets:</span></code> the parameters related to the charge o monomers for electrostatic forces are entered. Here, the next two lines define that there is no electrostatic force since there is no charge.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        qDensity                = (0.,                          0.,                     0.,                     0.)</span>
<span class="c1"># parameter:        qNumber                 = (0,                           0,                              0,                              0)</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">polymer</span> <span class="pre">sets:</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        polyLayout              = (LAYOUT_U)</span>
</pre></div>
</div>
<p>Sets the initial conformation of the polymer (for more options please check the <code class="docutils literal notranslate"><span class="pre">md/mdtypes.h</span></code> in MPCD directory). In this case, we put a U shaped polymer in the centre of the control volume.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        polyM                   = (1)</span>
<span class="c1"># parameter:        polyN                   = (10)</span>
</pre></div>
</div>
<p>These two parameters set the number of polymers and number of monomers per polymer respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        nStep                   = (0,   50000,                  5000000)</span>
</pre></div>
</div>
<p>What one should be very careful about in <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">simulation</span> <span class="pre">phases:</span></code>  is the last number for <code class="docutils literal notranslate"><span class="pre">nStep</span></code> becuase it is the maximum time step beyond which no data will be outputed from MD side and the number is in units of MD. for instance in this example, we have 2000 MPCD streaming step and each are 50 MD steps, so nStep should be at least <span class="math notranslate nohighlight">\(2000 \times 50\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        stepAvg                     = (0,       5000,                   5000)</span>
<span class="c1"># parameter:        stepHistCollect         = (0,   5000,                   5000)</span>
<span class="c1"># parameter:        stepHistPrint           = (0,   5000,                   5000)</span>
<span class="c1"># parameter:        stepSceneSlow           = (0,   5000,                   5000)</span>
<span class="c1"># parameter:        stepSceneFast           = (0,   5000,                   5000)</span>
</pre></div>
</div>
<p>Numbers in <code class="docutils literal notranslate"><span class="pre">step</span> <span class="pre">counters</span></code> section are the frequency of outputing the MD data. MD data is not very expensive, storagevise, in comparison with field outputs in MPCD. So you can output more frequently than MPCD or if you want the same number of outputs as MPCD , multiply the frequency of MPCD output by <code class="docutils literal notranslate"><span class="pre">stepsMD</span></code>. Here, it is <span class="math notranslate nohighlight">\(100 \times 50 = 5000\)</span>.</p>
</section>
</section>
</section>
<section id="many-polymers">
<h2><a class="toc-backref" href="#id85" role="doc-backlink">Many polymers</a><a class="headerlink" href="#many-polymers" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to run a 2D nematic MPCD simulation in which several polymers are embedded. It is</p>
<ul class="simple">
<li><p>anisotropic nematic fluid</p></li>
<li><p>in 2D</p></li>
<li><p>several polymers</p></li>
<li><p>periodic boundary condition</p></li>
</ul>
<section id="id50">
<h3>Input Files<a class="headerlink" href="#id50" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input files found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/tree/master/sampleInputs/manyPolymers">MPCD/SampleInputs/manyPolymers/{input.json,md.inp}</a>.</p>
<section id="id51">
<h4>input.json<a class="headerlink" href="#id51" title="Permalink to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">.json</span></code> input file for the MPCD side of the simulation is found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/manyPolymers/input.json">MPCD/SampleInputs/manyPolymers/input.json</a>.</p>
</section>
<section id="id52">
<h4>md.inp<a class="headerlink" href="#id52" title="Permalink to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">.inp</span></code> input file for the MD side of the simulation is found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/manyPolymers/md.inp">MPCD/SampleInputs/manyPolymers/</a>.</p>
</section>
</section>
<section id="id53">
<h3>Running<a class="headerlink" href="#id53" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="n">Manypolymers</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id54">
<h3>Understanding the Scripts<a class="headerlink" href="#id54" title="Permalink to this heading">#</a></h3>
<section id="id55">
<h4>input.json<a class="headerlink" href="#id55" title="Permalink to this heading">#</a></h4>
<p>Here, we have used the same <code class="docutils literal notranslate"><span class="pre">input.json</span></code> that is used in <a class="reference internal" href="#dpolymer"><span class="std std-ref">2D polymer example</span></a>. To understand the json input file please read <a class="reference internal" href="#dpolymer-json"><span class="std std-ref">2D polymer json input</span></a>.</p>
</section>
<section id="id56">
<h4>md.inp<a class="headerlink" href="#id56" title="Permalink to this heading">#</a></h4>
<p>To simulate four polymers, we use the same md input file used in the <a class="reference internal" href="#dpolymer"><span class="std std-ref">2D polymer example</span></a> but the following parameters should be changed:</p>
<p>In <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">polymer</span> <span class="pre">sets:</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        polyLayout              = (LAYOUT_FLUID)</span>
</pre></div>
</div>
<p>Among the available initial conformation for polymer, only <code class="docutils literal notranslate"><span class="pre">LAYOUT_FLUID</span></code> can be used in the case of many polymers. It is becuase the other options including <code class="docutils literal notranslate"><span class="pre">LAYOUT_U</span></code>, <code class="docutils literal notranslate"><span class="pre">LAYOUT_RODX</span></code> and <code class="docutils literal notranslate"><span class="pre">LAYOUT_RODY</span></code> are positioned in the center of control volume.</p>
<p>The available initial conformations:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LAYOUT_FLUID</span></code> is a self avoiding random walk that is randomly located in the control volume.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LAYOUT_U</span></code> is a U shaped polymer in the center of the control volume.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LAYOUT_RODX</span></code> is a rod polymer along x direction in the center of the control volume.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LAYOUT_RODY</span></code> is a rod polymer along y direction in the center of the control volume.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        polyM                   = (4)</span>
<span class="c1"># parameter:        polyN                   = (5)</span>
</pre></div>
</div>
<p>These two parameters set the number of polymers and number of monomers per polymer, respectively. Here, the simulation will include 4 polymers each of which has 5 monomers.</p>
<p>To understand the whole md input file please refer to <a class="reference internal" href="#dpolymer-inp"><span class="std std-ref">2D polymer md input</span></a>.</p>
</section>
</section>
</section>
<section id="polymer-translocation">
<h2><a class="toc-backref" href="#id86" role="doc-backlink">Polymer translocation</a><a class="headerlink" href="#polymer-translocation" title="Permalink to this heading">#</a></h2>
<p>This tutorial will show how to run a polymer translocation simulation . It is</p>
<ul class="simple">
<li><p>active nematic fluid</p></li>
<li><p>in 2D</p></li>
<li><p>one polymer</p></li>
<li><p>periodic boundary condition, with a wall in the middle on which there is a pore.</p></li>
</ul>
<section id="id57">
<h3>Input File<a class="headerlink" href="#id57" title="Permalink to this heading">#</a></h3>
</section>
<section id="id58">
<h3>Input Files<a class="headerlink" href="#id58" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input files found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/tree/master/sampleInputs/polymerTranslocation">MPCD/SampleInputs/polymerTranslocation/{input.json,md.inp}</a>.</p>
<section id="id59">
<h4>input.json<a class="headerlink" href="#id59" title="Permalink to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">.json</span></code> input file for the MPCD side of the simulation is found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/polymerTranslocation/input.json">MPCD/SampleInputs/polymerTranslocation/input.json</a>.</p>
</section>
<section id="id60">
<h4>md.inp<a class="headerlink" href="#id60" title="Permalink to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">.inp</span></code> input file for the MD side of the simulation is found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/polymerTranslocation/md.inp">MPCD/SampleInputs/polymerTranslocation/</a>.</p>
</section>
</section>
<section id="id61">
<h3>Running<a class="headerlink" href="#id61" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="n">polymerTranslocation</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id62">
<h3>Understanding the Scripts<a class="headerlink" href="#id62" title="Permalink to this heading">#</a></h3>
<section id="id63">
<h4>input.json<a class="headerlink" href="#id63" title="Permalink to this heading">#</a></h4>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;domain&quot;</span><span class="p">:</span><span class="w">           </span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">1000</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Collision operator 21 is an active nematic collision operator&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;collOp&quot;</span><span class="p">:</span><span class="w">           </span><span class="mi">21</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;lc&quot;</span><span class="p">:</span><span class="w">               </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>We first define the system size (<span class="math notranslate nohighlight">\(50 \times 50\)</span> in MPCd units). Then it is specified how long the simulation will run and output data. The sigmoidal sum active collision operator is uset to create active nematic fluid. For more details please check <a class="reference internal" href="../Usage/Usage.html#activenematic"><span class="std std-ref">active nematic MPCD</span></a>. In order to have anisotropic fluid the <code class="docutils literal notranslate"><span class="pre">lc</span></code> is set to 1.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Location of the MD input file&quot;</span><span class="p">,</span>
<span class="nt">&quot;mdIn&quot;</span><span class="p">:</span><span class="w">             </span><span class="s2">&quot;md.inp&quot;</span><span class="p">,</span>
<span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w">          </span><span class="s2">&quot;Number of MD steps per MPCD step&quot;</span><span class="p">,</span>
<span class="nt">&quot;stepsMD&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">50</span><span class="p">,</span>
</pre></div>
</div>
<p>Now declare the path of the polymer input file that is the <code class="docutils literal notranslate"><span class="pre">md.inp</span></code>. For more details about how MD is coupled to MPCD please take a look at the <a class="reference internal" href="../Inclusions/Inclusions.html#chapter11"><span class="std std-ref">MD</span></a> section. During one MPCD streaming step <code class="docutils literal notranslate"><span class="pre">&quot;stepsMD&quot;</span></code> number of MD time steps are run.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;dens&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">20</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;qDist&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;vDist&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;oDist&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;act&quot;</span><span class="p">:</span><span class="w">          </span><span class="mf">0.08</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sigWidth&quot;</span><span class="p">:</span><span class="w">     </span><span class="mf">0.1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sigPos&quot;</span><span class="p">:</span><span class="w">       </span><span class="mf">0.5</span>
<span class="w">      </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>We say that every MPCD box should be initialized with 20 MPCD particles. Nematogens are placed randomly and freely within the control volume. Their velocities are drawn from a uniformly random distribution and all are along X axis. Activity is introduced as extensile force dipoles (positive value) with strength <code class="docutils literal notranslate"><span class="pre">0.08</span></code>. Then the modultion parameters are set (for more options please check <a class="reference internal" href="../Usage/Usage.html#activenematic"><span class="std std-ref">Active-nematic MPCD</span></a>) .</p>
<p>Now we define the wall as a BC. (See <a class="reference internal" href="../Usage/Usage.html#chapterbc"><span class="std std-ref">Boundary Conditions</span></a> for more details) Remember, that this needs to be between [].</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span><span class="p">,</span>
</pre></div>
</div>
<p>Now lets see how a wall with a pore in the middle of it can be created. For this purpose we can use a fixed rectangular super ellipse obstacle. The construction of a super ellipse has <span class="math notranslate nohighlight">\(p_x=p_y=p_z=p_R=n\)</span> and
<span class="math notranslate nohighlight">\(A_x=\frac{1}{a}, A_z=\frac{1}{b}, A_z=\frac{1}{c}\)</span> and radius <span class="math notranslate nohighlight">\(R\)</span>. Where the surface position’s <span class="math notranslate nohighlight">\(\vec{Q}=(Q_x,Q_y,Q_z)\)</span>.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[S(\vec{x})= \left(\frac{x-Q_x}{a}\right)^n + \left(\frac{y-Q_y}{b}\right)^n + \left(\frac{z-Q_z}{c}\right)^n  - 1 = 0\]</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A super ellipsoid provide an increasingly closer approximation to a cuboid for large positive <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>For a thorough explanation about different surfaces please check <a class="reference internal" href="../Usage/Usage.html#subsection-boundarysurfaces"><span class="std std-ref">Standard surfaces</span></a>.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;Q&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="nt">&quot;aInv&quot;</span><span class="p">:</span><span class="w">         </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="nt">&quot;P&quot;</span><span class="p">:</span><span class="w">            </span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">],</span>
<span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="w">            </span><span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>In the following, we set the no-slip BCs and planar anchoring.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">-1</span><span class="p">,</span>
<span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">-1</span><span class="p">,</span>
<span class="nt">&quot;MUN&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">0</span><span class="p">,</span>
<span class="nt">&quot;MUT&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">1</span>
</pre></div>
</div>
<p>We now define what things we want to write out during the simulation (see output for details). We use debugOut level 3. We write out the velocity and the director field every 50 timesteps. We also include a synopsis file.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;debugOut&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">3</span><span class="p">,</span>
<span class="nt">&quot;flowOut&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">50</span><span class="p">,</span>
<span class="nt">&quot;dirSOut&quot;</span><span class="p">:</span><span class="w">          </span><span class="mi">50</span><span class="p">,</span>
<span class="nt">&quot;synopsisOut&quot;</span><span class="p">:</span><span class="w">      </span><span class="mi">1</span>
</pre></div>
</div>
<p>The end of the input file.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id64">
<h4>md.inp<a class="headerlink" href="#id64" title="Permalink to this heading">#</a></h4>
<p>Here is the breakdown of the important parts of the input script that you can modify (the parts that are not explained are set values that should not be changed unless you need fundamental changes)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:    warmupMD        = 0</span>
</pre></div>
</div>
<p>The MPCD simualtion can have a warm up time during which the algorithm runs but there is no output. If there is a warm up time for MPCD, it can be chosen whether to run the MD during that warm up time or not.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if MD runs during warmup time, it outputs data.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        unitCells               = (50,50,0)</span>
</pre></div>
</div>
<p>The system size for MD is <strong>always</strong> declared through a 3D array, in this case the zero third component means it is a 2D simulation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        dt                      = 0.002</span>
</pre></div>
</div>
<p>Here we define the MD time step in units of MPCD time step. As mentioned earlier in <a class="reference internal" href="#mdstep"><span class="std std-ref">here</span></a> each MPCD is divided into <code class="docutils literal notranslate"><span class="pre">&quot;stepsMD&quot;</span></code> number of MD time steps. And since <span class="math notranslate nohighlight">\(\delta t = 0.1\)</span>, <span class="math notranslate nohighlight">\(\text{d}t = \delta t / \text{stepsMD} = 0.1/50 = 0.002\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        bjerrum                 = 0</span>
<span class="c1"># parameter:        lambda_D                = 0</span>
<span class="c1"># parameter:        rCutCoul                = 0</span>
<span class="c1"># parameter:        condenseCriteria                = 0</span>
</pre></div>
</div>
<p>If the electrostatic forces are needed these prameters should be given a value. For more details please check <a class="reference internal" href="../Inclusions/Inclusions.html#coulombic"><span class="std std-ref">Coulombic Potential</span></a> and <a class="reference internal" href="../Inclusions/Inclusions.html#debye-huckel"><span class="std std-ref">Debye-Huckel</span></a> sections.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        kFene                   = 120.0</span>
<span class="c1"># parameter:        r0Fene                  = 1.5</span>
<span class="c1"># parameter:        kSqu                            = 0.0</span>
<span class="c1"># parameter:        kBend                           = 0.0</span>
<span class="c1"># parameter:        kNemMPC                 = 0.0</span>
</pre></div>
</div>
<p>Here we define <code class="docutils literal notranslate"><span class="pre">kFene</span></code> that is a spring constant representing the stiffness of the bonds in response to stretching and <code class="docutils literal notranslate"><span class="pre">r0Fene</span></code> that is the maximum length of the bonds connecting two monomers (for more details check <a class="reference internal" href="../Inclusions/Inclusions.html#fene"><span class="std std-ref">Finitely Extensible Bonds</span></a>). <code class="docutils literal notranslate"><span class="pre">kSqu</span></code> is the spring constant for a radial squeezing force to force polymer into longitudinal configuartion, here we set it to zero. <code class="docutils literal notranslate"><span class="pre">kBend</span></code> is the parameter to modulate the bending stiffness of the polymer (it introduces a persistence lentgh to polymer, for more details check <a class="reference internal" href="../Inclusions/Inclusions.html#bending-potential"><span class="std std-ref">Bond Bending Potential</span></a>). In this case the polymer is flexible. And finally <code class="docutils literal notranslate"><span class="pre">kNemMPC</span></code> which is the parameter to modulate the strength of the alignment torque that nemtaic orientation applies to the polymer backbone (<a class="reference internal" href="../Inclusions/Inclusions.html#coupling-potential"><span class="std std-ref">Nematic Coupling Potential</span></a>). Here there is no coupling to the director field , hence polymer is just coupled to the velocity field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        atomMass                = (10,                  1,                              10)</span>
</pre></div>
</div>
<p>The third number specifies the mass of monomers in units of MPCD particle mass, so here each monomer is ten times heavier than MPCD particles.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">charge</span> <span class="pre">sets:</span></code> the parameters related to the charge o monomers for electrostatic forces are entered. Here, the next two lines define that there is no electrostatic force since there is no charge.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        qDensity                = (0.,                          0.,                     0.,                     0.)</span>
<span class="c1"># parameter:        qNumber                 = (0,                           0,                              0,                              0)</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">polymer</span> <span class="pre">sets:</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        polyLayout              = (LAYOUT_RODX)</span>
</pre></div>
</div>
<p>Sets the initial conformation of the polymer (for more options please check the <code class="docutils literal notranslate"><span class="pre">md/mdtypes.h</span></code> in MPCD directory). In this case we put a rod polymer along x axis in the center of the control volume.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        polyM                   = (1)</span>
<span class="c1"># parameter:        polyN                   = (35)</span>
</pre></div>
</div>
<p>These two parameters set the number of polymers and number of monomers per polymer respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        nStep                   = (0,   50000,                  5000000)</span>
</pre></div>
</div>
<p>What one should be very careful about in <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">simulation</span> <span class="pre">phases:</span></code>  is the last number for <code class="docutils literal notranslate"><span class="pre">nStep</span></code> becuase it is the maximum time step beyond which no data will be outputed from MD side and the number is in units of MD. for instance in this example, we have 2000 MPCD streaming step and each are 50 MD steps, so nStep should be at least <span class="math notranslate nohighlight">\(1000 \times 50\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter:        stepAvg                     = (0,       2500,                   2500)</span>
<span class="c1"># parameter:        stepHistCollect         = (0,   2500,                   2500)</span>
<span class="c1"># parameter:        stepHistPrint           = (0,   2500,                   2500)</span>
<span class="c1"># parameter:        stepSceneSlow           = (0,   2500,                   2500)</span>
<span class="c1"># parameter:        stepSceneFast           = (0,   2500,                   2500)</span>
</pre></div>
</div>
<p>Numbers in <code class="docutils literal notranslate"><span class="pre">step</span> <span class="pre">counters</span></code> section are the frequency of outputing the MD data. MD data is not very expensive, storagevise, in comparison with field outputs in MPCD. So you can output more frequently than MPCD or if you want the same number of outputs as MPCD , multiply the frequency of MPCD output by <code class="docutils literal notranslate"><span class="pre">stepsMD</span></code>. Here, it is <span class="math notranslate nohighlight">\(50 \times 50 = 2500\)</span>.</p>
</section>
</section>
</section>
<section id="wavy-walls">
<span id="wavywalls"></span><h2><a class="toc-backref" href="#id87" role="doc-backlink">Wavy Walls</a><a class="headerlink" href="#wavy-walls" title="Permalink to this heading">#</a></h2>
<p>This tutorial demonstrates simulates a complex geometry confining a 2D active nematic fluid within a channel with periodic boundaries in the x-direction.
The confining channel walls are wavy sinusoids.
Additionally there are fixed circular obstacles between each maximum/minimum pair of the wavy walls.</p>
<section id="id65">
<h3>Input File<a class="headerlink" href="#id65" title="Permalink to this heading">#</a></h3>
<p>This tutorial is based on the input file found in <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/wavyWalls/input.json">MPCD/SampleInputs/wavyWalls/input.json</a>.</p>
</section>
<section id="id67">
<h3>Running<a class="headerlink" href="#id67" title="Permalink to this heading">#</a></h3>
<p>This script can be run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">naimh</span><span class="o">&gt;/</span><span class="n">mpcd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span><span class="n">wavyWalls</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">out</span><span class="o">-</span><span class="nb">dir</span><span class="o">&gt;/</span>
</pre></div>
</div>
</section>
<section id="id68">
<h3>Understanding the script<a class="headerlink" href="#id68" title="Permalink to this heading">#</a></h3>
<p>Here is the breakdown of the input script.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;domain&quot;</span><span class="p">:[</span><span class="mi">100</span><span class="p">,</span><span class="mi">25</span><span class="p">],</span>
<span class="nt">&quot;simSteps&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100000</span><span class="p">,</span>
<span class="nt">&quot;warmUp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
</pre></div>
</div>
<p>A rectangular domain that is four times as long in the x-direction as the y-direction is used.
The simulation runs for <span class="math notranslate nohighlight">\(10^{5}\)</span> iterations without a warmup phase.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;lc&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="nt">&quot;mfpot&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
<span class="nt">&quot;collOp&quot;</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span>
</pre></div>
</div>
<p>An active nematic fluid is simulated (see the tutorial on <a class="reference internal" href="#actnemtutorial"><span class="std std-ref">2D Active Nematics</span></a>).</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;species&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;mass&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;dens&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">20</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;qDist&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;vDist&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;oDist&quot;</span><span class="p">:</span><span class="w">        </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;interMatr&quot;</span><span class="p">:</span><span class="w">    </span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;rfc&quot;</span><span class="p">:</span><span class="w">          </span><span class="mf">0.01</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;len&quot;</span><span class="p">:</span><span class="w">          </span><span class="mf">0.007</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;tumble&quot;</span><span class="p">:</span><span class="w">       </span><span class="mi">2</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;shearSusc&quot;</span><span class="p">:</span><span class="w">    </span><span class="mf">0.5</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;magnSusc&quot;</span><span class="p">:</span><span class="w">     </span><span class="mf">0.001</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;act&quot;</span><span class="p">:</span><span class="w">          </span><span class="mf">0.05</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;damp&quot;</span><span class="p">:</span><span class="w">         </span><span class="mi">0</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Typical particle properies are used, with an activity of <code class="docutils literal notranslate"><span class="pre">&quot;act&quot;:</span> <span class="pre">0.05</span></code>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;BC&quot;</span><span class="p">:</span>
<span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Bottom wall&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="mi">-1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="mi">-1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Top wall&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">-1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="mi">-25</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="mi">-1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="mi">-1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span>
<span class="w">    </span><span class="p">},</span>
</pre></div>
</div>
<p>This simulation puts a two impermeable/no-slip walls above and below the wavy walls (these are extraneous and unneeded).</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Wavy bottom wall&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="mi">-1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="mi">-1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;wavy&quot;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.31415</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="p">},</span>
<span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Wavy top wall&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">-1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="mi">-1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="mi">-1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;wavy&quot;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.31415</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="p">},</span>
</pre></div>
</div>
<p>Two wavy channel walls are set. The first is set near the bottom of the domain at <code class="docutils literal notranslate"><span class="pre">&quot;Q&quot;:[0,5,0]</span></code> (pointing up <code class="docutils literal notranslate"><span class="pre">&quot;aInv&quot;:[0,1,0],</span></code>) and the second at the top <code class="docutils literal notranslate"><span class="pre">&quot;Q&quot;:[0,20,0]</span></code> (pointing down <code class="docutils literal notranslate"><span class="pre">&quot;aInv&quot;:[0,-1,0],</span></code>).
These each have have an amplitude of 5 and a wavelength of 10 as seen from <code class="docutils literal notranslate"><span class="pre">&quot;wavy&quot;:[5,0.31415,0]</span></code> (see <a class="reference internal" href="../Usage/Usage.html#additionalsurfaces"><span class="std std-ref">Wavy surfaces</span></a>).</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;First fixed circular pillar&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;P&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;Q&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mf">12.5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="mi">-1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="mi">-1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;mass&quot;</span><span class="p">:</span><span class="mf">3534.3</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;dsplc&quot;</span><span class="p">:</span><span class="mi">0</span>
<span class="p">},</span>
<span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Second fixed circular pillar&quot;</span><span class="p">,</span>

<span class="p">},</span>
<span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Third fixed circular pillar&quot;</span><span class="p">,</span>

<span class="p">},</span>
<span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Fourth fixed circular pillar&quot;</span><span class="p">,</span>

<span class="p">},</span>
<span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Fifth fixed circular pillar&quot;</span><span class="p">,</span>

<span class="p">},</span>
</pre></div>
</div>
<p>Five impermeable/no-slip circular obstacles are placed in the wavy channel.
All five are identical except their location.
Their radius is <code class="docutils literal notranslate"><span class="pre">&quot;R&quot;:6</span></code> and they are fixed in place <code class="docutils literal notranslate"><span class="pre">&quot;dsplc&quot;:0</span></code>.
The nematic anchoring to their surfaces is free (<code class="docutils literal notranslate"><span class="pre">&quot;MUN&quot;:1</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;MUT&quot;:1</span></code>).</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Left periodic boundary condition&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Right periodic boundary condition&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;phantom&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;aInv&quot;</span><span class="p">:[</span><span class="mi">-1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;P&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;R&quot;</span><span class="p">:</span><span class="mi">-100</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;DN&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MVT&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MUN&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;MUT&quot;</span><span class="p">:</span><span class="mi">1</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">],</span>
</pre></div>
</div>
<p>Finally, periodic boundary conditions (PBC) must be placed at the end of the channel in the x-direciton.
<code class="docutils literal notranslate"><span class="pre">&quot;DN&quot;:100</span></code> matches the domain size in the x-direction and the velocity and nematic-orientation of particles are not changed when they pass through the PBC.
The right-hand PBC sets <code class="docutils literal notranslate"><span class="pre">&quot;R&quot;:-100</span></code>, rather than <code class="docutils literal notranslate"><span class="pre">&quot;Q&quot;:[100,0,0]</span></code>, which would have been equivalent.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="nt">&quot;flowOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;dirSOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;coarseOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;debugOut&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;histVortOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;histVelOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;vortCorrOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;velCorrOut&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;topoFieldOut&quot;</span><span class="p">:</span><span class="mi">10</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Lastly, the desired resulting data is outputted and the curly bracket is closed.</p>
</section>
<section id="id69">
<h3>Output<a class="headerlink" href="#id69" title="Permalink to this heading">#</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 analysisScripts/flowFieldAnimator.py flowfield.dat input.json 0 99999 z -a equal -d defects.dat</span>
<span class="go">python3 analysisScripts/orientationFieldAnimator.py directorfield.dat input.json 0 99999 z -a equal --qx 1 --qy 1 -c 0.75 -d defects.dat</span>
<span class="go">python3 analysisScripts/densityAnimator.py coarsegrain.dat input.json 0 99999 z 0 -a equal</span>
<span class="go">python3 analysisScripts/topochargeFieldAnimator.py directorfield.dat topochargefield.dat input.json 0 99999 z -a equal --qx 1 --qy 1 -c 0.75</span>
</pre></div>
</div>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 100.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/topoCharge.png"><img alt="../_images/topoCharge.png" src="../_images/topoCharge.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
<tr class="row-even"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/director.png"><img alt="../_images/director.png" src="../_images/director.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
<tr class="row-odd"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/density.png"><img alt="../_images/density.png" src="../_images/density.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
<tr class="row-even"><td><figure class="align-center">
<a class="reference internal image-reference" href="../_images/velocity1.png"><img alt="../_images/velocity1.png" src="../_images/velocity1.png" style="width: 95%;" /></a>
</figure>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="extra-tutorials">
<span id="othertutorials"></span><h2><a class="toc-backref" href="#id88" role="doc-backlink">Extra Tutorials</a><a class="headerlink" href="#extra-tutorials" title="Permalink to this heading">#</a></h2>
<p>In addition to the detailed tutorials given here, there are other sample scripts that can be used as a guide.</p>
<section id="d-active-shell">
<h3>3D active shell<a class="headerlink" href="#d-active-shell" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/activeShell3D/input.json">MPCD/SampleInputs/activeShell3D/input.json</a>.</p>
</section>
<section id="d-colloid">
<h3>3D colloid<a class="headerlink" href="#d-colloid" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/colloid3D/input.json">MPCD/SampleInputs/colloid3D/input.json</a>.</p>
</section>
<section id="tadpole-swimmer">
<h3>TADPole swimmer<a class="headerlink" href="#tadpole-swimmer" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/swimmer/input.json">MPCD/SampleInputs/swimmer/input.json</a>.</p>
</section>
<section id="pair-of-tadpole-swimmers-in-a-liquid-crystal">
<h3>Pair of TADPole swimmers in a liquid crystal<a class="headerlink" href="#pair-of-tadpole-swimmers-in-a-liquid-crystal" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/swimmerPairInLC/input.json">MPCD/SampleInputs/swimmerPairInLC/input.json</a>.</p>
</section>
<section id="tadpoles-with-attractive-interactions">
<h3>TADPoles with attractive interactions<a class="headerlink" href="#tadpoles-with-attractive-interactions" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/swimmersDepletion/input.json">MPCD/SampleInputs/swimmersDepletion/input.json</a>.</p>
</section>
<section id="molecular-dynamics-in-3d">
<h3>Molecular dynamics in 3D<a class="headerlink" href="#molecular-dynamics-in-3d" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/md3D/input.json">MPCD/SampleInputs/md3D/input.json</a>.</p>
</section>
<section id="tadpoles-in-an-ellipse">
<h3>TADPoles in an ellipse<a class="headerlink" href="#tadpoles-in-an-ellipse" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/swimmersInEllipse/input.json">MPCD/SampleInputs/swimmersInEllipse/input.json</a>.</p>
</section>
<section id="tracer-particle">
<h3>Tracer particle<a class="headerlink" href="#tracer-particle" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/tracerParticle/input.json">MPCD/SampleInputs/tracerParticle/input.json</a>.</p>
</section>
<section id="checkpointer">
<h3>Checkpointer<a class="headerlink" href="#checkpointer" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/checkpointer/input.json">MPCD/SampleInputs/checkpointer/input.json</a>.</p>
</section>
<section id="pipe-flow">
<h3>Pipe flow<a class="headerlink" href="#pipe-flow" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/pipeFlow/input.json">MPCD/SampleInputs/pipeFlow/input.json</a>.</p>
</section>
<section id="shearing-banana-colloids">
<h3>Shearing banana colloids<a class="headerlink" href="#shearing-banana-colloids" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/shearBanana/input.json">MPCD/SampleInputs/shearBanana/input.json</a>.</p>
</section>
<section id="wavy-circular-walls">
<h3>Wavy circular walls<a class="headerlink" href="#wavy-circular-walls" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/wavyWallsCircular/input.json">MPCD/SampleInputs/wavyWallsCircular/input.json</a>.</p>
</section>
<section id="colloid-in-a-2d-nematic-film">
<h3>Colloid in a 2D nematic film<a class="headerlink" href="#colloid-in-a-2d-nematic-film" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/colloid2DInLC/input.json">MPCD/SampleInputs/colloid2DInLC/input.json</a>.</p>
</section>
<section id="species-specific-bcs">
<h3>Species specific BCs<a class="headerlink" href="#species-specific-bcs" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/speciesSpecificBCs/input.json">MPCD/SampleInputs/speciesSpecificBCs/input.json</a>.</p>
</section>
<section id="d-cylinder">
<h3>3D Cylinder<a class="headerlink" href="#d-cylinder" title="Permalink to this heading">#</a></h3>
<p>This sample script is found at <a class="reference external" href="https://github.com/Shendruk-Lab/MPCD/blob/master/sampleInputs/cylinder3D/input.json">MPCD/SampleInputs/speciesSpecificBCs/input.json</a>.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../Usage/Usage.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">MPCD usage</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../Input/inputFiles.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Input guide</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Shendruk Lab
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Tutorials</a><ul>
<li><a class="reference internal" href="#first-simulation">First simulation</a><ul>
<li><a class="reference internal" href="#input-file">Input File</a></li>
<li><a class="reference internal" href="#running">Running</a></li>
<li><a class="reference internal" href="#understanding-the-script">Understanding the script</a></li>
<li><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overrides">Overrides</a><ul>
<li><a class="reference internal" href="#id4">Input File</a></li>
<li><a class="reference internal" href="#id5">Running</a></li>
<li><a class="reference internal" href="#id6">Understanding the script</a></li>
<li><a class="reference internal" href="#id7">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#channel-flow">Channel flow</a><ul>
<li><a class="reference internal" href="#channelflow">Channel Flow</a></li>
<li><a class="reference internal" href="#id9">Input File</a></li>
<li><a class="reference internal" href="#id10">Running</a></li>
<li><a class="reference internal" href="#id11">Understanding the script</a></li>
<li><a class="reference internal" href="#id12">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rarefied-gas-and-tracer-particles">Rarefied gas and tracer particles</a><ul>
<li><a class="reference internal" href="#rarefied-gas">Rarefied gas</a><ul>
<li><a class="reference internal" href="#id13">Input File</a></li>
<li><a class="reference internal" href="#id14">Running</a></li>
<li><a class="reference internal" href="#id15">Understanding the script</a></li>
<li><a class="reference internal" href="#id16">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tracer-particles">Tracer particles</a><ul>
<li><a class="reference internal" href="#id17">Input File</a></li>
<li><a class="reference internal" href="#id19">Running</a></li>
<li><a class="reference internal" href="#id20">Understanding the script</a></li>
<li><a class="reference internal" href="#id21">Output</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#colloid">Colloid</a><ul>
<li><a class="reference internal" href="#diffusing-colloid">Diffusing Colloid</a></li>
<li><a class="reference internal" href="#id23">Input File</a></li>
<li><a class="reference internal" href="#id24">Running</a></li>
<li><a class="reference internal" href="#id25">Understanding the script</a></li>
<li><a class="reference internal" href="#id26">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tadpole-swimmers">TADPole swimmers</a><ul>
<li><a class="reference internal" href="#id27">Input File</a></li>
<li><a class="reference internal" href="#id28">Running</a></li>
<li><a class="reference internal" href="#id29">Understanding the script</a></li>
<li><a class="reference internal" href="#id30">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d-passive-nematic">2D Passive Nematic</a><ul>
<li><a class="reference internal" href="#id31">Input file</a></li>
<li><a class="reference internal" href="#id32">Running</a></li>
<li><a class="reference internal" href="#id33">Understanding the Script</a></li>
<li><a class="reference internal" href="#id34">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d-active-nematic">2D Active Nematic</a><ul>
<li><a class="reference internal" href="#id35">Input file</a></li>
<li><a class="reference internal" href="#id36">Running</a></li>
<li><a class="reference internal" href="#id37">Understanding the script</a></li>
<li><a class="reference internal" href="#id38">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d-pipe-flow">3D pipe flow</a><ul>
<li><a class="reference internal" href="#id39">Input File</a></li>
<li><a class="reference internal" href="#id40">Running</a></li>
<li><a class="reference internal" href="#id41">Understanding the script</a></li>
<li><a class="reference internal" href="#id42">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#flow-past-a-square-obstacle">Flow past a ‘square’ obstacle</a><ul>
<li><a class="reference internal" href="#id43">Input File</a></li>
<li><a class="reference internal" href="#id44">Running</a></li>
<li><a class="reference internal" href="#id45">Understanding the script</a></li>
<li><a class="reference internal" href="#id46">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d-polymer">2D polymer</a><ul>
<li><a class="reference internal" href="#input-files">Input Files</a><ul>
<li><a class="reference internal" href="#input-json">input.json</a></li>
<li><a class="reference internal" href="#md-inp">md.inp</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id47">Running</a></li>
<li><a class="reference internal" href="#understanding-the-scripts">Understanding the Scripts</a><ul>
<li><a class="reference internal" href="#dpolymer-json">input.json</a></li>
<li><a class="reference internal" href="#dpolymer-inp">md.inp</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#many-polymers">Many polymers</a><ul>
<li><a class="reference internal" href="#id50">Input Files</a><ul>
<li><a class="reference internal" href="#id51">input.json</a></li>
<li><a class="reference internal" href="#id52">md.inp</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id53">Running</a></li>
<li><a class="reference internal" href="#id54">Understanding the Scripts</a><ul>
<li><a class="reference internal" href="#id55">input.json</a></li>
<li><a class="reference internal" href="#id56">md.inp</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#polymer-translocation">Polymer translocation</a><ul>
<li><a class="reference internal" href="#id57">Input File</a></li>
<li><a class="reference internal" href="#id58">Input Files</a><ul>
<li><a class="reference internal" href="#id59">input.json</a></li>
<li><a class="reference internal" href="#id60">md.inp</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id61">Running</a></li>
<li><a class="reference internal" href="#id62">Understanding the Scripts</a><ul>
<li><a class="reference internal" href="#id63">input.json</a></li>
<li><a class="reference internal" href="#id64">md.inp</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#wavy-walls">Wavy Walls</a><ul>
<li><a class="reference internal" href="#id65">Input File</a></li>
<li><a class="reference internal" href="#id67">Running</a></li>
<li><a class="reference internal" href="#id68">Understanding the script</a></li>
<li><a class="reference internal" href="#id69">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extra-tutorials">Extra Tutorials</a><ul>
<li><a class="reference internal" href="#d-active-shell">3D active shell</a></li>
<li><a class="reference internal" href="#d-colloid">3D colloid</a></li>
<li><a class="reference internal" href="#tadpole-swimmer">TADPole swimmer</a></li>
<li><a class="reference internal" href="#pair-of-tadpole-swimmers-in-a-liquid-crystal">Pair of TADPole swimmers in a liquid crystal</a></li>
<li><a class="reference internal" href="#tadpoles-with-attractive-interactions">TADPoles with attractive interactions</a></li>
<li><a class="reference internal" href="#molecular-dynamics-in-3d">Molecular dynamics in 3D</a></li>
<li><a class="reference internal" href="#tadpoles-in-an-ellipse">TADPoles in an ellipse</a></li>
<li><a class="reference internal" href="#tracer-particle">Tracer particle</a></li>
<li><a class="reference internal" href="#checkpointer">Checkpointer</a></li>
<li><a class="reference internal" href="#pipe-flow">Pipe flow</a></li>
<li><a class="reference internal" href="#shearing-banana-colloids">Shearing banana colloids</a></li>
<li><a class="reference internal" href="#wavy-circular-walls">Wavy circular walls</a></li>
<li><a class="reference internal" href="#colloid-in-a-2d-nematic-film">Colloid in a 2D nematic film</a></li>
<li><a class="reference internal" href="#species-specific-bcs">Species specific BCs</a></li>
<li><a class="reference internal" href="#d-cylinder">3D Cylinder</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>