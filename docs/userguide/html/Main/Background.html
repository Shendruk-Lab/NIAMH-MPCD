<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Installation guide" href="../Install/Install.html" /><link rel="prev" title="Executive summary" href="../Summary/Summary.html" />

    <link rel="shortcut icon" href="../_static/niamh-logo.png"/><!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>Algorithm - NIAMH-MPCD documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">NIAMH-MPCD  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/niamh-logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">NIAMH-MPCD  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Summary/Summary.html">Executive summary</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Install/Install.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Install/Run.html">Run guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Input/inputFiles.html">Input guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Tutorials/Tutorials.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HardCoded/HardCoded.html">Hard-coded options</a></li>
<li class="toctree-l1"><a class="reference internal" href="ExtraTheory.html">Additional theoretical background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Outputs/Outputs.html">Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Analysis/Analysis.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DeveloperGuide/DeveloperGuide.html">Developer’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Glossary/Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../References/References.html">Bibliography</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="algorithm">
<span id="backgroundchapter"></span><h1>Algorithm<a class="headerlink" href="#algorithm" title="Permalink to this heading">#</a></h1>
<section id="what-is-mpcd">
<span id="intrompcd"></span><h2>What is MPCD ?<a class="headerlink" href="#what-is-mpcd" title="Permalink to this heading">#</a></h2>
<p id="mpcd">In many situtations in soft matter physics, the fluid medium in which mesoscale particles—such as polymers, colloids or cells—are suspended is crucial but not the principle interest of study.
In such cases, coarse-grained algorithms that simulate one or more aspect of the surrounding fluid are needed.
For example, if the most significant effect of the fluid is to induce thermal fluctuations then a Langevin or Brownian dynamics simulation might be most suitable <a class="reference internal" href="../References/References.html#slater2009" id="id1"><span>[Slater2009]</span></a>.
On the other hand, if the embedded particles are large enough that thermal fluctuations are negligible but hydrodynamic interactions between them are significant then an immersed boundary solver <a class="reference internal" href="../References/References.html#mittel2005" id="id2"><span>[Mittel2005]</span></a> or lattice-Boltzmann simulation <a class="reference internal" href="../References/References.html#aidun2010" id="id3"><span>[Aidun2010]</span></a> might be more appropriate.</p>
<ul class="simple">
<li><p>If both <strong>fluctuations and hydrodynamic interactions are crucial</strong> then <em>MPCD</em> may be an appropriate simulation technique.</p></li>
</ul>
<p><em>Multi-Particle Collision Dynamics</em> (MPCD) is a technique for simulating fluctuating hydrodynamics that reproduces the Navier-Stokes equation on sufficiently long length and time scales <a class="reference internal" href="../References/References.html#pooley2005" id="id4"><span>[Pooley2005]</span></a>.
It is well suited for situations for which viscosity dominates over inertia, and diffusion is of similar significance to advective flow (see <a class="reference internal" href="#chapterunits"><span class="std std-ref">Dimensionless Numbers</span></a>).
It is straightforward to include mobile particles, such as colloids, within the MPCD fluid, even if these have many internal degress of freedom, such as polymers.
This makes MPCD an excellent option for simulating complex suspensions.
Furthermore, because MPCD is a particle-based method, non-trivial boundaries can be included more easily than methods that require complicated meshes.</p>
<p>As in any computational approach, these benefits are counterbalanced by complications, including</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="ExtraTheory.html#chaptervisc"><span class="std std-ref">fluid properties</span></a> (such as viscosity or other transport coefficients) are controlled indirectly,</p></li>
<li><p><strong>multiple runs must be averaged</strong> to find statisticly meaningful results, and</p></li>
<li><p><a class="reference internal" href="#dimensionlessnumbers"><span class="std std-ref">compressibility</span></a> <a class="reference internal" href="../References/References.html#zhao2013" id="id5"><span>[Zhao2013]</span></a>.</p></li>
</ol>
<section id="particle-based-coarse-graining">
<span id="particlebased"></span><h3>Particle-based coarse-graining<a class="headerlink" href="#particle-based-coarse-graining" title="Permalink to this heading">#</a></h3>
<p>In MPCD, the continuous fluid medium is discretised into point-like, coarse-grained fluid particles.
Equivalently one may imagine that many fluid atoms or molecules are grouped together and simulated as point-like particles.
This coarse-graning eschews molecular-scale details of the molecules that make up the fluid.
Respecting conservation of these quantities is what allows the hydrodynamic equations of motion to be obeyed on sufficiently long length and time scales <a class="reference internal" href="../References/References.html#pooley2005" id="id6"><span>[Pooley2005]</span></a>.</p>
<p>Thus, MPCD <strong>does not</strong> give correct dynamics on microscopic time or length scales.
Streaming and collision events conserve the momentum and energy (or temperature) locally at all times and so MPCD reproduces an accurate representation of the hydrodynamics of the velocity field at large distances.
The coarse-grained mesoscopic MPCD fluid provides both a thermal bath and propagates hydrodynamic interactions without having to either solve the entire Navier-Stokes equation <a class="reference internal" href="../References/References.html#yeomans2006" id="id7"><span>[Yeomans2006]</span></a> for a potentially complex microfluidic system or to simulate the full molecular interactions of all fluid molecules.
Therefore, it can be computationally less expensive than numerical, continuum solvers or full <em>Molecular Dynamics</em> (MD) simulations.</p>
</section>
<section id="two-step-algorithm">
<h3>Two-step algorithm<a class="headerlink" href="#two-step-algorithm" title="Permalink to this heading">#</a></h3>
<p>The core MPCD algorithm consists of only two steps:</p>
<ol class="arabic simple">
<li><p>The first step is the <a class="reference internal" href="#streaming"><span class="std std-ref">streaming step</span></a>.</p></li>
<li><p>The second is the <a class="reference internal" href="#collision"><span class="std std-ref">collision step</span></a>.</p></li>
</ol>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-center">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="../_images/mpcdAlgorithm_streaming.png"><img alt="../_images/mpcdAlgorithm_streaming.png" class="align-center" src="../_images/mpcdAlgorithm_streaming.png" style="width: 95%;" /></a>
</td>
<td><a class="reference internal image-reference" href="../_images/mpcdAlgorithm_collision.png"><img alt="../_images/mpcdAlgorithm_collision.png" class="align-center" src="../_images/mpcdAlgorithm_collision.png" style="width: 95%;" /></a>
</td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#streaming"><span class="std std-ref">Streaming step</span></a>.</p></td>
<td><p><a class="reference internal" href="#collision"><span class="std std-ref">Collision step</span></a>.</p></td>
</tr>
</tbody>
</table>
</div>
<section id="streaming-step">
<span id="streaming"></span><h4>Streaming step<a class="headerlink" href="#streaming-step" title="Permalink to this heading">#</a></h4>
<p>Each fluid particle (labelled <span class="math notranslate nohighlight">\(i\)</span>) of mass <span class="math notranslate nohighlight">\(m_i\)</span> moves ballistically, and its position <span class="math notranslate nohighlight">\(\vec{x}_i\left(t\right)\)</span> is updated in discrete time intervals <span class="math notranslate nohighlight">\(\delta t\)</span>.
Particle properties, such as position and velocity <span class="math notranslate nohighlight">\(\vec{v}_i\left(t\right)\)</span>, are continuous—not discretised (see <a class="reference internal" href="Usage.html#chapterparticles"><span class="std std-ref">Particle Properties</span></a>)—but the time <span class="math notranslate nohighlight">\(t\)</span> is discretely iterated.
In the <strong>streaming step</strong>, the particles move according to</p>
<div class="math-wrapper docutils container" id="eq-stream">
<span id="equation-eq-stream"></span><div class="math notranslate nohighlight" id="eq-stream">
<span id="equation-eq-stream"></span><span class="eqno">(1)<a class="headerlink" href="#eq-stream" title="Permalink to this equation">#</a></span>\[\vec{x}_i\left(t+\delta t\right) = \vec{x}_i\left(t\right) + \vec{v}_i\left(t\right) \delta t .\]</div>
</div>
<p>If the MPCD algorithm consisted only of streaming steps then the carrier fluid would be an ideal gas; however, the <a class="reference internal" href="#collision"><span class="std std-ref">collision step</span></a> introduces coarse-grained interactions between particles.</p>
</section>
<section id="collision-step">
<span id="collision"></span><h4>Collision step<a class="headerlink" href="#collision-step" title="Permalink to this heading">#</a></h4>
<p>The second step is the <strong>collision step</strong> in which momentum is transferred between fluid particles, under the constraint that the total local momuntum is conserved.
To exchange momentum, the simulation domain is partitioned into <span class="math notranslate nohighlight">\(d\)</span>-dimensional square cells of size <span class="math notranslate nohighlight">\(a\)</span>.
After streaming, all particles are binned into cells (labelled <span class="math notranslate nohighlight">\(c\)</span>) and all the particles in a given cell are said to <em>collide</em>, locally exchanging particle properties via a stochastic collision operation.</p>
<p>The collision step is typically a non-physical scheme constructed to be simple and stochastic, but also obey appropraite conservation laws (such as conservation of momentum, angular momentum and/or energy/temperature) within each cell.
Multi-particle collisions within cells are represented by the collision operator <span class="math notranslate nohighlight">\(\vec{\Xi}\)</span> such that the velocity of each particle in a given cell evolves as</p>
<div class="math-wrapper docutils container" id="eq-collision">
<span id="equation-eq-collision"></span><div class="math notranslate nohighlight" id="eq-collision">
<span id="equation-eq-collision"></span><span class="eqno">(2)<a class="headerlink" href="#eq-collision" title="Permalink to this equation">#</a></span>\[\vec{v}_i\left(t + \delta t\right) = \vec{v}^{c}\left(t\right) + \vec{\Xi} \left( \; \vec{v}_i\left(t\right), \vec{v}^{c}\left(t\right) \; \right) ,\]</div>
</div>
<p>where the velocities <span class="math notranslate nohighlight">\(\vec{v}_i\left(t\right)\)</span> and <span class="math notranslate nohighlight">\(\vec{v}_i\left(t+\delta t\right)\)</span> are the before and after values, and <span class="math notranslate nohighlight">\(\vec{v}^{c}\)</span> is the centre of mass velocity of cell <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>The number of fluid particles in the <span class="math notranslate nohighlight">\(c^\text{th}\)</span> cell at time <span class="math notranslate nohighlight">\(t\)</span> is <span class="math notranslate nohighlight">\({N_c}\left(t\right)\)</span>.
The number of particles in each cell may vary from one cell to another but the total number <span class="math notranslate nohighlight">\(N_\text{tot}\)</span> is conserved.
Likewise, the number density can vary in space and time but the average number density, <span class="math notranslate nohighlight">\(n=\left\langle N_c \right\rangle/a^d\)</span> where <span class="math notranslate nohighlight">\(d\)</span> is the dimensionality of the simulation and <span class="math notranslate nohighlight">\(\left\langle \cdot \right\rangle\)</span> is the average over all cells, is fixed.
Each cell possesses a centre of mass velocity <span class="math notranslate nohighlight">\(\vec{v}^{c} = \left\langle v_i \right\rangle_c = \left(\sum^{N_c}_{i=1} m_i \vec{v}_i\right)/\left(\sum^{N_c}_{i=1} m_i\right)\)</span>, where <span class="math notranslate nohighlight">\(\left\langle \cdot \right\rangle_c\)</span> represents the average within cell <span class="math notranslate nohighlight">\(c\)</span>.
The cell velocity <span class="math notranslate nohighlight">\(\vec{v}^{c}\)</span> corresponds to the local macroscopic velocity <span class="math notranslate nohighlight">\(\vec{v}\left(\vec{x}_c,t\right)\)</span> at the location of cell <span class="math notranslate nohighlight">\(c\)</span> and time <span class="math notranslate nohighlight">\(t\)</span>.
Thus, these cell-based values are interpretted as discretized field values (see <a class="reference internal" href="Usage.html#chaptercell"><span class="std std-ref">Cell Properties</span></a>).</p>
<p>The MPCD collision step replaces molecular-scale dynamics with a local, non-physical, stochastic momentum transfer operation.
A number of collision operators are available (see <a class="reference internal" href="Usage.html#chaptercollop"><span class="std std-ref">Collision operators</span></a>).</p>
</section>
</section>
<section id="beyond-simple-isotropic-fluids">
<h3>Beyond simple isotropic fluids<a class="headerlink" href="#beyond-simple-isotropic-fluids" title="Permalink to this heading">#</a></h3>
<p>More complicated fluids than a simple isotropic thermalized fluid can be simulated using the MPCD algorith. Fundamentally, this is because continuum equations of motion take the form of a material derivative balanced against external driving forces and internal dissipative forces. The MPCD streaming step is sufficient to account for the material derivative, while local collision operations can account for the external driving forces and internal dissipative forces. The challenge is to devise an appropriate collision operation.</p>
<p>In addition to implementing 5 collision operators for isotropic fluids, NIAMH-MPCD has <a class="reference internal" href="ExtraTheory.html#theory"><span class="std std-ref">collision operators for passive nematic fluids and active fluids, as well as the ability to embedded polymers and swimmers</span></a>.</p>
</section>
</section>
<section id="units">
<span id="chapterunits"></span><h2>Units<a class="headerlink" href="#units" title="Permalink to this heading">#</a></h2>
<p>Measurements in the NIAMH-MPCD simulator are given in terms of a small number of <a class="reference internal" href="#set-values"><span class="std std-ref">fundamental units</span></a>. These units are combined to describe the natural <a class="reference internal" href="#derivedunits"><span class="std std-ref">derived units</span></a> of other observables. To compare results with experiments or to identify operating regimes, measurements can be combined into <a class="reference internal" href="#dimensionlessnumbers"><span class="std std-ref">dimensionless numbers</span></a>.</p>
<section id="fundamental-units">
<span id="set-values"></span><h3>Fundamental units<a class="headerlink" href="#fundamental-units" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p><strong>Mass</strong> (<span class="math notranslate nohighlight">\(m\)</span>): The mass of a MPCD fluid particle sets the natural unit of mass.</p>
<p><strong>Length</strong> (<span class="math notranslate nohighlight">\(a\)</span>): The cell size sets the natural unit of length.</p>
<p><strong>Energy</strong> (<span class="math notranslate nohighlight">\(k_B T\)</span>): Temperature of the simulator’s thermostat, i.e. the thermal energy of the system.</p>
</div></blockquote>
<p>Since these define every other unit, they are set to one for convenience.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>In multiphase fluids, the mass of different species can be set to different values. However, at least one species should be assigned unit mass to set the units. Phases with different masses will possess different <a class="reference internal" href="ExtraTheory.html#chaptervisc"><span class="std std-ref">transport properties</span></a>.</p></li>
<li><p>The temperature can also be set to a non-unity value. However, this will alter the <a class="reference internal" href="ExtraTheory.html#chaptervisc"><span class="std std-ref">transport properties</span></a> of the fluid. The temperature should not be set to a non-unity value unless it is absolutely required that some other aspect of the simulations set the units of energy.</p></li>
</ul>
</div>
</section>
<section id="derived-units">
<span id="derivedunits"></span><h3>Derived units<a class="headerlink" href="#derived-units" title="Permalink to this heading">#</a></h3>
<p><strong>Time</strong>: The units of time are derived from the equipartition theorem to be <span class="math notranslate nohighlight">\([\tau] = a \sqrt{ \frac{m}{k_B T} }\)</span>. It is important to note that the units of time do not necessarily correspond to the timestep, δt, which is described in the <a class="reference internal" href="#streaming"><span class="std std-ref">introduction</span></a>.</p>
<p><strong>Velocity</strong>: As length divided by time, the units of velocity are <span class="math notranslate nohighlight">\([v]=\sqrt{\frac{k_B T}{m}}\)</span>.</p>
<p><strong>Acceleration</strong>: Velocity divided by time, <span class="math notranslate nohighlight">\([a]=\frac{k_B T}{m a}\)</span>.</p>
<p><strong>Force</strong>: Mass times acceleration, <span class="math notranslate nohighlight">\([F]= \frac{k_B T}{a}\)</span>.</p>
<p><strong>Diffusion coefficient</strong>: Length divided by time squared, <span class="math notranslate nohighlight">\([D]= \frac{k_B T}{a m}\)</span>.</p>
<p><strong>Rotational diffusion coefficient</strong>: Translational diffusion coefficient <span class="math notranslate nohighlight">\([D]\)</span> divided by length squared, <span class="math notranslate nohighlight">\([D_{R}] = \frac{K_B T}{a^3 m}\)</span>.</p>
<p><strong>Spring constant</strong>: Force divided by length, <span class="math notranslate nohighlight">\([k] = \frac{k_B T}{a^2}\)</span>.</p>
<p><strong>Number density</strong>: Number of particles divided by cell size, <span class="math notranslate nohighlight">\([n]= a^{-d}\)</span>, where <span class="math notranslate nohighlight">\(d\)</span> is the number of dimensions in the system.</p>
<p><strong>Mass density</strong>: Total mass of particles in a cell divided by cell size, <span class="math notranslate nohighlight">\([\rho]= n m\)</span>.</p>
<p><strong>Pressure</strong>: Force divided by length to the power of <span class="math notranslate nohighlight">\(d-1\)</span>, <span class="math notranslate nohighlight">\([P]= \frac{k_B T}{a^d}\)</span>. Streaming and collisional pressures sum together for the total pressure.</p>
<p><strong>Viscosity</strong>: Pressure multiplied by time, <span class="math notranslate nohighlight">\([\mu] = \frac{\sqrt{k_B T m}}{a^{d-1}}\)</span>. Changing the timestep will result in a
change in viscosity, as detailed in the <a class="reference internal" href="ExtraTheory.html#viscositysection"><span class="std std-ref">transport coefficients</span></a> section.</p>
<p><strong>Bending potential</strong>: Bending energy divided by cosine squared of the bending angle, <span class="math notranslate nohighlight">\([k_{b}]= k_B T\)</span>.</p>
<p><strong>Activity</strong>: The unit of activity in this simulator is the same as the unit of force. Activity gives a contribution to the collision operator
that is weighted by activity, the length of a timestep, and the mass of the particles. This results in units of force for the activity - see <a class="reference internal" href="../References/References.html#kozhukhov2022" id="id8"><span>[Kozhukhov2022]</span></a>
for more details.</p>
</section>
<section id="dimensionless-numbers">
<span id="dimensionlessnumbers"></span><h3>Dimensionless numbers<a class="headerlink" href="#dimensionless-numbers" title="Permalink to this heading">#</a></h3>
<p>Dimensionless numbers allow the user to determine the regime in which the simulator is operating and compare simulation results to theory and experiments.</p>
<section id="peclet-number">
<span id="peclet"></span><h4>Péclet number<a class="headerlink" href="#peclet-number" title="Permalink to this heading">#</a></h4>
<p>The Péclet number defines the ratio of diffusive transport rate to advective transport rate, i.e. propulsive behaviour against thermal behaviour. It is defined as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Pe=\frac{v L}{D},\]</div>
</div>
<p>where <em>L</em> is a typical length scale, <em>v</em> is a typical velocity, and <em>D</em> is the diffusion coefficient. Small values indicate a system dominated by diffusivity and larger values indicate a system dominated by advection — MPCD typically operates at moderate Pe, where both are significant.</p>
</section>
<section id="schmidt-number">
<h4>Schmidt number<a class="headerlink" href="#schmidt-number" title="Permalink to this heading">#</a></h4>
<p>The Schmidt number compares the relative importance of diffusivity and viscosity. It is defined as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Sc=\frac{μ}{D ρ},\]</div>
</div>
<p>where <em>μ</em> is the viscosity, <em>D</em> is the diffusivity and <em>ρ</em> is the density.</p>
<p>The Schmidt number offers a way to measure how ‘liquid-like’ or ‘gas-like’ the fluid is.</p>
</section>
<section id="mach-number">
<h4>Mach number<a class="headerlink" href="#mach-number" title="Permalink to this heading">#</a></h4>
<p>The Mach number relates the flow velocity past a boundary (<em>v</em>) to the local speed of sound (<em>c</em>). It is defined as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Ma=\frac{v}{c}.\]</div>
</div>
<p>In MPCD, the speed of sound is relatively low, which results in high Mach numbers. To be more precise, the speed of sound is <span class="math notranslate nohighlight">\(c=\sqrt{\frac{2 k_B T}{m}}\)</span>, as defined in <a class="reference internal" href="../References/References.html#padding2004" id="id9"><span>[Padding2004]</span></a>. Hydrodynamic disturbances travel at a finite speed in MPCD, while they are instantaneous in classical fluid dynamics theory due to the incompressibility assumption. Particle-based methods (such as Molecular Dynamics, Lattice Boltzmann, Dissipative Particle Dynamics, or MPCD) simulate fluids that are not incompressible, which is a drawback <a class="reference internal" href="../References/References.html#slater2009" id="id10"><span>[Slater2009]</span></a>. However, this is not an issue if the applied forces or pressure gradients are limited to small values.</p>
</section>
<section id="reynolds-number">
<h4>Reynolds number<a class="headerlink" href="#reynolds-number" title="Permalink to this heading">#</a></h4>
<p>The Reynolds number is an example of such a number. It broadly defines the ratio of inertia effects to viscous effects, and is defined as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Re=\frac{v L}{μ},\]</div>
</div>
<p>where <em>L</em> is a typical length scale for the system, <em>v</em> is a typical velocity, and <em>μ</em> is the viscosity.</p>
<p>In classical mechanics, turbulence is a phenomenon occuring at high Reynolds number, where excess energy is dissipated by chaotic energy cascades.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When using periodic boundary conditions, finite size effects come into play. As hydrodynamic interactions are long range, the simulated
system can then interact with itself, potentially impacting measurements. This is important to keep in mind.</p>
</div>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../Install/Install.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Installation guide</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../Summary/Summary.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Executive summary</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Shendruk Lab
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Algorithm</a><ul>
<li><a class="reference internal" href="#what-is-mpcd">What is MPCD ?</a><ul>
<li><a class="reference internal" href="#particle-based-coarse-graining">Particle-based coarse-graining</a></li>
<li><a class="reference internal" href="#two-step-algorithm">Two-step algorithm</a><ul>
<li><a class="reference internal" href="#streaming-step">Streaming step</a></li>
<li><a class="reference internal" href="#collision-step">Collision step</a></li>
</ul>
</li>
<li><a class="reference internal" href="#beyond-simple-isotropic-fluids">Beyond simple isotropic fluids</a></li>
</ul>
</li>
<li><a class="reference internal" href="#units">Units</a><ul>
<li><a class="reference internal" href="#fundamental-units">Fundamental units</a></li>
<li><a class="reference internal" href="#derived-units">Derived units</a></li>
<li><a class="reference internal" href="#dimensionless-numbers">Dimensionless numbers</a><ul>
<li><a class="reference internal" href="#peclet-number">Péclet number</a></li>
<li><a class="reference internal" href="#schmidt-number">Schmidt number</a></li>
<li><a class="reference internal" href="#mach-number">Mach number</a></li>
<li><a class="reference internal" href="#reynolds-number">Reynolds number</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>